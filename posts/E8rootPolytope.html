<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - The E8 root polytope</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:25px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:21px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>The E8 root polytope</h1> 
          <div class="info">
    Posted on March 14, 2022
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a title="All pages tagged 'R'." href="../tags/R.html">R</a>, <a title="All pages tagged 'maths'." href="../tags/maths.html">maths</a>, <a title="All pages tagged 'geometry'." href="../tags/geometry.html">geometry</a>, <a title="All pages tagged 'graphics'." href="../tags/graphics.html">graphics</a>, <a title="All pages tagged 'python'." href="../tags/python.html">python</a>, <a title="All pages tagged 'julia'." href="../tags/julia.html">julia</a>
    
</div>

<h2 id="the-e8-root-polytope-its-vertices-and-its-edges">The E8 root polytope, its vertices and its edges</h2>
<p>The <em>E8 root polytope</em>, also known as the <a href="https://en.wikipedia.org/wiki/4_21_polytope"><span class="math inline">\(4_{21}\)</span> polytope</a> is a 8-dimensional polytope. The Cartesian coordinates of its vertices are described in the above linked Wikipedia page. It has 240 vertices, that can be separated in two sets. The first set is obtained from <span class="math inline">\((\pm 2, \pm 2, 0, 0, 0, 0, 0, 0)\)</span> by taking an arbitrary combination of the signs and an arbitrary permutation of the coordinates. This gives <span class="math inline">\(2^2 \tbinom{8}{2} = 112\)</span> vertices, that one can obtain as follows in R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>combs &lt;-<span class="st"> </span>arrangements<span class="op">::</span><span class="kw">combinations</span>(8L, 2L)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>vertices1 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(combs)){</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>  comb &lt;-<span class="st"> </span>combs[i, ]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a>  <span class="cf">for</span>(x <span class="cf">in</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>    <span class="cf">for</span>(y <span class="cf">in</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)){</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>      zeros &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, 8L)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>      zeros[comb[1L]] &lt;-<span class="st"> </span>x</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>      zeros[comb[2L]] &lt;-<span class="st"> </span>y</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>      vertices1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(vertices1, zeros)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>    }</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>  }</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>Indeed we get <span class="math inline">\(112\)</span> vertices, in a matrix with stupid row names:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">str</span>(vertices1)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="co">##  num [1:112, 1:8] -2 -2 2 2 -2 -2 2 2 -2 -2 ...</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="co">##  - attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co">##   ..$ : chr [1:112] &quot;zeros&quot; &quot;zeros&quot; &quot;zeros&quot; &quot;zeros&quot; ...</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co">##   ..$ : NULL</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="kw">head</span>(vertices1)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="co">##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="co">## zeros   -2   -2    0    0    0    0    0    0</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="co">## zeros   -2    2    0    0    0    0    0    0</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a><span class="co">## zeros    2   -2    0    0    0    0    0    0</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a><span class="co">## zeros    2    2    0    0    0    0    0    0</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a><span class="co">## zeros   -2    0   -2    0    0    0    0    0</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="co">## zeros   -2    0    2    0    0    0    0    0</span></span></code></pre></div>
<p>The second set of vertices is obtained from <span class="math inline">\((\pm 1, \ldots, \pm 1)\)</span> by taking an even number of minus signs. As noted in the Wikipedia article, this amounts to say that the sum of the coordinates is a multiple of <span class="math inline">\(4\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>vertices2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>grd &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">expand.grid</span>(<span class="kw">rep</span>(<span class="kw">list</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)), 8L)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(grd)){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>  v &lt;-<span class="st"> </span>grd[i, ]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(v) <span class="op">%%</span><span class="st"> </span><span class="dv">4</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>    vertices2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(vertices2, v)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>  }</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>This gives <span class="math inline">\(128\)</span> vertices, again in a matrix with stupid row names:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">str</span>(vertices2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="co">##  num [1:128, 1:8] -1 1 1 -1 1 -1 -1 1 1 -1 ...</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="co">##  - attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co">##   ..$ : chr [1:128] &quot;v&quot; &quot;v&quot; &quot;v&quot; &quot;v&quot; ...</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="co">##   ..$ : chr [1:8] &quot;Var1&quot; &quot;Var2&quot; &quot;Var3&quot; &quot;Var4&quot; ...</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="kw">head</span>(vertices2)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="co">##   Var1 Var2 Var3 Var4 Var5 Var6 Var7 Var8</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="co">## v   -1   -1   -1   -1   -1   -1   -1   -1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="co">## v    1    1   -1   -1   -1   -1   -1   -1</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a><span class="co">## v    1   -1    1   -1   -1   -1   -1   -1</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a><span class="co">## v   -1    1    1   -1   -1   -1   -1   -1</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="co">## v    1   -1   -1    1   -1   -1   -1   -1</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="co">## v   -1    1   -1    1   -1   -1   -1   -1</span></span></code></pre></div>
<p>So here is our matrix of <span class="math inline">\(240\)</span> vertices:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>vertices &lt;-<span class="st"> </span><span class="kw">rbind</span>(vertices1, vertices2)</span></code></pre></div>
<p>Well. Now, how to get the <em>edges</em> of the polytope? An edge is a pair of connected (adjacent) vertices, and it is better to store them as pairs of vertex indices (the row indices of our <code>vertices</code> matrix).</p>
<p>My first attempt was to resort to my package <strong>cxhull</strong>. Indeed, the E8 root polytope is convex, therefore its convex hull is itself, and the <code>cxhull</code> function of the <strong>cxhull</strong> package provides the edges of the convex hull. Therefore, I ran:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">library</span>(cxhull)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>hull &lt;-<span class="st"> </span><span class="kw">cxhull</span>(vertices, <span class="dt">triangulate =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>What a disaster! <strong><em>Do not run this code!</em></strong> It totally crashed my laptop. Perhaps that can work with more RAM, I don’t know (I have only 8 Gb). I searched and I searched on the web, with no luck, I didn’t find these edges. So I decided to search another computational geometry library, able to get these edges. I thought of the C library <a href="https://people.inf.ethz.ch/fukudak/cdd_home/">cddlib</a>. I’m not a star in C but this library is wrapped in the Julia library <a href="https://github.com/JuliaPolyhedra/CDDLib.jl">CDDLib.jl</a>. No luck: this wrapper is incomplete and the vertex adjacency was not available in this library. Then I opened an issue on the Github repo to request this feature, and I looked at the documentation of the Python wrapper of <strong>cddlib</strong>: the <strong>pycddlib</strong> library. Very nice: it provides the vertex adjacency feature. I didn’t have the courage to program the construction of the vertices in Python, so I used <a href="https://laustep.github.io/stlahblog/posts/Rmatrix2HaskellList.html">my old blog post</a>, <em>“A R matrix to a Haskell list”</em>, since it is also usable for Python instead of Haskell. But now let’s show how to construct the vertices in Python:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="im">from</span> itertools <span class="im">import</span> product, combinations</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>vertices <span class="op">=</span> []</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="co"># our `vertices1` in R:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="cf">for</span> i, j <span class="kw">in</span> combinations(<span class="bu">range</span>(<span class="dv">8</span>), <span class="dv">2</span>):</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>    <span class="cf">for</span> x, y <span class="kw">in</span> product([<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>], repeat <span class="op">=</span> <span class="dv">2</span>):</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>        v <span class="op">=</span> np.zeros(<span class="dv">8</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>        v[i] <span class="op">=</span> x</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>        v[j] <span class="op">=</span> y</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>        vertices.append(v)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a><span class="co"># our `vertices2` in R:</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a><span class="cf">for</span> v <span class="kw">in</span> product([<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>], repeat <span class="op">=</span> <span class="dv">8</span>):</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a>    <span class="cf">if</span> <span class="bu">sum</span>(v) <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a>        vertices.append(v)</span></code></pre></div>
<p>Actually I’m not the author of this code (I will come back to this point later). I have a long experience with R and a short experience with Python, so for me the construction of the vertices is easier in R. But I have to be honest: the Python code is more elegant.</p>
<p>Now, the edges. In fact <strong>pycddlib</strong> is simply called <strong>cdd</strong> in Python:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="im">import</span> cdd <span class="im">as</span> pcdd</span></code></pre></div>
<p>We want to do the so-called V-representation of the polytope (representation by the vertices), and then (I refer you to the documentation for this point), we have to prepend a <span class="math inline">\(1\)</span> to each vertex coordinates:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>vertices <span class="op">=</span> np.hstack((np.ones((<span class="dv">240</span>, <span class="dv">1</span>)), vertices))</span></code></pre></div>
<p>Now we’re ready for using <strong>pycddlib</strong>. Here is how I proceeded. I used the <code>get_input_adjacency</code> method to get the list of adjacent vertices for each vertex and from this list I constructed a two-columns matrix <code>Edges</code> to store the edges as pairs of vertex indices:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># make the polytope</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>mat <span class="op">=</span> pcdd.Matrix(vertices, linear <span class="op">=</span> <span class="va">False</span>, number_type <span class="op">=</span> <span class="st">&quot;fraction&quot;</span>) </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>mat.rep_type <span class="op">=</span> pcdd.RepType.GENERATOR</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>poly <span class="op">=</span> pcdd.Polyhedron(mat)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="co"># get the list of adjacencies</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>adjacencies <span class="op">=</span> [<span class="bu">list</span>(x) <span class="cf">for</span> x <span class="kw">in</span> poly.get_input_adjacency()]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a><span class="co"># construct the matrix of edges</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>edges <span class="op">=</span> [<span class="va">None</span>]<span class="op">*</span><span class="dv">240</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a><span class="cf">for</span> i, indices <span class="kw">in</span> <span class="bu">enumerate</span>(adjacencies):</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>    indices <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: x<span class="op">&gt;</span>i, indices))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>    l <span class="op">=</span> <span class="bu">len</span>(indices)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>    col1 <span class="op">=</span> np.full((l, <span class="dv">1</span>), i)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a>    indices <span class="op">=</span> np.reshape(indices, (l, <span class="dv">1</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>    edges[i] <span class="op">=</span> np.hstack((col1, indices))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>Edges <span class="op">=</span> np.vstack(<span class="bu">tuple</span>(edges))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>np.savetxt(<span class="st">&quot;E8_edges.csv&quot;</span>, Edges, fmt <span class="op">=</span> <span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span>, delimiter <span class="op">=</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>I saved the edges matrix in a <strong>csv</strong> file to import it in R (don’t forget to add <span class="math inline">\(1\)</span> to the indices if you do that).</p>
<p>In the meantime, the author of the Julia library <strong>CDDLib.jl</strong> kindly replied to my feature request, and now the vertex adjacencies are available in this library.</p>
<h2 id="projection-on-the-coxeter-plane">Projection on the Coxeter plane</h2>
<p>That’s fine to have the vertices and the edges of a 8-dimensional polytope but it remains to project it in 2D or 3D if we want to visualize something. The most known figure of a projection of the E8 root polytope is the one of its projection to the so-called Coxeter plane. No luck, I didn’t find on the web how to do this projection. I found another one, <a href="https://theoryofeverything.org/theToE/2016/03/16/e8-in-e6-petrie-projection/">here</a>. The author of this article provides an orthonormal basis of a plane in the 8D space, and when one takes the two coordinates of the projections of the vertices on this plane, one gets this figure:</p>
<p><img src="figures/E8_Petrie.png" /></p>
<p>Not bad. Of course I did a GIF:</p>
<p><img src="figures/E8_Petrie.gif" /></p>
<p>Finally, I found the orthonormal basis of the Coxeter plane in a <a href="https://github.com/SuperJason/python/blob/96989d1681085a87a0d7f488d926a1677cd7041f/famous_math_graphics/e8.py">Python script on Github</a>.</p>
<p>Do you recognize the beginning of the code? The author of this script is also the author of the Python code I provided earlier. I was astonished: he doesn’t use any computational geometry library to get the edges! I don’t know why, but two vertices are connected by an edge if and only if the squared distance between these vertices is <span class="math inline">\(8\)</span>. So you get the edges like this in R:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>edges &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>(<span class="kw">nrow</span>(vertices)<span class="op">-</span>1L)){</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>  v1 &lt;-<span class="st"> </span>vertices[i, ]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span>1L)<span class="op">:</span><span class="kw">nrow</span>(vertices)){</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>    v2 &lt;-<span class="st"> </span>vertices[j, ]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>    <span class="cf">if</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(v1<span class="op">-</span>v2)) <span class="op">==</span><span class="st"> </span><span class="dv">8</span>){</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>      edges &lt;-<span class="st"> </span><span class="kw">rbind</span>(edges, <span class="kw">c</span>(i, j))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>    }</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>  }</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>Also, I don’t understand the derivation of the basis of the Coxeter plane that is provided by this Python script. But it is easy to translate it in R. Here is the code, where I kept the comments of the Python script:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># A set of simple roots, listed by the rows of 'delta'</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>delta &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>, <span class="fl">-.5</span>, <span class="fl">-.5</span>, <span class="fl">-.5</span>, <span class="fl">-.5</span>, <span class="fl">-.5</span>, <span class="fl">-.5</span>, <span class="fl">-.5</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">0</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a><span class="co"># Dynkin diagram of E8:</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a><span class="co"># 1---2---3---4---5---6---7</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a><span class="co">#                 |</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a><span class="co">#                 8</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a><span class="co"># where vertex i is the i-th simple root.</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a><span class="co"># The Cartan matrix:</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a>Cartan &lt;-<span class="st"> </span><span class="kw">tcrossprod</span>(delta)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a><span class="co"># Now we split the simple roots into two disjoint sets I and J</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a><span class="co"># such that the simple roots in each set are pairwise orthogonal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a><span class="co"># It's obvious to see how to find such a partition given the</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a><span class="co"># Dynkin graph above: I = [1, 3, 5, 7] and J = [2, 4, 6, 8],</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a><span class="co"># since roots are not connected by an edge if and only if they are orthogonal.</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a><span class="co"># Then a basis of the Coxeter plane is given by</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a><span class="co"># u1 = sum (c[i] * delta[i]) for i in I,</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true"></a><span class="co"># u2 = sum (c[j] * delta[j]) for j in J,</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true"></a><span class="co"># where c is an eigenvector for the minimal</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true"></a><span class="co"># eigenvalue of the Cartan matrix.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true"></a>eig &lt;-<span class="st"> </span><span class="kw">eigen</span>(Cartan)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true"></a><span class="co"># The eigenvalues returned by eigen() are in descending order</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true"></a><span class="co"># and the eigenvectors are listed by columns.</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true"></a>ev &lt;-<span class="st"> </span>eig<span class="op">$</span>vectors[, 8L]</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true"></a>u1 &lt;-<span class="st"> </span><span class="kw">rowSums</span>(<span class="kw">vapply</span>(<span class="kw">c</span>(1L, 3L, 5L, 7L), <span class="cf">function</span>(i){</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true"></a>  ev[i] <span class="op">*</span><span class="st"> </span>delta[i, ]</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true"></a>}, <span class="kw">numeric</span>(8L)))</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true"></a>u2 &lt;-<span class="st"> </span><span class="kw">rowSums</span>(<span class="kw">vapply</span>(<span class="kw">c</span>(2L, 4L, 6L, 8L), <span class="cf">function</span>(i){</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true"></a>  ev[i] <span class="op">*</span><span class="st"> </span>delta[i, ]</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true"></a>}, <span class="kw">numeric</span>(8L)))</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true"></a><span class="co"># Gram-Schmidt u1, u2 </span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true"></a>u1 &lt;-<span class="st"> </span>u1 <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(u1)))</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true"></a>u2 &lt;-<span class="st"> </span>u2 <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">crossprod</span>(u1, u2)) <span class="op">*</span><span class="st"> </span>u1</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true"></a>u2 &lt;-<span class="st"> </span>u2 <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(u2)))</span></code></pre></div>
<p>I understand nothing, except the Gram-Schmidt step.</p>
<p>But this works. Let’s project the vertices to the Coxeter plane, i.e. the plane with the orthonormal basis <span class="math inline">\((u_1, u_2)\)</span>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># projections on the Coxeter plane</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>proj &lt;-<span class="st"> </span><span class="cf">function</span>(v){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(v, u1)), <span class="kw">c</span>(<span class="kw">crossprod</span>(v, u2)))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>}</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>points &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(vertices<span class="op">/</span><span class="dv">2</span>, 1L, proj))</span></code></pre></div>
<p>Now you can represent these 2D points and connect them with the edges. But if you do that with an ordinary base R plot, you will not get a pretty figure, because there are too many edges. So I do a SVG plot:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="co"># save plot as SVG</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="kw">svg</span>(<span class="dt">filename =</span> <span class="st">&quot;E8_Coxeter.svg&quot;</span>, <span class="dt">onefile =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a><span class="kw">plot</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>  points[<span class="op">!</span><span class="kw">duplicated</span>(points), ], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">asp =</span> <span class="dv">1</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>  <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="ot">NA</span>, <span class="dt">ylab =</span> <span class="ot">NA</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(edges)){</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a>  <span class="kw">lines</span>(points[edges[i, ], ], <span class="dt">lwd =</span> <span class="fl">0.1</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a>}</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a><span class="kw">par</span>(opar)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<p>And then I convert it to a PNG image with the help of the <strong>rsvg</strong> package:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>rsvg<span class="op">::</span><span class="kw">rsvg_png</span>(<span class="st">&quot;E8_Coxeter.svg&quot;</span>, <span class="dt">file =</span> <span class="st">&quot;E8_Coxeter.png&quot;</span>)</span></code></pre></div>
<p>This gives this image:</p>
<p><img src="figures/E8_Coxeter.png" /></p>
<p>Rather pretty. But this lacks of colors. And of motion. Well, you see what I mean: I did a GIF.</p>
<p><img src="figures/E8_Coxeter.gif" /></p>
<p>If you want to know how I did this GIF, visit <a href="https://gist.github.com/stla/19529d44a20bab4420bdd1a213ebcdbc">my gist</a>.</p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->


</html>