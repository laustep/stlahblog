<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My Hakyll Blog - The `owen` library for Haskell</title>
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  <link rel="stylesheet" href="../css/hscolour.css" />  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>

<body>
  <!-- Sidebar. -->
  <div class="sidebar">
    <div style="float:right;clear:both;margin-right:50px;margin-top:150px;">
      <a href="https://www.r-bloggers.com/">
        <img src="https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png" alt="stla" width="100%" />
      </a>
      <br />
      <a href="http://t-redactyl.io/">
        <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:30px;">Standard error</span>
      </a>
      <a href="http://timelyportfolio.blogspot.be/">
        <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:30px;">Timely portfolio</span>
      </a>
    </div>
  </div>

  <div class="main">
    <div id="header">
      <div id="logo" style="position:absolute;">
        <a href="../"><img src="../images/stla.jpg" alt="stla" width="100px" /></a>
      </div>
      <div id="navigation" style="margin-top:50px;">
        <a href="../">Home</a>
        <a href="../about.html">About</a>
        <a href="../contact.html">Contact</a>
        <a href="../archive.html">Archive</a>
      </div>
    </div>

    <div class="content">
      <h1>The `owen` library for Haskell</h1> <div class="info">
    Posted on June  1, 2017
    
        by Stéphane Laurent
    
</div>

<p>The <code>owen</code> library is available <a href="https://github.com/stla/owen">on Github</a>. The functions it provides are described and illustrated in this post.</p>
<h2 id="owen-t-function">Owen <span class="math inline">\(T\)</span>-function</h2>
<p>The Owen <span class="math inline">\(T\)</span>-function is defined by <span class="math display">\[
T(h,a) = \frac{1}{2\pi}\int_0^a \frac{e^{-\frac12 h^2(1+x^2)}}{1+x^2}\mathrm{d}x
\]</span> for <span class="math inline">\(a, h \in \mathbb{R}\)</span>. It corresponds to a certain probability and then its value always lies between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>Below we compare some obtained values of <span class="math inline">\(T(h, a)\)</span> to the ones given by Wolfram up to <span class="math inline">\(20\)</span> digits:</p>
<div class="sourceCode">
<pre class="scriptHaskell"><code class="scriptHaskell"><span class="prompt">></span> <span class="hs-keyword">import</span> <span class="hs-conid">OwenT</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-num">0.1</span> <span class="hs-num">0.1</span>   <span class="hs-varop">-</span> <span class="hs-num">0.01578338051718359918</span>
<span class="output">3.469446951953614e-18</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-num">1</span> <span class="hs-num">0.5</span>     <span class="hs-varop">-</span> <span class="hs-num">0.04306469112078536563</span>
<span class="output">6.938893903907228e-18</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-num">0.5</span> <span class="hs-num">0.1</span>   <span class="hs-varop">-</span> <span class="hs-num">0.01399302023628015424</span>
<span class="output">1.734723475976807e-18</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-num">0.5</span> <span class="hs-num">0.9</span>   <span class="hs-varop">-</span> <span class="hs-num">0.10007270175061385845</span>
<span class="output">0.0</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-num">5</span> <span class="hs-num">0.5</span>     <span class="hs-varop">-</span> <span class="hs-num">0.00000014192549621069</span>
<span class="output">-2.6903883987164715e-18</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-num">2</span> <span class="hs-num">0.99999</span> <span class="hs-varop">-</span> <span class="hs-num">0.01111626714677311317</span>
<span class="output">-4.683753385137379e-17</span>
</code></pre>
</div>
<p><br /></p>
<p>The <code>owenT</code> function allows infinite values of <span class="math inline">\(h\)</span> and <span class="math inline">\(a\)</span>:</p>
<div class="sourceCode">
<pre class="scriptHaskell"><code class="scriptHaskell"><span class="prompt">></span> <span class="hs-keyword">import</span> <span class="hs-conid">OwenT</span>
<span class="prompt">></span> <span class="hs-keyword">import</span> <span class="hs-conid">Data</span><span class="hs-varop">.</span><span class="hs-conid">Number</span><span class="hs-varop">.</span><span class="hs-conid">Erf</span> 
<span class="prompt">></span> <span class="hs-comment">-- zero: </span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-layout">(</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">3</span>
<span class="output">0.0</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-layout">(</span><span class="hs-varop">-</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">3</span>
<span class="output">0.0</span>
<span class="prompt">></span> <span class="hs-comment">-- equality:</span>
<span class="prompt">></span> <span class="hs-definition">owenT</span> <span class="hs-num">1</span> <span class="hs-layout">(</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span>
<span class="output">7.932762696572854e-2</span>
<span class="prompt">></span> <span class="hs-layout">(</span><span class="hs-num">1</span> <span class="hs-varop">-</span> <span class="hs-varid">normcdf</span> <span class="hs-num">1</span><span class="hs-layout">)</span><span class="hs-varop">/</span><span class="hs-num">2</span>
<span class="output">7.932762696572854e-2</span>
</code></pre>
</div>
<p><br /></p>
<p>The algorithm runs as follows. If <span class="math inline">\(0 \leq a \leq 1\)</span>, and <span class="math inline">\(0 \leq h \leq 8\)</span>, a series expansion is used, the one given by Owen (1956). The series is truncated after the <span class="math inline">\(50\)</span>-th term. If <span class="math inline">\(0\leq a \leq 1\)</span>, and <span class="math inline">\(h \geq 8\)</span>, an asymptotic approximation is used. Otherwise, the properties of the Owen <span class="math inline">\(T\)</span>-function are exploited to come down to the case <span class="math inline">\(0 \leq a \leq 1\)</span>. The main property involves the Gaussian cumulative function.</p>
<p>As shown by Owen (1956), the Owen <span class="math inline">\(T\)</span>-function can be used to evaluate the cumulative distribution function of the bivariate Gaussian distribution.</p>
<h2 id="non-central-student-distribution">Non-central Student distribution</h2>
<p>The <code>pStudent</code> function of the <code>owen</code> library evaluates the cumulative distribution function of the non-central Student distribution with an <em>integer</em> number of degrees of freedom. For odd values, the algorithm resorts to the Owen <span class="math inline">\(T\)</span>-function. This algorithm is the one given by Owen (1965).</p>
<p>Below we compare some values to the ones given by R:</p>
<div class="sourceCode">
<pre class="scriptHaskell"><code class="scriptHaskell"><span class="prompt">></span> <span class="hs-keyword">import</span> <span class="hs-conid">Student</span>
<span class="prompt">></span> <span class="hs-definition">pStudent</span> <span class="hs-num">0.5</span> <span class="hs-num">2</span> <span class="hs-num">2.5</span> <span class="hs-varop">-</span> <span class="hs-num">0.022741814853305026</span>
<span class="output">6.259229246019515e-14</span>
<span class="prompt">></span> <span class="hs-definition">pStudent</span> <span class="hs-num">0.5</span> <span class="hs-num">3</span> <span class="hs-num">2.5</span> <span class="hs-varop">-</span> <span class="hs-num">0.022741355255468675</span>
<span class="output">1.8677767665842282e-13</span>
</code></pre>
</div>
<h2 id="owen-q-function">Owen Q-function</h2>
<p>The first Owen <span class="math inline">\(Q\)</span>-function is defined by <span class="math display">\[
Q_1(\nu, t, \delta, R) = \frac{1}{\Gamma\left(\frac{\nu}{2}\right)2^{\frac12(\nu-2)}}
\int_0^R \Phi\left(\frac{tx}{\sqrt{\nu}}-\delta\right)
x^{\nu-1} e^{-\frac{x^2}{2}} \mathrm{d}x
\]</span> for <span class="math inline">\(\nu &gt;0\)</span>, <span class="math inline">\(t, \delta \in \mathbb{R}\)</span> and <span class="math inline">\(R&gt;0\)</span>.</p>
<p>Its value always lies between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>It is implemented in the <code>owen</code> library for <em>integer</em> values of <span class="math inline">\(\nu\)</span>, under the name <code>owenQ1</code>. The algorithm used is the one given by Owen (1965).</p>
<p>The results are theoretically exact for even values of <span class="math inline">\(\nu\)</span>, up to the fact that the function resorts to the Gaussian cumulative function. For odd values of <span class="math inline">\(\nu\)</span>, it also resorts to the Owen <span class="math inline">\(T\)</span>-function.</p>
<p>Below we compare some obtained values of <span class="math inline">\(Q_1(\nu, t, \delta, R)\)</span> to the ones given by Wolfram up to <span class="math inline">\(20\)</span> digits:</p>
<div class="sourceCode">
<pre class="scriptHaskell"><code class="scriptHaskell"><span class="prompt">></span> <span class="hs-keyword">import</span> <span class="hs-conid">OwenQ</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">1</span> <span class="hs-num">3</span> <span class="hs-num">2</span> <span class="hs-num">5</span>  <span class="hs-varop">-</span> <span class="hs-num">0.52485658843054409291</span>
<span class="output">2.220446049250313e-16</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">2</span> <span class="hs-num">3</span> <span class="hs-num">2</span> <span class="hs-num">5</span>  <span class="hs-varop">-</span> <span class="hs-num">0.62938193306526904118</span>
<span class="output">-1.1102230246251565e-16</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">9</span> <span class="hs-num">3</span> <span class="hs-num">2</span> <span class="hs-num">5</span>  <span class="hs-varop">-</span> <span class="hs-num">0.77030437685878389173</span>
<span class="output">-1.1102230246251565e-16</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">10</span> <span class="hs-num">3</span> <span class="hs-num">2</span> <span class="hs-num">5</span> <span class="hs-varop">-</span> <span class="hs-num">0.77383547873740988537</span>
<span class="output">1.1102230246251565e-16</span>
</code></pre>
</div>
<p><br /></p>
<p>The <code>owenQ1</code> function also returns a value for <span class="math inline">\(t,\delta=\pm \infty\)</span>:</p>
<div class="sourceCode">
<pre class="scriptHaskell"><code class="scriptHaskell"><span class="prompt">></span> <span class="hs-keyword">import</span> <span class="hs-conid">OwenQ</span>
<span class="prompt">></span> <span class="hs-keyword">import</span> <span class="hs-conid">Math</span><span class="hs-varop">.</span><span class="hs-conid">Gamma</span> <span class="hs-keyword">as</span> <span class="hs-conid">G</span>
<span class="prompt">></span> <span class="hs-comment">-- zero:</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">3</span> <span class="hs-layout">(</span><span class="hs-varop">-</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">2</span> <span class="hs-num">2</span> 
<span class="output">0.0</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">3</span> <span class="hs-num">2</span> <span class="hs-layout">(</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">2</span>  
<span class="output">0.0</span>
<span class="prompt">></span> <span class="hs-comment">-- equalities:</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">5</span> <span class="hs-layout">(</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">9</span> <span class="hs-num">3</span>
<span class="output">0.8909358420502276</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">5</span> <span class="hs-layout">(</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">99</span> <span class="hs-num">3</span>
<span class="output">0.8909358420502276</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">5</span> <span class="hs-num">99</span> <span class="hs-layout">(</span><span class="hs-varop">-</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">3</span>
<span class="output">0.8909358420502276</span>
<span class="prompt">></span> <span class="hs-definition">owenQ1</span> <span class="hs-num">5</span> <span class="hs-num">9</span> <span class="hs-layout">(</span><span class="hs-varop">-</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-num">0</span><span class="hs-layout">)</span> <span class="hs-num">3</span>
<span class="output">0.8909358420502276</span>
<span class="prompt">></span> <span class="hs-conid">G</span><span class="hs-varop">.</span><span class="hs-varid">p</span> <span class="hs-layout">(</span><span class="hs-num">5</span><span class="hs-varop">/</span><span class="hs-num">2</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-num">3</span><span class="hs-varop">^</span><span class="hs-num">2</span><span class="hs-varop">/</span><span class="hs-num">2</span><span class="hs-layout">)</span>
<span class="output">0.8909358420502276</span>
</code></pre>
</div>
<h2 id="references">References</h2>
<ul>
<li><p>Owen, D. B. (1956). Tables for computing bivariate normal probabilities. <em>Ann. Math. Statist.</em> <strong>27</strong>, 1075-90.</p></li>
<li><p>Owen, D. B. (1965). A Special Case of a Bivariate Non-Central <span class="math inline">\(t\)</span>-Distribution. <em>Biometrika</em> <strong>52</strong>, 437-446.</p></li>
</ul>

    </div>


    <div id="footer">
      Site proudly generated by
      <a href="http://jaspervdj.be/hakyll">Hakyll</a>
    </div>

  </div>

  <div id="disqus_thread"></div>
  <div class="pagination">
    <ul>
      <li><a href="http://laustep.github.io/stlahblog/">« Back Home</a></li>
    </ul>
  </div>
</body>
<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->

<!-- Google Prettify -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script> -->
<script src="../libraries/highlighters/prettify/js/lang-r.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i = 0; i < pres.length; ++i) {
    pres[i].className = pres[i].className + " prettyprint linenums";
  }
  prettyPrint();
</script>


</html>
