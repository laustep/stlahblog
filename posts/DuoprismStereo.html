<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Drawing a stereographic duoprism</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:25px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:21px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Drawing a stereographic duoprism</h1> 
          <div class="info">
    Posted on February 11, 2020
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a title="All pages tagged 'R'." href="../tags/R.html">R</a>, <a title="All pages tagged 'maths'." href="../tags/maths.html">maths</a>, <a title="All pages tagged 'geometry'." href="../tags/geometry.html">geometry</a>, <a title="All pages tagged 'graphics'." href="../tags/graphics.html">graphics</a>, <a title="All pages tagged 'rgl'." href="../tags/rgl.html">rgl</a>, <a title="All pages tagged 'asymptote'." href="../tags/asymptote.html">asymptote</a>, <a title="All pages tagged 'povray'." href="../tags/povray.html">povray</a>
    
</div>

<p>In this post, I’ll show how to draw a stereographic <a href="./Duoprism.html">duoprism</a> using R, Asymptote and POV-Ray.</p>
<h1 id="with-r">With R</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(rgl)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>A &lt;-<span class="st"> </span>8L <span class="co"># number of sides of the first polygon</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>B &lt;-<span class="st"> </span>4L <span class="co"># number of sides of the second polygon</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># construction of the vertices</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>vertices &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_real_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(A,B,4L))</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>A){</span>
<span id="cb1-9"><a href="#cb1-9"></a>  v1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(i<span class="op">/</span>A<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi), <span class="kw">sin</span>(i<span class="op">/</span>A<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi))</span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="cf">for</span>(j <span class="cf">in</span> 1L<span class="op">:</span>B){</span>
<span id="cb1-11"><a href="#cb1-11"></a>    v2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(j<span class="op">/</span>B<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi), <span class="kw">sin</span>(j<span class="op">/</span>B<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi))</span>
<span id="cb1-12"><a href="#cb1-12"></a>    vertices[i,j,] &lt;-<span class="st"> </span><span class="kw">c</span>(v1,v2)</span>
<span id="cb1-13"><a href="#cb1-13"></a>  }</span>
<span id="cb1-14"><a href="#cb1-14"></a>}</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># construction of the edges</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>edges &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_integer_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(2L,2L,2L<span class="op">*</span>A<span class="op">*</span>B))</span>
<span id="cb1-18"><a href="#cb1-18"></a>dominates &lt;-<span class="st"> </span><span class="cf">function</span>(c1, c2){</span>
<span id="cb1-19"><a href="#cb1-19"></a>  c2[1L]<span class="op">&gt;</span>c1[1L] <span class="op">||</span><span class="st"> </span>(c2[1L]<span class="op">==</span>c1[1L] <span class="op">&amp;&amp;</span><span class="st"> </span>c2[2L]<span class="op">&gt;</span>c1[2L])</span>
<span id="cb1-20"><a href="#cb1-20"></a>}</span>
<span id="cb1-21"><a href="#cb1-21"></a>counter &lt;-<span class="st"> </span>1L</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_len</span>(A)<span class="op">-</span>1L){</span>
<span id="cb1-23"><a href="#cb1-23"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_len</span>(B)<span class="op">-</span>1L){</span>
<span id="cb1-24"><a href="#cb1-24"></a>    c1 &lt;-<span class="st"> </span><span class="kw">c</span>(i,j)</span>
<span id="cb1-25"><a href="#cb1-25"></a>    candidate &lt;-<span class="st"> </span><span class="kw">c</span>(i, (j<span class="op">-</span>1L)<span class="op">%%</span>B)</span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</span>
<span id="cb1-27"><a href="#cb1-27"></a>      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-28"><a href="#cb1-28"></a>      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-29"><a href="#cb1-29"></a>    }</span>
<span id="cb1-30"><a href="#cb1-30"></a>    candidate &lt;-<span class="st"> </span><span class="kw">c</span>(i, (j<span class="op">+</span>1L)<span class="op">%%</span>B)</span>
<span id="cb1-31"><a href="#cb1-31"></a>    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</span>
<span id="cb1-32"><a href="#cb1-32"></a>      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-33"><a href="#cb1-33"></a>      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-34"><a href="#cb1-34"></a>    }</span>
<span id="cb1-35"><a href="#cb1-35"></a>    candidate &lt;-<span class="st"> </span><span class="kw">c</span>((i<span class="op">-</span>1L)<span class="op">%%</span>A, j)</span>
<span id="cb1-36"><a href="#cb1-36"></a>    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</span>
<span id="cb1-37"><a href="#cb1-37"></a>      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-38"><a href="#cb1-38"></a>      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-39"><a href="#cb1-39"></a>    }</span>
<span id="cb1-40"><a href="#cb1-40"></a>    candidate &lt;-<span class="st"> </span><span class="kw">c</span>((i<span class="op">+</span>1L)<span class="op">%%</span>A, j)</span>
<span id="cb1-41"><a href="#cb1-41"></a>    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</span>
<span id="cb1-42"><a href="#cb1-42"></a>      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-43"><a href="#cb1-43"></a>      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb1-44"><a href="#cb1-44"></a>    }</span>
<span id="cb1-45"><a href="#cb1-45"></a>  }</span>
<span id="cb1-46"><a href="#cb1-46"></a>}</span>
<span id="cb1-47"><a href="#cb1-47"></a></span>
<span id="cb1-48"><a href="#cb1-48"></a><span class="co"># stereographic projection</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>stereog &lt;-<span class="st"> </span><span class="cf">function</span>(v){</span>
<span id="cb1-50"><a href="#cb1-50"></a>  v[1L<span class="op">:</span>3L] <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>v[4L])</span>
<span id="cb1-51"><a href="#cb1-51"></a>}</span>
<span id="cb1-52"><a href="#cb1-52"></a></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="co"># spherical segment</span></span>
<span id="cb1-54"><a href="#cb1-54"></a>sphericalSegment &lt;-<span class="st"> </span><span class="cf">function</span>(P, Q, n){</span>
<span id="cb1-55"><a href="#cb1-55"></a>  out &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_real_</span>, <span class="dt">nrow =</span> n<span class="op">+</span>1L, <span class="dt">ncol =</span> 4L)</span>
<span id="cb1-56"><a href="#cb1-56"></a>  <span class="cf">for</span>(i <span class="cf">in</span> 0L<span class="op">:</span>n){</span>
<span id="cb1-57"><a href="#cb1-57"></a>    pt &lt;-<span class="st"> </span>P <span class="op">+</span><span class="st"> </span>(i<span class="op">/</span>n)<span class="op">*</span>(Q<span class="op">-</span>P)</span>
<span id="cb1-58"><a href="#cb1-58"></a>    out[i<span class="op">+</span>1L, ] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">c</span>(<span class="kw">crossprod</span>(pt))) <span class="op">*</span><span class="st"> </span>pt</span>
<span id="cb1-59"><a href="#cb1-59"></a>  }</span>
<span id="cb1-60"><a href="#cb1-60"></a>  out</span>
<span id="cb1-61"><a href="#cb1-61"></a>}</span>
<span id="cb1-62"><a href="#cb1-62"></a></span>
<span id="cb1-63"><a href="#cb1-63"></a><span class="co"># stereographic edge</span></span>
<span id="cb1-64"><a href="#cb1-64"></a>stereoEdge &lt;-<span class="st"> </span><span class="cf">function</span>(verts, v1, v2){</span>
<span id="cb1-65"><a href="#cb1-65"></a>  P &lt;-<span class="st"> </span>verts[v1[1L], v1[2L], ]</span>
<span id="cb1-66"><a href="#cb1-66"></a>  Q &lt;-<span class="st"> </span>verts[v2[1L], v2[2L], ]</span>
<span id="cb1-67"><a href="#cb1-67"></a>  PQ &lt;-<span class="st"> </span><span class="kw">sphericalSegment</span>(P, Q, 100L)</span>
<span id="cb1-68"><a href="#cb1-68"></a>  pq &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(PQ, 1L, stereog))</span>
<span id="cb1-69"><a href="#cb1-69"></a>  dists &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">apply</span>(pq, 1L, crossprod))</span>
<span id="cb1-70"><a href="#cb1-70"></a>  <span class="kw">cylinder3d</span>(pq, <span class="dt">radius =</span> dists<span class="op">/</span><span class="dv">15</span>, <span class="dt">sides =</span> <span class="dv">60</span>)</span>
<span id="cb1-71"><a href="#cb1-71"></a>}</span>
<span id="cb1-72"><a href="#cb1-72"></a></span>
<span id="cb1-73"><a href="#cb1-73"></a><span class="co"># projected vertices</span></span>
<span id="cb1-74"><a href="#cb1-74"></a>vs &lt;-<span class="st"> </span><span class="kw">apply</span>(vertices, <span class="kw">c</span>(1L,2L), stereog)</span>
<span id="cb1-75"><a href="#cb1-75"></a></span>
<span id="cb1-76"><a href="#cb1-76"></a><span class="co">####~~~~ plot ~~~~####</span></span>
<span id="cb1-77"><a href="#cb1-77"></a><span class="kw">open3d</span>(<span class="dt">windowRect =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">562</span>, <span class="dv">562</span>), <span class="dt">zoom =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-78"><a href="#cb1-78"></a><span class="kw">bg3d</span>(<span class="kw">rgb</span>(<span class="dv">54</span>, <span class="dv">57</span>, <span class="dv">64</span>, <span class="dt">maxColorValue =</span> <span class="dv">255</span>))</span>
<span id="cb1-79"><a href="#cb1-79"></a><span class="co">## plot the edges</span></span>
<span id="cb1-80"><a href="#cb1-80"></a><span class="cf">for</span>(k <span class="cf">in</span> 1L<span class="op">:</span>(2L<span class="op">*</span>A<span class="op">*</span>B)){</span>
<span id="cb1-81"><a href="#cb1-81"></a>  v1 &lt;-<span class="st"> </span>edges[, 1L, k]</span>
<span id="cb1-82"><a href="#cb1-82"></a>  v2 &lt;-<span class="st"> </span>edges[, 2L, k]</span>
<span id="cb1-83"><a href="#cb1-83"></a>  edge &lt;-<span class="st"> </span><span class="kw">stereoEdge</span>(vertices, v1, v2)</span>
<span id="cb1-84"><a href="#cb1-84"></a>  <span class="kw">shade3d</span>(edge, <span class="dt">color =</span> <span class="st">&quot;gold&quot;</span>)</span>
<span id="cb1-85"><a href="#cb1-85"></a>}</span>
<span id="cb1-86"><a href="#cb1-86"></a><span class="co">## plot the vertices</span></span>
<span id="cb1-87"><a href="#cb1-87"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>A){</span>
<span id="cb1-88"><a href="#cb1-88"></a>  <span class="cf">for</span>(j <span class="cf">in</span> 1L<span class="op">:</span>B){</span>
<span id="cb1-89"><a href="#cb1-89"></a>    v &lt;-<span class="st"> </span>vs[,i,j]</span>
<span id="cb1-90"><a href="#cb1-90"></a>    <span class="kw">spheres3d</span>(v, <span class="dt">radius =</span> <span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(v)))<span class="op">/</span><span class="dv">10</span> , <span class="dt">color =</span> <span class="st">&quot;gold2&quot;</span>)</span>
<span id="cb1-91"><a href="#cb1-91"></a>  }</span>
<span id="cb1-92"><a href="#cb1-92"></a>}</span></code></pre></div>
<p><img src="./figures/DuoprismStereo_R.png" /></p>
<h1 id="with-asymptote">With Asymptote</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1"></a>settings.render = <span class="dv">4</span>;</span>
<span id="cb2-2"><a href="#cb2-2"></a>settings.outformat = <span class="st">&quot;eps&quot;</span>;</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">import</span> tube;</span>
<span id="cb2-4"><a href="#cb2-4"></a>size(<span class="dv">200</span>,<span class="dv">0</span>);</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>currentprojection = orthographic(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>);</span>
<span id="cb2-7"><a href="#cb2-7"></a>currentlight = light(gray(<span class="fl">0.85</span>), ambient=black, specularfactor=<span class="dv">3</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>                     (<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>), specular=gray(<span class="fl">0.9</span>), viewport=<span class="kw">false</span>);</span>
<span id="cb2-9"><a href="#cb2-9"></a>currentlight.background = rgb(<span class="st">&quot;363940ff&quot;</span>);</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">// files to be saved -----------------------------------------------------------</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>string[] files = {</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="st">&quot;DP000&quot;</span>, <span class="st">&quot;DP001&quot;</span>, <span class="st">&quot;DP002&quot;</span>, <span class="st">&quot;DP003&quot;</span>, <span class="st">&quot;DP004&quot;</span>, <span class="st">&quot;DP005&quot;</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="st">&quot;DP006&quot;</span>, <span class="st">&quot;DP007&quot;</span>, <span class="st">&quot;DP008&quot;</span>, <span class="st">&quot;DP009&quot;</span>, <span class="st">&quot;DP010&quot;</span>, <span class="st">&quot;DP011&quot;</span>,</span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="st">&quot;DP012&quot;</span>, <span class="st">&quot;DP013&quot;</span>, <span class="st">&quot;DP014&quot;</span>, <span class="st">&quot;DP015&quot;</span>, <span class="st">&quot;DP016&quot;</span>, <span class="st">&quot;DP017&quot;</span>,</span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="st">&quot;DP018&quot;</span>, <span class="st">&quot;DP019&quot;</span>, <span class="st">&quot;DP020&quot;</span>, <span class="st">&quot;DP021&quot;</span>, <span class="st">&quot;DP022&quot;</span>, <span class="st">&quot;DP023&quot;</span>,</span>
<span id="cb2-17"><a href="#cb2-17"></a>    <span class="st">&quot;DP024&quot;</span>, <span class="st">&quot;DP025&quot;</span>, <span class="st">&quot;DP026&quot;</span>, <span class="st">&quot;DP027&quot;</span>, <span class="st">&quot;DP028&quot;</span>, <span class="st">&quot;DP029&quot;</span>,</span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="st">&quot;DP030&quot;</span>, <span class="st">&quot;DP031&quot;</span>, <span class="st">&quot;DP032&quot;</span>, <span class="st">&quot;DP033&quot;</span>, <span class="st">&quot;DP034&quot;</span>, <span class="st">&quot;DP035&quot;</span>,</span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="st">&quot;DP036&quot;</span>, <span class="st">&quot;DP037&quot;</span>, <span class="st">&quot;DP038&quot;</span>, <span class="st">&quot;DP039&quot;</span>, <span class="st">&quot;DP040&quot;</span>, <span class="st">&quot;DP041&quot;</span>,</span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="st">&quot;DP042&quot;</span>, <span class="st">&quot;DP043&quot;</span>, <span class="st">&quot;DP044&quot;</span>, <span class="st">&quot;DP045&quot;</span>, <span class="st">&quot;DP046&quot;</span>, <span class="st">&quot;DP047&quot;</span>,</span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="st">&quot;DP048&quot;</span>, <span class="st">&quot;DP049&quot;</span>, <span class="st">&quot;DP050&quot;</span>, <span class="st">&quot;DP051&quot;</span>, <span class="st">&quot;DP052&quot;</span>, <span class="st">&quot;DP053&quot;</span>,</span>
<span id="cb2-22"><a href="#cb2-22"></a>    <span class="st">&quot;DP054&quot;</span>, <span class="st">&quot;DP055&quot;</span>, <span class="st">&quot;DP056&quot;</span>, <span class="st">&quot;DP057&quot;</span>, <span class="st">&quot;DP058&quot;</span>, <span class="st">&quot;DP059&quot;</span>,</span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="st">&quot;DP060&quot;</span>, <span class="st">&quot;DP061&quot;</span>, <span class="st">&quot;DP062&quot;</span>, <span class="st">&quot;DP063&quot;</span>, <span class="st">&quot;DP064&quot;</span>, <span class="st">&quot;DP065&quot;</span>,</span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="st">&quot;DP066&quot;</span>, <span class="st">&quot;DP067&quot;</span>, <span class="st">&quot;DP068&quot;</span>, <span class="st">&quot;DP069&quot;</span>, <span class="st">&quot;DP070&quot;</span>, <span class="st">&quot;DP071&quot;</span>,</span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="st">&quot;DP072&quot;</span>, <span class="st">&quot;DP073&quot;</span>, <span class="st">&quot;DP074&quot;</span>, <span class="st">&quot;DP075&quot;</span>, <span class="st">&quot;DP076&quot;</span>, <span class="st">&quot;DP077&quot;</span>,</span>
<span id="cb2-26"><a href="#cb2-26"></a>    <span class="st">&quot;DP078&quot;</span>, <span class="st">&quot;DP079&quot;</span>, <span class="st">&quot;DP080&quot;</span>, <span class="st">&quot;DP081&quot;</span>, <span class="st">&quot;DP082&quot;</span>, <span class="st">&quot;DP083&quot;</span>,</span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="st">&quot;DP084&quot;</span>, <span class="st">&quot;DP085&quot;</span>, <span class="st">&quot;DP086&quot;</span>, <span class="st">&quot;DP087&quot;</span>, <span class="st">&quot;DP088&quot;</span>, <span class="st">&quot;DP089&quot;</span>,</span>
<span id="cb2-28"><a href="#cb2-28"></a>    <span class="st">&quot;DP090&quot;</span>, <span class="st">&quot;DP091&quot;</span>, <span class="st">&quot;DP092&quot;</span>, <span class="st">&quot;DP093&quot;</span>, <span class="st">&quot;DP094&quot;</span>, <span class="st">&quot;DP095&quot;</span>,</span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="st">&quot;DP096&quot;</span>, <span class="st">&quot;DP097&quot;</span>, <span class="st">&quot;DP098&quot;</span>, <span class="st">&quot;DP099&quot;</span>, <span class="st">&quot;DP100&quot;</span>, <span class="st">&quot;DP101&quot;</span>,</span>
<span id="cb2-30"><a href="#cb2-30"></a>    <span class="st">&quot;DP102&quot;</span>, <span class="st">&quot;DP103&quot;</span>, <span class="st">&quot;DP104&quot;</span>, <span class="st">&quot;DP105&quot;</span>, <span class="st">&quot;DP106&quot;</span>, <span class="st">&quot;DP107&quot;</span>,</span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="st">&quot;DP108&quot;</span>, <span class="st">&quot;DP109&quot;</span>, <span class="st">&quot;DP110&quot;</span>, <span class="st">&quot;DP111&quot;</span>, <span class="st">&quot;DP112&quot;</span>, <span class="st">&quot;DP113&quot;</span>,</span>
<span id="cb2-32"><a href="#cb2-32"></a>    <span class="st">&quot;DP114&quot;</span>, <span class="st">&quot;DP115&quot;</span>, <span class="st">&quot;DP116&quot;</span>, <span class="st">&quot;DP117&quot;</span>, <span class="st">&quot;DP118&quot;</span>, <span class="st">&quot;DP119&quot;</span>,</span>
<span id="cb2-33"><a href="#cb2-33"></a>    <span class="st">&quot;DP120&quot;</span>, <span class="st">&quot;DP121&quot;</span>, <span class="st">&quot;DP122&quot;</span>, <span class="st">&quot;DP123&quot;</span>, <span class="st">&quot;DP124&quot;</span>, <span class="st">&quot;DP125&quot;</span>,</span>
<span id="cb2-34"><a href="#cb2-34"></a>    <span class="st">&quot;DP126&quot;</span>, <span class="st">&quot;DP127&quot;</span>, <span class="st">&quot;DP128&quot;</span>, <span class="st">&quot;DP129&quot;</span>, <span class="st">&quot;DP130&quot;</span>, <span class="st">&quot;DP131&quot;</span>,</span>
<span id="cb2-35"><a href="#cb2-35"></a>    <span class="st">&quot;DP132&quot;</span>, <span class="st">&quot;DP133&quot;</span>, <span class="st">&quot;DP134&quot;</span>, <span class="st">&quot;DP135&quot;</span>, <span class="st">&quot;DP136&quot;</span>, <span class="st">&quot;DP137&quot;</span>,</span>
<span id="cb2-36"><a href="#cb2-36"></a>    <span class="st">&quot;DP138&quot;</span>, <span class="st">&quot;DP139&quot;</span>, <span class="st">&quot;DP140&quot;</span>, <span class="st">&quot;DP141&quot;</span>, <span class="st">&quot;DP142&quot;</span>, <span class="st">&quot;DP143&quot;</span>,</span>
<span id="cb2-37"><a href="#cb2-37"></a>    <span class="st">&quot;DP144&quot;</span>, <span class="st">&quot;DP145&quot;</span>, <span class="st">&quot;DP146&quot;</span>, <span class="st">&quot;DP147&quot;</span>, <span class="st">&quot;DP148&quot;</span>, <span class="st">&quot;DP149&quot;</span>,</span>
<span id="cb2-38"><a href="#cb2-38"></a>    <span class="st">&quot;DP150&quot;</span>, <span class="st">&quot;DP151&quot;</span>, <span class="st">&quot;DP152&quot;</span>, <span class="st">&quot;DP153&quot;</span>, <span class="st">&quot;DP154&quot;</span>, <span class="st">&quot;DP155&quot;</span>,</span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="st">&quot;DP156&quot;</span>, <span class="st">&quot;DP157&quot;</span>, <span class="st">&quot;DP158&quot;</span>, <span class="st">&quot;DP159&quot;</span>, <span class="st">&quot;DP160&quot;</span>, <span class="st">&quot;DP161&quot;</span>,</span>
<span id="cb2-40"><a href="#cb2-40"></a>    <span class="st">&quot;DP162&quot;</span>, <span class="st">&quot;DP163&quot;</span>, <span class="st">&quot;DP164&quot;</span>, <span class="st">&quot;DP165&quot;</span>, <span class="st">&quot;DP166&quot;</span>, <span class="st">&quot;DP167&quot;</span>,</span>
<span id="cb2-41"><a href="#cb2-41"></a>    <span class="st">&quot;DP168&quot;</span>, <span class="st">&quot;DP169&quot;</span>, <span class="st">&quot;DP170&quot;</span>, <span class="st">&quot;DP171&quot;</span>, <span class="st">&quot;DP172&quot;</span>, <span class="st">&quot;DP173&quot;</span>,</span>
<span id="cb2-42"><a href="#cb2-42"></a>    <span class="st">&quot;DP174&quot;</span>, <span class="st">&quot;DP175&quot;</span>, <span class="st">&quot;DP176&quot;</span>, <span class="st">&quot;DP177&quot;</span>, <span class="st">&quot;DP178&quot;</span>, <span class="st">&quot;DP179&quot;</span>};</span>
<span id="cb2-43"><a href="#cb2-43"></a></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="co">// lexicographic order ---------------------------------------------------------</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="dt">bool</span> dominates(<span class="dt">int</span>[] e1, <span class="dt">int</span>[] e2){</span>
<span id="cb2-46"><a href="#cb2-46"></a>    <span class="cf">return</span> e2[<span class="dv">0</span>]&gt;e1[<span class="dv">0</span>] || (e2[<span class="dv">0</span>]==e1[<span class="dv">0</span>] &amp;&amp; e2[<span class="dv">1</span>]&gt;e1[<span class="dv">1</span>]);</span>
<span id="cb2-47"><a href="#cb2-47"></a>}</span>
<span id="cb2-48"><a href="#cb2-48"></a></span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="co">// vertices --------------------------------------------------------------------</span></span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="dt">int</span> A = <span class="dv">8</span>;</span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="dt">int</span> B = <span class="dv">4</span>;</span>
<span id="cb2-52"><a href="#cb2-52"></a></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="kw">struct</span> quadruple {</span>
<span id="cb2-54"><a href="#cb2-54"></a>    real x;</span>
<span id="cb2-55"><a href="#cb2-55"></a>    real y;</span>
<span id="cb2-56"><a href="#cb2-56"></a>    real z;</span>
<span id="cb2-57"><a href="#cb2-57"></a>    real t;</span>
<span id="cb2-58"><a href="#cb2-58"></a>}</span>
<span id="cb2-59"><a href="#cb2-59"></a></span>
<span id="cb2-60"><a href="#cb2-60"></a>real[][] poly1 = <span class="kw">new</span> real[A][<span class="dv">2</span>];</span>
<span id="cb2-61"><a href="#cb2-61"></a><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</span>
<span id="cb2-62"><a href="#cb2-62"></a>    poly1[i][<span class="dv">0</span>] = cos(i/A*<span class="dv">2</span><span class="er">pi</span>);</span>
<span id="cb2-63"><a href="#cb2-63"></a>    poly1[i][<span class="dv">1</span>] = sin(i/A*<span class="dv">2</span><span class="er">pi</span>);</span>
<span id="cb2-64"><a href="#cb2-64"></a>}</span>
<span id="cb2-65"><a href="#cb2-65"></a>real[][] poly2 = <span class="kw">new</span> real[B][<span class="dv">2</span>];</span>
<span id="cb2-66"><a href="#cb2-66"></a><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; B; ++i){</span>
<span id="cb2-67"><a href="#cb2-67"></a>    poly2[i][<span class="dv">0</span>] = cos(pi/B+i/B*<span class="dv">2</span><span class="er">pi</span>);</span>
<span id="cb2-68"><a href="#cb2-68"></a>    poly2[i][<span class="dv">1</span>] = sin(pi/B+i/B*<span class="dv">2</span><span class="er">pi</span>);</span>
<span id="cb2-69"><a href="#cb2-69"></a>}</span>
<span id="cb2-70"><a href="#cb2-70"></a>quadruple[][] vertices = <span class="kw">new</span> quadruple[A][B];</span>
<span id="cb2-71"><a href="#cb2-71"></a><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</span>
<span id="cb2-72"><a href="#cb2-72"></a>    <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; B; ++j){</span>
<span id="cb2-73"><a href="#cb2-73"></a>        quadruple v;</span>
<span id="cb2-74"><a href="#cb2-74"></a>        v.x = poly1[i][<span class="dv">0</span>]; v.y = poly1[i][<span class="dv">1</span>]; </span>
<span id="cb2-75"><a href="#cb2-75"></a>        v.z = poly2[j][<span class="dv">0</span>]; v.t = poly2[j][<span class="dv">1</span>];</span>
<span id="cb2-76"><a href="#cb2-76"></a>        vertices[i][j] = v;</span>
<span id="cb2-77"><a href="#cb2-77"></a>    }</span>
<span id="cb2-78"><a href="#cb2-78"></a>}</span>
<span id="cb2-79"><a href="#cb2-79"></a></span>
<span id="cb2-80"><a href="#cb2-80"></a><span class="co">// edges -----------------------------------------------------------------------</span></span>
<span id="cb2-81"><a href="#cb2-81"></a><span class="dt">int</span>[][][] edges;</span>
<span id="cb2-82"><a href="#cb2-82"></a><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</span>
<span id="cb2-83"><a href="#cb2-83"></a>    <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; B; ++j){</span>
<span id="cb2-84"><a href="#cb2-84"></a>        <span class="dt">int</span>[] e = {i,j};</span>
<span id="cb2-85"><a href="#cb2-85"></a>        <span class="dt">int</span>[] candidate = {i,(j-<span class="dv">1</span>)%B};</span>
<span id="cb2-86"><a href="#cb2-86"></a>        <span class="cf">if</span>(dominates(e,candidate)){</span>
<span id="cb2-87"><a href="#cb2-87"></a>            <span class="dt">int</span>[][] edge = {e,candidate}; </span>
<span id="cb2-88"><a href="#cb2-88"></a>            edges.push(edge);</span>
<span id="cb2-89"><a href="#cb2-89"></a>        }</span>
<span id="cb2-90"><a href="#cb2-90"></a>        <span class="dt">int</span>[] candidate = {i,(j+<span class="dv">1</span>)%B};</span>
<span id="cb2-91"><a href="#cb2-91"></a>        <span class="cf">if</span>(dominates(e,candidate)){</span>
<span id="cb2-92"><a href="#cb2-92"></a>            <span class="dt">int</span>[][] edge = {e,candidate}; </span>
<span id="cb2-93"><a href="#cb2-93"></a>            edges.push(edge);</span>
<span id="cb2-94"><a href="#cb2-94"></a>        }</span>
<span id="cb2-95"><a href="#cb2-95"></a>        <span class="dt">int</span>[] candidate = {(i-<span class="dv">1</span>)%A,j};</span>
<span id="cb2-96"><a href="#cb2-96"></a>        <span class="cf">if</span>(dominates(e,candidate)){</span>
<span id="cb2-97"><a href="#cb2-97"></a>            <span class="dt">int</span>[][] edge = {e,candidate}; </span>
<span id="cb2-98"><a href="#cb2-98"></a>            edges.push(edge);</span>
<span id="cb2-99"><a href="#cb2-99"></a>        }</span>
<span id="cb2-100"><a href="#cb2-100"></a>        <span class="dt">int</span>[] candidate = {(i+<span class="dv">1</span>)%A,j};</span>
<span id="cb2-101"><a href="#cb2-101"></a>        <span class="cf">if</span>(dominates(e,candidate)){</span>
<span id="cb2-102"><a href="#cb2-102"></a>            <span class="dt">int</span>[][] edge = {e,candidate}; </span>
<span id="cb2-103"><a href="#cb2-103"></a>            edges.push(edge);</span>
<span id="cb2-104"><a href="#cb2-104"></a>        }</span>
<span id="cb2-105"><a href="#cb2-105"></a>    }</span>
<span id="cb2-106"><a href="#cb2-106"></a>}</span>
<span id="cb2-107"><a href="#cb2-107"></a></span>
<span id="cb2-108"><a href="#cb2-108"></a><span class="co">// rotation in 4D space (right-isoclinic) --------------------------------------</span></span>
<span id="cb2-109"><a href="#cb2-109"></a>quadruple rotate4d(real alpha, real beta, real xi, quadruple vec){</span>
<span id="cb2-110"><a href="#cb2-110"></a>    real a = cos(xi);</span>
<span id="cb2-111"><a href="#cb2-111"></a>    real b = sin(alpha)*cos(beta)*sin(xi);</span>
<span id="cb2-112"><a href="#cb2-112"></a>    real c = sin(alpha)*sin(beta)*sin(xi);</span>
<span id="cb2-113"><a href="#cb2-113"></a>    real d = cos(alpha)*sin(xi);</span>
<span id="cb2-114"><a href="#cb2-114"></a>    real p = vec.x;</span>
<span id="cb2-115"><a href="#cb2-115"></a>    real q = vec.y;</span>
<span id="cb2-116"><a href="#cb2-116"></a>    real r = vec.z;</span>
<span id="cb2-117"><a href="#cb2-117"></a>    real s = vec.t;</span>
<span id="cb2-118"><a href="#cb2-118"></a>    quadruple out;</span>
<span id="cb2-119"><a href="#cb2-119"></a>    out.x = a*p - b*q - c*r - d*s;</span>
<span id="cb2-120"><a href="#cb2-120"></a>    out.y = a*q + b*p + c*s - d*r;</span>
<span id="cb2-121"><a href="#cb2-121"></a>    out.z = a*r - b*s + c*p + d*q;</span>
<span id="cb2-122"><a href="#cb2-122"></a>    out.t = a*s + b*r - c*q + d*p;</span>
<span id="cb2-123"><a href="#cb2-123"></a>    <span class="cf">return</span> out;</span>
<span id="cb2-124"><a href="#cb2-124"></a>}</span>
<span id="cb2-125"><a href="#cb2-125"></a></span>
<span id="cb2-126"><a href="#cb2-126"></a><span class="co">// stereographic projection ----------------------------------------------------</span></span>
<span id="cb2-127"><a href="#cb2-127"></a>triple stereog(quadruple A, real r){</span>
<span id="cb2-128"><a href="#cb2-128"></a>    <span class="cf">return</span> (A.x, A.y, A.z) / (r - A.t);</span>
<span id="cb2-129"><a href="#cb2-129"></a>}</span>
<span id="cb2-130"><a href="#cb2-130"></a></span>
<span id="cb2-131"><a href="#cb2-131"></a><span class="co">// stereographic path ----------------------------------------------------------</span></span>
<span id="cb2-132"><a href="#cb2-132"></a>path3 stereoPath(quadruple A, quadruple B, real r, <span class="dt">int</span> n){</span>
<span id="cb2-133"><a href="#cb2-133"></a>    path3 out;</span>
<span id="cb2-134"><a href="#cb2-134"></a>    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt;= n; ++i){</span>
<span id="cb2-135"><a href="#cb2-135"></a>        real t = i/n;</span>
<span id="cb2-136"><a href="#cb2-136"></a>        quadruple M;</span>
<span id="cb2-137"><a href="#cb2-137"></a>        real x = (<span class="dv">1</span>-t)*A.x + t*B.x;</span>
<span id="cb2-138"><a href="#cb2-138"></a>        real y = (<span class="dv">1</span>-t)*A.y + t*B.y;</span>
<span id="cb2-139"><a href="#cb2-139"></a>        real z = (<span class="dv">1</span>-t)*A.z + t*B.z;</span>
<span id="cb2-140"><a href="#cb2-140"></a>        real t = (<span class="dv">1</span>-t)*A.t + t*B.t;</span>
<span id="cb2-141"><a href="#cb2-141"></a>        real lg = sqrt(x*x + y*y + z*z + t*t) / r;</span>
<span id="cb2-142"><a href="#cb2-142"></a>        M.x = x / lg; M.y = y / lg; M.z = z / lg; M.t = t / lg;</span>
<span id="cb2-143"><a href="#cb2-143"></a>        out = out .. stereog(M, r);</span>
<span id="cb2-144"><a href="#cb2-144"></a>    }</span>
<span id="cb2-145"><a href="#cb2-145"></a>    <span class="cf">return</span> out;</span>
<span id="cb2-146"><a href="#cb2-146"></a>}</span>
<span id="cb2-147"><a href="#cb2-147"></a></span>
<span id="cb2-148"><a href="#cb2-148"></a><span class="co">// section transformation ------------------------------------------------------</span></span>
<span id="cb2-149"><a href="#cb2-149"></a>transform T(path3 p3, real t, <span class="dt">int</span> n){</span>
<span id="cb2-150"><a href="#cb2-150"></a>    triple M = relpoint(p3, t/(n/<span class="dv">4</span>));</span>
<span id="cb2-151"><a href="#cb2-151"></a>    <span class="cf">return</span> scale(length(M)/<span class="dv">15</span>); </span>
<span id="cb2-152"><a href="#cb2-152"></a>}</span>
<span id="cb2-153"><a href="#cb2-153"></a></span>
<span id="cb2-154"><a href="#cb2-154"></a><span class="co">// bounding box ----------------------------------------------------------------</span></span>
<span id="cb2-155"><a href="#cb2-155"></a>real f=<span class="dv">3</span>, h = <span class="fl">4.5</span>, g = <span class="fl">1.5</span>;</span>
<span id="cb2-156"><a href="#cb2-156"></a>path3 boundingbox = (-h,<span class="dv">0</span>,-f)--(-h,<span class="dv">0</span>,g)--(h,<span class="dv">0</span>,f)--(h,<span class="dv">0</span>,-g)--cycle;</span>
<span id="cb2-157"><a href="#cb2-157"></a></span>
<span id="cb2-158"><a href="#cb2-158"></a><span class="co">// draw the duoprism -----------------------------------------------------------</span></span>
<span id="cb2-159"><a href="#cb2-159"></a><span class="dt">int</span> n = <span class="dv">100</span>;</span>
<span id="cb2-160"><a href="#cb2-160"></a>real r = sqrt(<span class="dv">2</span>);</span>
<span id="cb2-161"><a href="#cb2-161"></a>real alpha = pi/<span class="dv">2</span>, beta = <span class="dv">0</span>;</span>
<span id="cb2-162"><a href="#cb2-162"></a></span>
<span id="cb2-163"><a href="#cb2-163"></a><span class="cf">for</span>(<span class="dt">int</span> file = <span class="dv">0</span>; file &lt; <span class="dv">180</span>; ++file){</span>
<span id="cb2-164"><a href="#cb2-164"></a>    real xi = <span class="dv">2</span>*file*pi/<span class="dv">180</span>;</span>
<span id="cb2-165"><a href="#cb2-165"></a>    picture pic;</span>
<span id="cb2-166"><a href="#cb2-166"></a>    <span class="co">// draw bounding box</span></span>
<span id="cb2-167"><a href="#cb2-167"></a>    draw(pic, boundingbox, rgb(<span class="st">&quot;363940ff&quot;</span>)+opacity(<span class="dv">0</span>));</span>
<span id="cb2-168"><a href="#cb2-168"></a>    <span class="co">// draw edges</span></span>
<span id="cb2-169"><a href="#cb2-169"></a>    <span class="cf">for</span>(<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; <span class="dv">2</span>*A*B; ++k){</span>
<span id="cb2-170"><a href="#cb2-170"></a>        quadruple A = vertices[edges[k][<span class="dv">0</span>][<span class="dv">0</span>]][edges[k][<span class="dv">0</span>][<span class="dv">1</span>]];</span>
<span id="cb2-171"><a href="#cb2-171"></a>        quadruple B = vertices[edges[k][<span class="dv">1</span>][<span class="dv">0</span>]][edges[k][<span class="dv">1</span>][<span class="dv">1</span>]];</span>
<span id="cb2-172"><a href="#cb2-172"></a>        path3 p3 = </span>
<span id="cb2-173"><a href="#cb2-173"></a>            stereoPath(rotate4d(alpha, beta, xi, A), </span>
<span id="cb2-174"><a href="#cb2-174"></a>                       rotate4d(alpha, beta, xi, B), r, n);</span>
<span id="cb2-175"><a href="#cb2-175"></a>        transform S(real t){</span>
<span id="cb2-176"><a href="#cb2-176"></a>            <span class="cf">return</span> T(p3, t, n);</span>
<span id="cb2-177"><a href="#cb2-177"></a>        }</span>
<span id="cb2-178"><a href="#cb2-178"></a>        draw(pic, tube(p3, unitcircle, S), rgb(<span class="dv">139</span>,<span class="dv">0</span>,<span class="dv">139</span>), </span>
<span id="cb2-179"><a href="#cb2-179"></a>                                render(compression=Low, merge=<span class="kw">true</span>));</span>
<span id="cb2-180"><a href="#cb2-180"></a>    }</span>
<span id="cb2-181"><a href="#cb2-181"></a>    <span class="co">// draw vertices</span></span>
<span id="cb2-182"><a href="#cb2-182"></a>    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</span>
<span id="cb2-183"><a href="#cb2-183"></a>        <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; B; ++j){</span>
<span id="cb2-184"><a href="#cb2-184"></a>            triple Asg = </span>
<span id="cb2-185"><a href="#cb2-185"></a>                stereog(rotate4d(alpha, beta, xi, vertices[i][j]), r);</span>
<span id="cb2-186"><a href="#cb2-186"></a>            draw(pic, shift(Asg)*scale3(length(Asg)/<span class="dv">10</span>)*unitsphere, purple);</span>
<span id="cb2-187"><a href="#cb2-187"></a>        }</span>
<span id="cb2-188"><a href="#cb2-188"></a>    }</span>
<span id="cb2-189"><a href="#cb2-189"></a>    <span class="co">// add and save picture</span></span>
<span id="cb2-190"><a href="#cb2-190"></a>    add(pic);</span>
<span id="cb2-191"><a href="#cb2-191"></a>    shipout(files[file], bbox(rgb(<span class="st">&quot;363940ff&quot;</span>), FillDraw(rgb(<span class="st">&quot;363940ff&quot;</span>))));</span>
<span id="cb2-192"><a href="#cb2-192"></a>    erase();</span>
<span id="cb2-193"><a href="#cb2-193"></a>}</span>
<span id="cb2-194"><a href="#cb2-194"></a></span>
<span id="cb2-195"><a href="#cb2-195"></a><span class="co">/* to do the animation</span></span>
<span id="cb2-196"><a href="#cb2-196"></a><span class="co">gs -dSAFER -dBATCH -dNOPAUSE -dEPSCrop -sDEVICE=png16m -r600 -sOutputFile=zpic%03d.png DP*.eps</span></span>
<span id="cb2-197"><a href="#cb2-197"></a><span class="co">mogrify -resize 512x zpic*.png</span></span>
<span id="cb2-198"><a href="#cb2-198"></a><span class="co">gifski --fps 12 zpic*.png -o DuoprismStereo.gif</span></span>
<span id="cb2-199"><a href="#cb2-199"></a><span class="co">*/</span></span></code></pre></div>
<p><img src="./figures/DuoprismStereo_Asy.gif" /></p>
<h1 id="with-pov-ray">With POV-Ray</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource povray numberLines"><code class="sourceCode povray"><span id="cb3-1"><a href="#cb3-1"></a><span class="ot">#version</span> <span class="fl">3.7</span>;</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">global_settings</span> { <span class="kw">assumed_gamma</span> <span class="fl">1</span> }</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="ot">#include</span> <span class="st">&quot;colors.inc&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="ot">#include</span> <span class="st">&quot;textures.inc&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">/* camera */</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">camera</span> {</span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="kw">location</span> &lt;-<span class="fl">11</span>, <span class="fl">7</span>, <span class="fl">-32</span>&gt;</span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="kw">look_at</span> <span class="fl">0</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="kw">angle</span> <span class="fl">45</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="kw">right</span> <span class="kw">x</span>*<span class="kw">image_width</span>/<span class="kw">image_height</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>}</span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">// sun -------------------------------------------------------------------------</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="kw">light_source</span> {&lt; <span class="fl">4000</span>,<span class="fl">6000</span>,-<span class="fl">6000</span>&gt; <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">0.9</span>}           <span class="co">// sun </span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="kw">light_source</span> {&lt;-<span class="fl">11</span>, <span class="fl">7</span>,-<span class="fl">32</span>&gt;  <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">1</span>&gt;*<span class="fl">0.1</span> <span class="kw">shadowless</span>} <span class="co">// flash</span></span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">// sky -------------------------------------------------------------------------</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="kw">plane</span> {</span>
<span id="cb3-20"><a href="#cb3-20"></a>  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">1</span> <span class="kw">hollow</span>  </span>
<span id="cb3-21"><a href="#cb3-21"></a>  <span class="kw">texture</span> {</span>
<span id="cb3-22"><a href="#cb3-22"></a>    <span class="kw">pigment</span> { </span>
<span id="cb3-23"><a href="#cb3-23"></a>      <span class="kw">bozo</span> <span class="kw">turbulence</span> <span class="fl">1.3</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>      <span class="kw">color_map</span> {</span>
<span id="cb3-25"><a href="#cb3-25"></a>        [<span class="fl">0.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</span>
<span id="cb3-26"><a href="#cb3-26"></a>        [<span class="fl">0.75</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</span>
<span id="cb3-27"><a href="#cb3-27"></a>        [<span class="fl">0.83</span> <span class="kw">rgb</span> &lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;]</span>
<span id="cb3-28"><a href="#cb3-28"></a>        [<span class="fl">0.95</span> <span class="kw">rgb</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;]</span>
<span id="cb3-29"><a href="#cb3-29"></a>        [<span class="fl">1.0</span> <span class="kw">rgb</span> &lt;<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>&gt;]</span>
<span id="cb3-30"><a href="#cb3-30"></a>      }</span>
<span id="cb3-31"><a href="#cb3-31"></a>      <span class="kw">scale</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">2.5</span>  <span class="kw">translate</span>&lt; <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span>&gt;</span>
<span id="cb3-32"><a href="#cb3-32"></a>    }</span>
<span id="cb3-33"><a href="#cb3-33"></a>    <span class="kw">finish</span> {</span>
<span id="cb3-34"><a href="#cb3-34"></a>      <span class="kw">ambient</span> <span class="fl">1</span> </span>
<span id="cb3-35"><a href="#cb3-35"></a>      <span class="kw">diffuse</span> <span class="fl">0</span></span>
<span id="cb3-36"><a href="#cb3-36"></a>    } </span>
<span id="cb3-37"><a href="#cb3-37"></a>  }      </span>
<span id="cb3-38"><a href="#cb3-38"></a>  <span class="kw">scale</span> <span class="fl">10000</span></span>
<span id="cb3-39"><a href="#cb3-39"></a>}</span>
<span id="cb3-40"><a href="#cb3-40"></a></span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="co">// fog on the ground -----------------------------------------------------------</span></span>
<span id="cb3-42"><a href="#cb3-42"></a><span class="kw">fog</span> {</span>
<span id="cb3-43"><a href="#cb3-43"></a>  <span class="kw">fog_type</span>   <span class="fl">2</span></span>
<span id="cb3-44"><a href="#cb3-44"></a>  <span class="kw">distance</span>   <span class="fl">50</span></span>
<span id="cb3-45"><a href="#cb3-45"></a>  <span class="kw">color</span>      Gray10  </span>
<span id="cb3-46"><a href="#cb3-46"></a>  <span class="kw">fog_offset</span> <span class="fl">0.1</span></span>
<span id="cb3-47"><a href="#cb3-47"></a>  <span class="kw">fog_alt</span>    <span class="fl">1.5</span></span>
<span id="cb3-48"><a href="#cb3-48"></a>  <span class="kw">turbulence</span> <span class="fl">1.8</span></span>
<span id="cb3-49"><a href="#cb3-49"></a>}</span>
<span id="cb3-50"><a href="#cb3-50"></a></span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="co">// ground ----------------------------------------------------------------------</span></span>
<span id="cb3-52"><a href="#cb3-52"></a><span class="kw">plane</span> {</span>
<span id="cb3-53"><a href="#cb3-53"></a>  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">0</span> </span>
<span id="cb3-54"><a href="#cb3-54"></a>  <span class="kw">texture</span> {</span>
<span id="cb3-55"><a href="#cb3-55"></a>    <span class="kw">pigment</span> { <span class="kw">color</span> <span class="kw">rgb</span> &lt;<span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.73</span>&gt;*<span class="fl">0.35</span> }</span>
<span id="cb3-56"><a href="#cb3-56"></a>    <span class="kw">normal</span> { <span class="kw">bumps</span> <span class="fl">2</span> <span class="kw">scale</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;*<span class="fl">0.5</span> <span class="kw">turbulence</span> <span class="fl">0.5</span> } </span>
<span id="cb3-57"><a href="#cb3-57"></a>    <span class="kw">finish</span> { <span class="kw">phong</span> <span class="fl">0.1</span> }</span>
<span id="cb3-58"><a href="#cb3-58"></a>  } </span>
<span id="cb3-59"><a href="#cb3-59"></a>} </span>
<span id="cb3-60"><a href="#cb3-60"></a></span>
<span id="cb3-61"><a href="#cb3-61"></a></span>
<span id="cb3-62"><a href="#cb3-62"></a><span class="co">/* ----- vertices ----- */</span></span>
<span id="cb3-63"><a href="#cb3-63"></a><span class="kw">#declare A </span>= <span class="fl">4</span>;</span>
<span id="cb3-64"><a href="#cb3-64"></a><span class="kw">#declare B </span>= <span class="fl">30</span>;</span>
<span id="cb3-65"><a href="#cb3-65"></a></span>
<span id="cb3-66"><a href="#cb3-66"></a><span class="kw">#declare poly1 </span>= <span class="kw">array</span>[A];</span>
<span id="cb3-67"><a href="#cb3-67"></a>#for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</span>
<span id="cb3-68"><a href="#cb3-68"></a>  <span class="kw">#declare poly1</span>[i] = <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">cos</span>(i/A*<span class="fl">2</span>*<span class="fl">pi</span>), <span class="kw">sin</span>(i/A*<span class="fl">2</span>*<span class="fl">pi</span>)};</span>
<span id="cb3-69"><a href="#cb3-69"></a><span class="ot">#end</span></span>
<span id="cb3-70"><a href="#cb3-70"></a><span class="kw">#declare poly2 </span>= <span class="kw">array</span>[B];</span>
<span id="cb3-71"><a href="#cb3-71"></a>#for(i,<span class="fl">0</span>,B<span class="fl">-1</span>)</span>
<span id="cb3-72"><a href="#cb3-72"></a>  <span class="kw">#declare poly2</span>[i] = <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">cos</span>(i/B*<span class="fl">2</span>*<span class="fl">pi</span>), <span class="kw">sin</span>(i/B*<span class="fl">2</span>*<span class="fl">pi</span>)};</span>
<span id="cb3-73"><a href="#cb3-73"></a><span class="ot">#end</span></span>
<span id="cb3-74"><a href="#cb3-74"></a><span class="kw">#declare vertices </span>= <span class="kw">array</span>[A][B];</span>
<span id="cb3-75"><a href="#cb3-75"></a>#for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</span>
<span id="cb3-76"><a href="#cb3-76"></a>  #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</span>
<span id="cb3-77"><a href="#cb3-77"></a>    <span class="kw">#declare vertices</span>[i][j] = </span>
<span id="cb3-78"><a href="#cb3-78"></a>      &lt; poly1[i][<span class="fl">0</span>], poly1[i][<span class="fl">1</span>], poly2[j][<span class="fl">0</span>], poly2[j][<span class="fl">1</span>] &gt;;</span>
<span id="cb3-79"><a href="#cb3-79"></a>  <span class="ot">#end</span></span>
<span id="cb3-80"><a href="#cb3-80"></a><span class="ot">#end</span></span>
<span id="cb3-81"><a href="#cb3-81"></a></span>
<span id="cb3-82"><a href="#cb3-82"></a><span class="co">/* ----- edges ----- */</span></span>
<span id="cb3-83"><a href="#cb3-83"></a><span class="kw">#macro dominates</span>(e1,e2)</span>
<span id="cb3-84"><a href="#cb3-84"></a>  (e2[<span class="fl">0</span>]&gt;e1[<span class="fl">0</span>]) | ((e2[<span class="fl">0</span>]=e1[<span class="fl">0</span>]) &amp; (e2[<span class="fl">1</span>]&gt;e1[<span class="fl">1</span>]))</span>
<span id="cb3-85"><a href="#cb3-85"></a><span class="ot">#end</span></span>
<span id="cb3-86"><a href="#cb3-86"></a><span class="kw">#declare nedges </span>= <span class="fl">2</span>*A*B;</span>
<span id="cb3-87"><a href="#cb3-87"></a><span class="kw">#declare edges </span>= <span class="kw">array</span>[nedges];</span>
<span id="cb3-88"><a href="#cb3-88"></a><span class="kw">#declare k</span>=<span class="fl">0</span>;</span>
<span id="cb3-89"><a href="#cb3-89"></a>#for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</span>
<span id="cb3-90"><a href="#cb3-90"></a>  #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</span>
<span id="cb3-91"><a href="#cb3-91"></a>    <span class="kw">#local e </span>= <span class="kw">array</span>[<span class="fl">2</span>] {i,j};</span>
<span id="cb3-92"><a href="#cb3-92"></a>    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {i,<span class="kw">mod</span>(<span class="kw">mod</span>(j<span class="fl">-1</span>,B)+B,B)};</span>
<span id="cb3-93"><a href="#cb3-93"></a>    <span class="ot">#if</span>(dominates(e,candidate))</span>
<span id="cb3-94"><a href="#cb3-94"></a>      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</span>
<span id="cb3-95"><a href="#cb3-95"></a>      <span class="kw">#declare edges</span>[k] = edge;</span>
<span id="cb3-96"><a href="#cb3-96"></a>      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</span>
<span id="cb3-97"><a href="#cb3-97"></a>    <span class="ot">#end</span></span>
<span id="cb3-98"><a href="#cb3-98"></a>    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {i,<span class="kw">mod</span>(<span class="kw">mod</span>(j+<span class="fl">1</span>,B)+B,B)};</span>
<span id="cb3-99"><a href="#cb3-99"></a>    <span class="ot">#if</span>(dominates(e,candidate))</span>
<span id="cb3-100"><a href="#cb3-100"></a>      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</span>
<span id="cb3-101"><a href="#cb3-101"></a>      <span class="kw">#declare edges</span>[k] = edge;</span>
<span id="cb3-102"><a href="#cb3-102"></a>      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</span>
<span id="cb3-103"><a href="#cb3-103"></a>    <span class="ot">#end</span></span>
<span id="cb3-104"><a href="#cb3-104"></a>    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">mod</span>(<span class="kw">mod</span>(i<span class="fl">-1</span>,A)+A,A),j};</span>
<span id="cb3-105"><a href="#cb3-105"></a>    <span class="ot">#if</span>(dominates(e,candidate))</span>
<span id="cb3-106"><a href="#cb3-106"></a>      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</span>
<span id="cb3-107"><a href="#cb3-107"></a>      <span class="kw">#declare edges</span>[k] = edge;</span>
<span id="cb3-108"><a href="#cb3-108"></a>      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</span>
<span id="cb3-109"><a href="#cb3-109"></a>    <span class="ot">#end</span></span>
<span id="cb3-110"><a href="#cb3-110"></a>    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">mod</span>(<span class="kw">mod</span>(i+<span class="fl">1</span>,A)+A,A),j};</span>
<span id="cb3-111"><a href="#cb3-111"></a>    <span class="ot">#if</span>(dominates(e,candidate))</span>
<span id="cb3-112"><a href="#cb3-112"></a>      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</span>
<span id="cb3-113"><a href="#cb3-113"></a>      <span class="kw">#declare edges</span>[k] = edge;</span>
<span id="cb3-114"><a href="#cb3-114"></a>      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</span>
<span id="cb3-115"><a href="#cb3-115"></a>    <span class="ot">#end</span></span>
<span id="cb3-116"><a href="#cb3-116"></a>  <span class="ot">#end</span></span>
<span id="cb3-117"><a href="#cb3-117"></a><span class="ot">#end</span></span>
<span id="cb3-118"><a href="#cb3-118"></a></span>
<span id="cb3-119"><a href="#cb3-119"></a><span class="co">/* rotation in 4D space */</span></span>
<span id="cb3-120"><a href="#cb3-120"></a><span class="kw">#macro rotate4d</span>(theta,phi,xi,vec)</span>
<span id="cb3-121"><a href="#cb3-121"></a>  <span class="kw">#local a </span>= <span class="kw">cos</span>(xi);</span>
<span id="cb3-122"><a href="#cb3-122"></a>  <span class="kw">#local b </span>= <span class="kw">sin</span>(theta)*<span class="kw">cos</span>(phi)*<span class="kw">sin</span>(xi);</span>
<span id="cb3-123"><a href="#cb3-123"></a>  <span class="kw">#local c </span>= <span class="kw">sin</span>(theta)*<span class="kw">sin</span>(phi)*<span class="kw">sin</span>(xi);</span>
<span id="cb3-124"><a href="#cb3-124"></a>  <span class="kw">#local d </span>= <span class="kw">cos</span>(theta)*<span class="kw">sin</span>(xi);</span>
<span id="cb3-125"><a href="#cb3-125"></a>  <span class="kw">#local p </span>= vec.<span class="kw">x</span>;</span>
<span id="cb3-126"><a href="#cb3-126"></a>  <span class="kw">#local q </span>= vec.<span class="kw">y</span>;</span>
<span id="cb3-127"><a href="#cb3-127"></a>  <span class="kw">#local r </span>= vec.<span class="kw">z</span>;</span>
<span id="cb3-128"><a href="#cb3-128"></a>  <span class="kw">#local s </span>= vec.<span class="kw">t</span>;</span>
<span id="cb3-129"><a href="#cb3-129"></a>  &lt; a*p - b*q - c*r - d*s</span>
<span id="cb3-130"><a href="#cb3-130"></a>  , a*q + b*p + c*s - d*r</span>
<span id="cb3-131"><a href="#cb3-131"></a>  , a*r - b*s + c*p + d*q</span>
<span id="cb3-132"><a href="#cb3-132"></a>  , a*s + b*r - c*q + d*p &gt;</span>
<span id="cb3-133"><a href="#cb3-133"></a><span class="ot">#end</span></span>
<span id="cb3-134"><a href="#cb3-134"></a></span>
<span id="cb3-135"><a href="#cb3-135"></a><span class="co">/* stereographic projection */</span></span>
<span id="cb3-136"><a href="#cb3-136"></a><span class="kw">#macro StereographicProjection</span>(q)</span>
<span id="cb3-137"><a href="#cb3-137"></a>  &lt;q.<span class="kw">x</span>,q.<span class="kw">y</span>,q.<span class="kw">z</span>&gt; / (<span class="kw">sqrt</span>(<span class="fl">2</span>)-q.<span class="kw">t</span>)</span>
<span id="cb3-138"><a href="#cb3-138"></a><span class="ot">#end</span></span>
<span id="cb3-139"><a href="#cb3-139"></a></span>
<span id="cb3-140"><a href="#cb3-140"></a><span class="co">/* rotated and projected vertices */</span></span>
<span id="cb3-141"><a href="#cb3-141"></a><span class="kw">#macro ProjectedVertices</span>(theta,phi,xi)</span>
<span id="cb3-142"><a href="#cb3-142"></a>  <span class="kw">#local out </span>= <span class="kw">array</span>[A][B];</span>
<span id="cb3-143"><a href="#cb3-143"></a>  #for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</span>
<span id="cb3-144"><a href="#cb3-144"></a>    #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</span>
<span id="cb3-145"><a href="#cb3-145"></a>      <span class="kw">#local out</span>[i][j] = StereographicProjection(</span>
<span id="cb3-146"><a href="#cb3-146"></a>                            rotate4d(theta,phi,xi,vertices[i][j])</span>
<span id="cb3-147"><a href="#cb3-147"></a>                          );</span>
<span id="cb3-148"><a href="#cb3-148"></a>    <span class="ot">#end</span></span>
<span id="cb3-149"><a href="#cb3-149"></a>  <span class="ot">#end</span></span>
<span id="cb3-150"><a href="#cb3-150"></a>  out</span>
<span id="cb3-151"><a href="#cb3-151"></a><span class="ot">#end</span></span>
<span id="cb3-152"><a href="#cb3-152"></a></span>
<span id="cb3-153"><a href="#cb3-153"></a><span class="co">/* macro spherical segment */</span></span>
<span id="cb3-154"><a href="#cb3-154"></a><span class="kw">#macro vlength4</span>(P)</span>
<span id="cb3-155"><a href="#cb3-155"></a>  <span class="kw">sqrt</span>(P.<span class="kw">x</span>*P.<span class="kw">x</span> + P.<span class="kw">y</span>*P.<span class="kw">y</span> + P.<span class="kw">z</span>*P.<span class="kw">z</span> + P.<span class="kw">t</span>*P.<span class="kw">t</span>)</span>
<span id="cb3-156"><a href="#cb3-156"></a><span class="ot">#end</span></span>
<span id="cb3-157"><a href="#cb3-157"></a></span>
<span id="cb3-158"><a href="#cb3-158"></a><span class="kw">#macro sphericalSegment</span>(P, Q, n)</span>
<span id="cb3-159"><a href="#cb3-159"></a>  <span class="kw">#local out </span>= <span class="kw">array</span>[n+<span class="fl">1</span>];</span>
<span id="cb3-160"><a href="#cb3-160"></a>  #for(i, <span class="fl">0</span>, n)</span>
<span id="cb3-161"><a href="#cb3-161"></a>    <span class="kw">#local pt </span>= P + (i/n)*(Q-P);</span>
<span id="cb3-162"><a href="#cb3-162"></a>    <span class="kw">#local out</span>[i] = <span class="kw">sqrt</span>(<span class="fl">2</span>)/vlength4(pt) * pt;</span>
<span id="cb3-163"><a href="#cb3-163"></a>  <span class="ot">#end</span></span>
<span id="cb3-164"><a href="#cb3-164"></a>  out</span>
<span id="cb3-165"><a href="#cb3-165"></a><span class="ot">#end</span></span>
<span id="cb3-166"><a href="#cb3-166"></a></span>
<span id="cb3-167"><a href="#cb3-167"></a><span class="co">/* macro to draw an edge */</span></span>
<span id="cb3-168"><a href="#cb3-168"></a><span class="kw">#macro Edge</span>(verts, v1, v2, theta, phi, xi, Tex)</span>
<span id="cb3-169"><a href="#cb3-169"></a>  <span class="kw">#local P </span>= verts[v1[<span class="fl">0</span>]][v1[<span class="fl">1</span>]];</span>
<span id="cb3-170"><a href="#cb3-170"></a>  <span class="kw">#local Q </span>= verts[v2[<span class="fl">0</span>]][v2[<span class="fl">1</span>]];</span>
<span id="cb3-171"><a href="#cb3-171"></a>  <span class="kw">#local PQ </span>= sphericalSegment(P, Q, <span class="fl">100</span>);</span>
<span id="cb3-172"><a href="#cb3-172"></a>  <span class="kw">sphere_sweep</span> {</span>
<span id="cb3-173"><a href="#cb3-173"></a>    <span class="kw">b_spline</span> <span class="fl">101</span></span>
<span id="cb3-174"><a href="#cb3-174"></a>    #for(k,<span class="fl">0</span>,<span class="fl">100</span>)</span>
<span id="cb3-175"><a href="#cb3-175"></a>      <span class="kw">#local O </span>= </span>
<span id="cb3-176"><a href="#cb3-176"></a>        StereographicProjection(rotate4d(theta,phi,xi,PQ[k]));</span>
<span id="cb3-177"><a href="#cb3-177"></a>      O <span class="kw">vlength</span>(O)/<span class="fl">15</span></span>
<span id="cb3-178"><a href="#cb3-178"></a>    <span class="ot">#end</span></span>
<span id="cb3-179"><a href="#cb3-179"></a>    <span class="kw">texture</span> { Tex }</span>
<span id="cb3-180"><a href="#cb3-180"></a>  }</span>
<span id="cb3-181"><a href="#cb3-181"></a><span class="ot">#end</span></span>
<span id="cb3-182"><a href="#cb3-182"></a></span>
<span id="cb3-183"><a href="#cb3-183"></a><span class="co">/*-----------------------------------------*/</span></span>
<span id="cb3-184"><a href="#cb3-184"></a><span class="co">/*-----      draw the duoprism       ------*/</span></span>
<span id="cb3-185"><a href="#cb3-185"></a><span class="co">/*-----------------------------------------*/</span></span>
<span id="cb3-186"><a href="#cb3-186"></a><span class="kw">#declare theta </span>= <span class="fl">pi</span>/<span class="fl">2</span>;</span>
<span id="cb3-187"><a href="#cb3-187"></a><span class="kw">#declare phi </span>= <span class="fl">0</span>;</span>
<span id="cb3-188"><a href="#cb3-188"></a><span class="kw">#declare xi </span>= <span class="fl">2</span>*<span class="kw">frame_number</span>*<span class="fl">pi</span>/<span class="fl">180</span>; </span>
<span id="cb3-189"><a href="#cb3-189"></a></span>
<span id="cb3-190"><a href="#cb3-190"></a><span class="kw">#declare vs </span>= ProjectedVertices(theta, phi, xi);</span>
<span id="cb3-191"><a href="#cb3-191"></a></span>
<span id="cb3-192"><a href="#cb3-192"></a><span class="kw">#declare edgeTexture </span>= <span class="kw">texture</span> {</span>
<span id="cb3-193"><a href="#cb3-193"></a>  <span class="kw">pigment</span> { <span class="kw">color</span> Red }</span>
<span id="cb3-194"><a href="#cb3-194"></a>  <span class="kw">finish</span> {</span>
<span id="cb3-195"><a href="#cb3-195"></a>    <span class="kw">ambient</span> <span class="fl">.1</span></span>
<span id="cb3-196"><a href="#cb3-196"></a>    <span class="kw">diffuse</span> <span class="fl">.9</span></span>
<span id="cb3-197"><a href="#cb3-197"></a>    <span class="kw">reflection</span> <span class="fl">0</span></span>
<span id="cb3-198"><a href="#cb3-198"></a>    <span class="kw">specular</span> <span class="fl">1</span></span>
<span id="cb3-199"><a href="#cb3-199"></a>    <span class="kw">metallic</span></span>
<span id="cb3-200"><a href="#cb3-200"></a>  }</span>
<span id="cb3-201"><a href="#cb3-201"></a>};</span>
<span id="cb3-202"><a href="#cb3-202"></a></span>
<span id="cb3-203"><a href="#cb3-203"></a><span class="kw">object</span> {</span>
<span id="cb3-204"><a href="#cb3-204"></a>  <span class="kw">union</span> {</span>
<span id="cb3-205"><a href="#cb3-205"></a>    <span class="co">/* draw edges */</span></span>
<span id="cb3-206"><a href="#cb3-206"></a>    #for(i, <span class="fl">0</span>, <span class="fl">2</span>*A*B<span class="fl">-1</span>)</span>
<span id="cb3-207"><a href="#cb3-207"></a>      Edge(vertices, edges[i][<span class="fl">0</span>], edges[i][<span class="fl">1</span>], </span>
<span id="cb3-208"><a href="#cb3-208"></a>                    theta, phi, xi, edgeTexture)</span>
<span id="cb3-209"><a href="#cb3-209"></a>    <span class="ot">#end</span></span>
<span id="cb3-210"><a href="#cb3-210"></a>    <span class="co">/* draw vertices */</span></span>
<span id="cb3-211"><a href="#cb3-211"></a>    #for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</span>
<span id="cb3-212"><a href="#cb3-212"></a>      #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</span>
<span id="cb3-213"><a href="#cb3-213"></a>        <span class="kw">sphere</span> {</span>
<span id="cb3-214"><a href="#cb3-214"></a>          vs[i][j], <span class="kw">vlength</span>(vs[i][j])/<span class="fl">10</span></span>
<span id="cb3-215"><a href="#cb3-215"></a>          <span class="kw">texture</span> { edgeTexture }</span>
<span id="cb3-216"><a href="#cb3-216"></a>        }</span>
<span id="cb3-217"><a href="#cb3-217"></a>      <span class="ot">#end</span></span>
<span id="cb3-218"><a href="#cb3-218"></a>    <span class="ot">#end</span>  </span>
<span id="cb3-219"><a href="#cb3-219"></a>  }</span>
<span id="cb3-220"><a href="#cb3-220"></a>  <span class="kw">translate</span> &lt;-<span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">-15</span>&gt;</span>
<span id="cb3-221"><a href="#cb3-221"></a>  <span class="kw">scale</span> <span class="fl">0.8</span></span>
<span id="cb3-222"><a href="#cb3-222"></a>}</span>
<span id="cb3-223"><a href="#cb3-223"></a></span>
<span id="cb3-224"><a href="#cb3-224"></a><span class="co">/* ini file </span></span>
<span id="cb3-225"><a href="#cb3-225"></a><span class="co">Width = 512</span></span>
<span id="cb3-226"><a href="#cb3-226"></a><span class="co">Height = 512</span></span>
<span id="cb3-227"><a href="#cb3-227"></a><span class="co">Antialias = On</span></span>
<span id="cb3-228"><a href="#cb3-228"></a><span class="co">Antialias_Threshold = 0.3</span></span>
<span id="cb3-229"><a href="#cb3-229"></a><span class="co">Input_File_Name = DuoprismStereographic.pov</span></span>
<span id="cb3-230"><a href="#cb3-230"></a><span class="co">Initial_Clock = 0</span></span>
<span id="cb3-231"><a href="#cb3-231"></a><span class="co">Final_Clock = 1</span></span>
<span id="cb3-232"><a href="#cb3-232"></a><span class="co">Initial_Frame = 0</span></span>
<span id="cb3-233"><a href="#cb3-233"></a><span class="co">Final_Frame = 179</span></span>
<span id="cb3-234"><a href="#cb3-234"></a><span class="co">Subset_Start_Frame = 0</span></span>
<span id="cb3-235"><a href="#cb3-235"></a><span class="co">Cyclic_Animation = on</span></span>
<span id="cb3-236"><a href="#cb3-236"></a><span class="co">*/</span></span></code></pre></div>
<p><img src="./figures/DuoprismStereo_POVRAY.gif" /></p>
<p><br /></p>
<p>Here is another one. This is a hexagonal duoprism with a cell colored in red.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode povray"><code class="sourceCode povray"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="ot">#version</span> <span class="fl">3.7</span>;</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">global_settings</span> { <span class="kw">assumed_gamma</span> <span class="fl">1</span> } </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="ot">#include</span> <span class="st">&quot;colors.inc&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="ot">#include</span> <span class="st">&quot;textures.inc&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="co">// camera ----------------------------------------------------------------------</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="kw">camera</span> {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>  <span class="kw">location</span> &lt;<span class="fl">0</span>, <span class="fl">0</span>,-<span class="fl">10</span>&gt;</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>  <span class="kw">look_at</span> <span class="fl">0</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>  <span class="kw">angle</span> <span class="fl">45</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>  <span class="kw">right</span> <span class="kw">x</span>*<span class="kw">image_width</span>/<span class="kw">image_height</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="co">// light sources ---------------------------------------------------------------</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a><span class="kw">light_source</span> { &lt;<span class="fl">0</span>,<span class="fl">0</span>,-<span class="fl">100</span>&gt; White <span class="kw">shadowless</span> } </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="kw">light_source</span> { &lt;<span class="fl">100</span>,<span class="fl">0</span>,-<span class="fl">100</span>&gt; White <span class="kw">shadowless</span> } </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a><span class="co">// moon ------------------------------------------------------------------------</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a><span class="kw">light_source</span> { </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a>  &lt;-<span class="fl">1000</span>, <span class="fl">800</span>, <span class="fl">3000</span>&gt; </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a>  <span class="kw">color</span> White</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a>  <span class="kw">shadowless</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a>  <span class="kw">looks_like</span> { </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a>    <span class="kw">sphere</span> { </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a>      &lt;<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>&gt;, <span class="fl">300</span> </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true"></a>      <span class="kw">texture</span> { </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true"></a>        <span class="kw">pigment</span> { </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true"></a>          <span class="kw">color</span> Yellow</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true"></a>        }</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true"></a>        <span class="kw">normal</span> { </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true"></a>          <span class="kw">bumps</span> <span class="fl">0.5</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true"></a>          <span class="kw">scale</span> <span class="fl">50</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true"></a>        }</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true"></a>        <span class="kw">finish</span> { </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true"></a>          <span class="kw">emission</span> <span class="fl">0.8</span>   </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true"></a>          <span class="kw">diffuse</span> <span class="fl">0.2</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true"></a>          <span class="kw">phong</span> <span class="fl">1</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true"></a>        }                                        </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true"></a>      } </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true"></a>    } </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true"></a>  } </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true"></a>} </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true"></a><span class="co">// sky -------------------------------------------------------------------------</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true"></a><span class="kw">plane</span> { </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true"></a>  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">1</span> <span class="kw">hollow</span>  </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true"></a>  <span class="kw">texture</span> { </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true"></a>    <span class="kw">pigment</span> { </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true"></a>      <span class="kw">color</span> <span class="kw">rgb</span> &lt;<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.2</span>&gt; </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true"></a>    }</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true"></a>    <span class="kw">finish</span> { </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true"></a>      <span class="kw">emission</span> <span class="fl">0.5</span> </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true"></a>      <span class="kw">diffuse</span> <span class="fl">0.5</span> </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true"></a>    } </span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true"></a>  }  </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true"></a>  <span class="kw">scale</span> <span class="fl">10000</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true"></a>}</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true"></a></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true"></a><span class="co">// the clouds ------------------------------------------------------------------</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true"></a><span class="kw">plane</span> { </span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true"></a>  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;,<span class="fl">1</span> <span class="kw">hollow</span>  </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true"></a>  <span class="kw">texture</span> { </span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true"></a>    <span class="kw">pigment</span> { </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true"></a>      <span class="kw">bozo</span> <span class="kw">turbulence</span> <span class="fl">1.3</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true"></a>      <span class="kw">color_map</span> { </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true"></a>        [<span class="fl">0.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true"></a>        [<span class="fl">0.75</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true"></a>        [<span class="fl">0.83</span> <span class="kw">rgb</span> &lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;              ]</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true"></a>        [<span class="fl">0.95</span> <span class="kw">rgb</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;     ]</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true"></a>        [<span class="fl">1.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>&gt;        ]</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true"></a>      }</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true"></a>      <span class="kw">scale</span> <span class="fl">2.5</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true"></a>      <span class="kw">translate</span> &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true"></a>    }</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true"></a>    <span class="kw">finish</span> { </span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true"></a>      <span class="kw">emission</span> <span class="fl">0.25</span> </span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true"></a>      <span class="kw">diffuse</span> <span class="fl">0</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true"></a>    } </span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true"></a>  }      </span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true"></a>  <span class="kw">scale</span> <span class="fl">5000</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true"></a>}</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true"></a></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true"></a><span class="co">// fog on the ground -----------------------------------------------------------</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true"></a><span class="kw">fog</span> { </span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true"></a>  <span class="kw">fog_type</span>   <span class="fl">2</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true"></a>  <span class="kw">distance</span>   <span class="fl">50</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true"></a>  <span class="kw">color</span>      Gray50  </span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true"></a>  <span class="kw">fog_offset</span> <span class="fl">0.1</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true"></a>  <span class="kw">fog_alt</span>    <span class="fl">1.5</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true"></a>  <span class="kw">turbulence</span> <span class="fl">1.8</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true"></a>}</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true"></a></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true"></a><span class="co">// sea -------------------------------------------------------------------------</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true"></a><span class="kw">plane</span> { </span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true"></a>  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">-1</span> <span class="kw">hollow</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true"></a>  <span class="kw">texture</span>{</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true"></a>    <span class="kw">pigment</span>{</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true"></a>      <span class="kw">rgb</span> &lt;.<span class="fl">098</span>,.<span class="fl">098</span>,.<span class="fl">439</span>&gt;</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true"></a>    }</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true"></a>    <span class="kw">finish</span> {</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true"></a>      <span class="kw">ambient</span> <span class="fl">0.15</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true"></a>      <span class="kw">diffuse</span> <span class="fl">0.55</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true"></a>      <span class="kw">brilliance</span> <span class="fl">6.0</span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true"></a>      <span class="kw">phong</span> <span class="fl">0.8</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true"></a>      <span class="kw">phong_size</span> <span class="fl">120</span></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true"></a>      <span class="kw">reflection</span> <span class="fl">0.2</span></span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true"></a>    }</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true"></a>    <span class="kw">normal</span> { </span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true"></a>      <span class="kw">bumps</span> <span class="fl">0.95</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true"></a>      <span class="kw">turbulence</span> <span class="fl">.05</span> </span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true"></a>      <span class="kw">scale</span> &lt;<span class="fl">1</span>,<span class="fl">0.25</span>,<span class="fl">1</span>&gt; </span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true"></a>    }</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true"></a>  }</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true"></a>}</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true"></a></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true"></a><span class="co">// vertices --------------------------------------------------------------------</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true"></a><span class="kw">#declare a </span>= <span class="kw">sqrt</span>(<span class="fl">3</span>) / <span class="fl">2</span>;</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true"></a><span class="kw">#declare vertices </span>= <span class="kw">array</span>[<span class="fl">36</span>]</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true"></a>  {</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true"></a>    &lt;a, <span class="fl">0.5</span>, a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true"></a>    &lt;a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true"></a>    &lt;a, <span class="fl">0.5</span>, -a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true"></a>    &lt;a, <span class="fl">0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true"></a>    &lt;a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true"></a>    &lt;a, <span class="fl">0.5</span>, a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, -a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, -a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true"></a>    &lt;-a, <span class="fl">0.5</span>, a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true"></a>    &lt;-a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true"></a>    &lt;-a, <span class="fl">0.5</span>, -a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true"></a>    &lt;-a, <span class="fl">0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true"></a>    &lt;-a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true"></a>    &lt;-a, <span class="fl">0.5</span>, a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true"></a>    &lt;-a, <span class="fl">-0.5</span>, a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true"></a>    &lt;-a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true"></a>    &lt;-a, <span class="fl">-0.5</span>, -a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true"></a>    &lt;-a, <span class="fl">-0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true"></a>    &lt;-a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true"></a>    &lt;-a, <span class="fl">-0.5</span>, a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, -a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, -a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true"></a>    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true"></a>    &lt;a, <span class="fl">-0.5</span>, a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true"></a>    &lt;a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true"></a>    &lt;a, <span class="fl">-0.5</span>, -a, <span class="fl">0.5</span>&gt;,</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true"></a>    &lt;a, <span class="fl">-0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true"></a>    &lt;a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true"></a>    &lt;a, <span class="fl">-0.5</span>, a, <span class="fl">-0.5</span>&gt;</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true"></a>  };</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true"></a><span class="kw">#declare facetVertices </span>= <span class="kw">array</span>[<span class="fl">12</span>] {<span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">30</span>,<span class="fl">11</span>,<span class="fl">35</span>,<span class="fl">12</span>,<span class="fl">17</span>,<span class="fl">18</span>,<span class="fl">23</span>,<span class="fl">24</span>,<span class="fl">29</span>};</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true"></a><span class="kw">#declare otherVertices </span>= <span class="kw">array</span>[<span class="fl">24</span>] </span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true"></a>  {<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">8</span>,</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true"></a>  <span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span>,</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true"></a>  <span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">21</span>,<span class="fl">22</span>,<span class="fl">25</span>,<span class="fl">26</span>,</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true"></a>  <span class="fl">27</span>,<span class="fl">28</span>,<span class="fl">31</span>,<span class="fl">32</span>,<span class="fl">33</span>,<span class="fl">34</span>};</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true"></a></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true"></a><span class="co">// edges -------------------------------------------------------------------</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true"></a><span class="kw">#declare facetEdges </span>= <span class="kw">array</span>[<span class="fl">18</span>][<span class="fl">2</span>]</span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true"></a>  {</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true"></a>    {<span class="fl">0</span>, <span class="fl">5</span>},</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true"></a>    {<span class="fl">0</span>, <span class="fl">6</span>},</span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true"></a>    {<span class="fl">0</span>, <span class="fl">30</span>},</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true"></a>    {<span class="fl">5</span>, <span class="fl">11</span>},</span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true"></a>    {<span class="fl">5</span>, <span class="fl">35</span>},</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true"></a>    {<span class="fl">6</span>, <span class="fl">11</span>},</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true"></a>    {<span class="fl">6</span>, <span class="fl">12</span>},</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true"></a>    {<span class="fl">11</span>, <span class="fl">17</span>},</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true"></a>    {<span class="fl">12</span>, <span class="fl">17</span>},</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true"></a>    {<span class="fl">12</span>, <span class="fl">18</span>},</span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true"></a>    {<span class="fl">17</span>, <span class="fl">23</span>},</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true"></a>    {<span class="fl">18</span>, <span class="fl">23</span>},</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true"></a>    {<span class="fl">18</span>, <span class="fl">24</span>},</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true"></a>    {<span class="fl">23</span>, <span class="fl">29</span>},</span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true"></a>    {<span class="fl">24</span>, <span class="fl">29</span>},</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true"></a>    {<span class="fl">24</span>, <span class="fl">30</span>},</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true"></a>    {<span class="fl">29</span>, <span class="fl">35</span>},</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true"></a>    {<span class="fl">30</span>, <span class="fl">35</span>}</span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true"></a>  };</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true"></a><span class="kw">#declare otherEdges </span>= <span class="kw">array</span>[<span class="fl">54</span>][<span class="fl">2</span>]</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true"></a>  {</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true"></a>    {<span class="fl">0</span>, <span class="fl">1</span>},</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true"></a>    {<span class="fl">1</span>, <span class="fl">2</span>},</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true"></a>    {<span class="fl">1</span>, <span class="fl">7</span>},</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true"></a>    {<span class="fl">1</span>, <span class="fl">31</span>},</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true"></a>    {<span class="fl">2</span>, <span class="fl">3</span>},</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true"></a>    {<span class="fl">2</span>, <span class="fl">8</span>},</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true"></a>    {<span class="fl">2</span>, <span class="fl">32</span>},</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true"></a>    {<span class="fl">3</span>, <span class="fl">4</span>},</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true"></a>    {<span class="fl">3</span>, <span class="fl">9</span>},</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true"></a>    {<span class="fl">3</span>, <span class="fl">33</span>},</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true"></a>    {<span class="fl">4</span>, <span class="fl">5</span>},</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true"></a>    {<span class="fl">4</span>, <span class="fl">10</span>},</span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true"></a>    {<span class="fl">4</span>, <span class="fl">34</span>},</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true"></a>    {<span class="fl">6</span>, <span class="fl">7</span>},</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true"></a>    {<span class="fl">7</span>, <span class="fl">8</span>},</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true"></a>    {<span class="fl">7</span>, <span class="fl">13</span>},</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true"></a>    {<span class="fl">8</span>, <span class="fl">9</span>},</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true"></a>    {<span class="fl">8</span>, <span class="fl">14</span>},</span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true"></a>    {<span class="fl">9</span>, <span class="fl">10</span>},</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true"></a>    {<span class="fl">9</span>, <span class="fl">15</span>},</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true"></a>    {<span class="fl">10</span>, <span class="fl">11</span>},</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true"></a>    {<span class="fl">10</span>, <span class="fl">16</span>},</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true"></a>    {<span class="fl">12</span>, <span class="fl">13</span>},</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true"></a>    {<span class="fl">13</span>, <span class="fl">14</span>},</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true"></a>    {<span class="fl">13</span>, <span class="fl">19</span>},</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true"></a>    {<span class="fl">14</span>, <span class="fl">15</span>},</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true"></a>    {<span class="fl">14</span>, <span class="fl">20</span>},</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true"></a>    {<span class="fl">15</span>, <span class="fl">16</span>},</span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true"></a>    {<span class="fl">15</span>, <span class="fl">21</span>},</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true"></a>    {<span class="fl">16</span>, <span class="fl">17</span>},</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true"></a>    {<span class="fl">16</span>, <span class="fl">22</span>},</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true"></a>    {<span class="fl">18</span>, <span class="fl">19</span>},</span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true"></a>    {<span class="fl">19</span>, <span class="fl">20</span>},</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true"></a>    {<span class="fl">19</span>, <span class="fl">25</span>},</span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true"></a>    {<span class="fl">20</span>, <span class="fl">21</span>},</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true"></a>    {<span class="fl">20</span>, <span class="fl">26</span>},</span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true"></a>    {<span class="fl">21</span>, <span class="fl">22</span>},</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true"></a>    {<span class="fl">21</span>, <span class="fl">27</span>},</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true"></a>    {<span class="fl">22</span>, <span class="fl">23</span>},</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true"></a>    {<span class="fl">22</span>, <span class="fl">28</span>},</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true"></a>    {<span class="fl">24</span>, <span class="fl">25</span>},</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true"></a>    {<span class="fl">25</span>, <span class="fl">26</span>},</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true"></a>    {<span class="fl">25</span>, <span class="fl">31</span>},</span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true"></a>    {<span class="fl">26</span>, <span class="fl">27</span>},</span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true"></a>    {<span class="fl">26</span>, <span class="fl">32</span>},</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true"></a>    {<span class="fl">27</span>, <span class="fl">28</span>},</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true"></a>    {<span class="fl">27</span>, <span class="fl">33</span>},</span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true"></a>    {<span class="fl">28</span>, <span class="fl">29</span>},</span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true"></a>    {<span class="fl">28</span>, <span class="fl">34</span>},</span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true"></a>    {<span class="fl">30</span>, <span class="fl">31</span>},</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true"></a>    {<span class="fl">31</span>, <span class="fl">32</span>},</span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true"></a>    {<span class="fl">32</span>, <span class="fl">33</span>},</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true"></a>    {<span class="fl">33</span>, <span class="fl">34</span>},</span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true"></a>    {<span class="fl">34</span>, <span class="fl">35</span>}</span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true"></a>  };</span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true"></a></span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true"></a><span class="co">// macros ----------------------------------------------------------------------</span></span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true"></a><span class="kw">#macro vlength4</span>(P)</span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true"></a>  <span class="kw">sqrt</span>(P.<span class="kw">x</span>*P.<span class="kw">x</span> + P.<span class="kw">y</span>*P.<span class="kw">y</span> + P.<span class="kw">z</span>*P.<span class="kw">z</span> + P.<span class="kw">t</span>*P.<span class="kw">t</span>)</span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true"></a><span class="ot">#end</span></span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true"></a></span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true"></a><span class="kw">#macro sphericalSegment</span>(P, Q, n)</span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true"></a>  <span class="kw">#local out </span>= <span class="kw">array</span>[n+<span class="fl">1</span>];</span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true"></a>  #for(i, <span class="fl">0</span>, n)</span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true"></a>    <span class="kw">#local pt </span>= P + (i/n)*(Q-P);</span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true"></a>    <span class="kw">#local out</span>[i] = <span class="kw">sqrt</span>(<span class="fl">2</span>)/vlength4(pt) * pt;</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true"></a>  <span class="ot">#end</span></span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true"></a>  out</span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true"></a><span class="ot">#end</span></span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true"></a></span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true"></a><span class="kw">#macro rotate4d</span>(theta,phi,xi,vec)</span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true"></a>  <span class="kw">#local a </span>= <span class="kw">cos</span>(xi);</span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true"></a>  <span class="kw">#local b </span>= <span class="kw">sin</span>(theta)*<span class="kw">cos</span>(phi)*<span class="kw">sin</span>(xi);</span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true"></a>  <span class="kw">#local c </span>= <span class="kw">sin</span>(theta)*<span class="kw">sin</span>(phi)*<span class="kw">sin</span>(xi);</span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true"></a>  <span class="kw">#local d </span>= <span class="kw">cos</span>(theta)*<span class="kw">sin</span>(xi);</span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true"></a>  <span class="kw">#local p </span>= vec.<span class="kw">x</span>;</span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true"></a>  <span class="kw">#local q </span>= vec.<span class="kw">y</span>;</span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true"></a>  <span class="kw">#local r </span>= vec.<span class="kw">z</span>;</span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true"></a>  <span class="kw">#local s </span>= vec.<span class="kw">t</span>;</span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true"></a>  &lt; a*p - b*q - c*r - d*s</span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true"></a>  , a*q + b*p + c*s - d*r</span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true"></a>  , a*r - b*s + c*p + d*q</span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true"></a>  , a*s + b*r - c*q + d*p &gt;</span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true"></a><span class="ot">#end</span></span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true"></a></span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true"></a><span class="kw">#macro StereographicProjection</span>(q) </span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true"></a>  <span class="kw">acos</span>(q.<span class="kw">t</span>/<span class="kw">sqrt</span>(<span class="fl">2</span>))/<span class="kw">sqrt</span>(<span class="fl">2</span>-q.<span class="kw">t</span>*q.<span class="kw">t</span>) * &lt;q.<span class="kw">x</span>,q.<span class="kw">y</span>,q.<span class="kw">z</span>&gt;</span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true"></a><span class="ot">#end</span></span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true"></a></span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true"></a><span class="kw">#macro ProjectedFacetVertices</span>(theta, phi, xi)</span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true"></a>  <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="fl">12</span>];</span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true"></a>  #for(i, <span class="fl">0</span>, <span class="fl">11</span>)</span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true"></a>    <span class="kw">#local out</span>[i] = </span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true"></a>      StereographicProjection(</span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true"></a>        rotate4d(theta, phi, xi, vertices[facetVertices[i]])</span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true"></a>      );</span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true"></a>  <span class="ot">#end</span></span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true"></a>  out</span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true"></a><span class="ot">#end</span></span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true"></a></span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true"></a><span class="kw">#macro ProjectedOtherVertices</span>(theta, phi, xi)</span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true"></a>  <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="fl">24</span>];</span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true"></a>  #for(i, <span class="fl">0</span>, <span class="fl">23</span>)</span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true"></a>    <span class="kw">#local out</span>[i] = </span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true"></a>      StereographicProjection(</span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true"></a>        rotate4d(theta, phi, xi, vertices[otherVertices[i]])</span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true"></a>      );</span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true"></a>  <span class="ot">#end</span></span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true"></a>  out</span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true"></a><span class="ot">#end</span></span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true"></a></span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true"></a><span class="co">// texture ---------------------------------------------------------------------</span></span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true"></a><span class="kw">#declare edgeTexture1 </span>= </span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true"></a>  <span class="kw">texture</span> {</span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true"></a>    New_Penny</span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true"></a>    <span class="kw">finish</span> {</span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true"></a>      <span class="kw">ambient</span> <span class="fl">0.01</span></span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true"></a>      <span class="kw">diffuse</span> <span class="fl">2</span></span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true"></a>      <span class="kw">reflection</span> <span class="fl">0</span></span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true"></a>      <span class="kw">brilliance</span> <span class="fl">8</span></span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true"></a>      <span class="kw">specular</span> <span class="fl">0.1</span></span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true"></a>      <span class="kw">roughness</span> <span class="fl">0.1</span></span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true"></a>    }</span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true"></a>  };</span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true"></a></span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true"></a><span class="kw">#declare edgeTexture2 </span>= </span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true"></a>  <span class="kw">texture</span> {</span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true"></a>    <span class="kw">pigment</span> { Red }</span>
<span id="cb4-316"><a href="#cb4-316" aria-hidden="true"></a>    <span class="kw">finish</span> {</span>
<span id="cb4-317"><a href="#cb4-317" aria-hidden="true"></a>      <span class="kw">ambient</span> <span class="fl">0.01</span></span>
<span id="cb4-318"><a href="#cb4-318" aria-hidden="true"></a>      <span class="kw">diffuse</span> <span class="fl">2</span></span>
<span id="cb4-319"><a href="#cb4-319" aria-hidden="true"></a>      <span class="kw">reflection</span> <span class="fl">0</span></span>
<span id="cb4-320"><a href="#cb4-320" aria-hidden="true"></a>      <span class="kw">brilliance</span> <span class="fl">8</span></span>
<span id="cb4-321"><a href="#cb4-321" aria-hidden="true"></a>      <span class="kw">specular</span> <span class="fl">0.1</span></span>
<span id="cb4-322"><a href="#cb4-322" aria-hidden="true"></a>      <span class="kw">roughness</span> <span class="fl">0.1</span></span>
<span id="cb4-323"><a href="#cb4-323" aria-hidden="true"></a>    }</span>
<span id="cb4-324"><a href="#cb4-324" aria-hidden="true"></a>  };</span>
<span id="cb4-325"><a href="#cb4-325" aria-hidden="true"></a></span>
<span id="cb4-326"><a href="#cb4-326" aria-hidden="true"></a><span class="co">// draw an edge ----------------------------------------------------------------</span></span>
<span id="cb4-327"><a href="#cb4-327" aria-hidden="true"></a><span class="kw">#macro Edge</span>(verts, v1, v2, theta, phi, xi, Tex)</span>
<span id="cb4-328"><a href="#cb4-328" aria-hidden="true"></a>  <span class="kw">#local P </span>= verts[v1];</span>
<span id="cb4-329"><a href="#cb4-329" aria-hidden="true"></a>  <span class="kw">#local Q </span>= verts[v2];</span>
<span id="cb4-330"><a href="#cb4-330" aria-hidden="true"></a>  <span class="kw">#local PQ </span>= sphericalSegment(P, Q, <span class="fl">100</span>);</span>
<span id="cb4-331"><a href="#cb4-331" aria-hidden="true"></a>  <span class="kw">sphere_sweep</span> {</span>
<span id="cb4-332"><a href="#cb4-332" aria-hidden="true"></a>    <span class="kw">b_spline</span> <span class="fl">101</span></span>
<span id="cb4-333"><a href="#cb4-333" aria-hidden="true"></a>    #for(k,<span class="fl">0</span>,<span class="fl">100</span>)</span>
<span id="cb4-334"><a href="#cb4-334" aria-hidden="true"></a>      <span class="kw">#local O </span>= StereographicProjection(rotate4d(theta,phi,xi,PQ[k]));</span>
<span id="cb4-335"><a href="#cb4-335" aria-hidden="true"></a>      O <span class="kw">vlength</span>(O)/<span class="fl">20</span></span>
<span id="cb4-336"><a href="#cb4-336" aria-hidden="true"></a>    <span class="ot">#end</span></span>
<span id="cb4-337"><a href="#cb4-337" aria-hidden="true"></a>    <span class="kw">texture</span> { </span>
<span id="cb4-338"><a href="#cb4-338" aria-hidden="true"></a>        Tex</span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true"></a>    }</span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true"></a>  }</span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true"></a><span class="ot">#end</span></span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true"></a></span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true"></a><span class="co">// draw ------------------------------------------------------------------------</span></span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true"></a><span class="kw">#declare theta </span>= <span class="fl">pi</span>/<span class="fl">2</span>;</span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true"></a><span class="kw">#declare phi </span>= <span class="fl">0</span>;</span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true"></a><span class="kw">#declare xi </span>= <span class="fl">2</span>*<span class="kw">frame_number</span>*<span class="fl">pi</span>/<span class="fl">180</span>;</span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true"></a><span class="kw">#declare vsFacet </span>= ProjectedFacetVertices(theta, phi, xi);</span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true"></a><span class="kw">#declare vsOther </span>= ProjectedOtherVertices(theta, phi, xi);</span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true"></a><span class="kw">object</span> {</span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true"></a>  <span class="kw">union</span> {</span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true"></a>    #for(i, <span class="fl">0</span>, <span class="fl">53</span>)</span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true"></a>      Edge(vertices, otherEdges[i][<span class="fl">0</span>], otherEdges[i][<span class="fl">1</span>], </span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true"></a>                            theta, phi, xi, edgeTexture1)</span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true"></a>    <span class="ot">#end</span></span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true"></a>    #for(i, <span class="fl">0</span>, <span class="fl">17</span>)</span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true"></a>      Edge(vertices, facetEdges[i][<span class="fl">0</span>], facetEdges[i][<span class="fl">1</span>], </span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true"></a>                            theta, phi, xi, edgeTexture2)</span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true"></a>    <span class="ot">#end</span></span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true"></a>    #for(i, <span class="fl">0</span>, <span class="fl">23</span>)</span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true"></a>      <span class="kw">sphere</span> {</span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true"></a>        vsOther[i], <span class="kw">vlength</span>(vsOther[i])/<span class="fl">10</span></span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true"></a>        <span class="kw">texture</span> { edgeTexture1 }</span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true"></a>      }</span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true"></a>    <span class="ot">#end</span>  </span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true"></a>    #for(i, <span class="fl">0</span>, <span class="fl">11</span>)</span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true"></a>      <span class="kw">sphere</span> {</span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true"></a>        vsFacet[i], <span class="kw">vlength</span>(vsFacet[i])/<span class="fl">10</span></span>
<span id="cb4-368"><a href="#cb4-368" aria-hidden="true"></a>        <span class="kw">texture</span> { edgeTexture2 }</span>
<span id="cb4-369"><a href="#cb4-369" aria-hidden="true"></a>      }</span>
<span id="cb4-370"><a href="#cb4-370" aria-hidden="true"></a>    <span class="ot">#end</span>  </span>
<span id="cb4-371"><a href="#cb4-371" aria-hidden="true"></a>  }</span>
<span id="cb4-372"><a href="#cb4-372" aria-hidden="true"></a>  <span class="kw">scale</span> <span class="fl">0.5</span></span>
<span id="cb4-373"><a href="#cb4-373" aria-hidden="true"></a>  <span class="kw">rotate</span> &lt;<span class="fl">60</span>, <span class="fl">0</span>, <span class="fl">0</span>&gt;</span>
<span id="cb4-374"><a href="#cb4-374" aria-hidden="true"></a>  <span class="kw">translate</span> &lt;<span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">-2</span>&gt;</span>
<span id="cb4-375"><a href="#cb4-375" aria-hidden="true"></a>}</span></code></pre></div>
<p><img src="./figures/DuoprismStereo_POVRAY2.gif" /></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->


</html>