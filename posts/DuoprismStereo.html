<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Drawing a stereographic duoprism</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
    <link href="../libraries/highlighters/prettify/css/minimal.css" rel="stylesheet"> 
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:26px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:22px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo" style="position:absolute;">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Drawing a stereographic duoprism</h1> 
          <div class="info">
    Posted on February 11, 2020
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a href="../tags/R.html">R</a>, <a href="../tags/maths.html">maths</a>, <a href="../tags/geometry.html">geometry</a>, <a href="../tags/graphics.html">graphics</a>, <a href="../tags/rgl.html">rgl</a>, <a href="../tags/asymptote.html">asymptote</a>, <a href="../tags/povray.html">povray</a>
    
</div>

<p>In this post, I’ll show how to draw a stereographic <a href="./Duoprism.html">duoprism</a> using R, Asymptote and POV-Ray.</p>
<h1 id="with-r">With R</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3">A &lt;-<span class="st"> </span>8L <span class="co"># number of sides of the first polygon</span></a>
<a class="sourceLine" id="cb1-4" title="4">B &lt;-<span class="st"> </span>4L <span class="co"># number of sides of the second polygon</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># construction of the vertices</span></a>
<a class="sourceLine" id="cb1-7" title="7">vertices &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_real_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(A,B,4L))</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>A){</a>
<a class="sourceLine" id="cb1-9" title="9">  v1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(i<span class="op">/</span>A<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi), <span class="kw">sin</span>(i<span class="op">/</span>A<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi))</a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="cf">for</span>(j <span class="cf">in</span> 1L<span class="op">:</span>B){</a>
<a class="sourceLine" id="cb1-11" title="11">    v2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(j<span class="op">/</span>B<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi), <span class="kw">sin</span>(j<span class="op">/</span>B<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi))</a>
<a class="sourceLine" id="cb1-12" title="12">    vertices[i,j,] &lt;-<span class="st"> </span><span class="kw">c</span>(v1,v2)</a>
<a class="sourceLine" id="cb1-13" title="13">  }</a>
<a class="sourceLine" id="cb1-14" title="14">}</a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co"># construction of the edges</span></a>
<a class="sourceLine" id="cb1-17" title="17">edges &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_integer_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(2L,2L,2L<span class="op">*</span>A<span class="op">*</span>B))</a>
<a class="sourceLine" id="cb1-18" title="18">dominates &lt;-<span class="st"> </span><span class="cf">function</span>(c1, c2){</a>
<a class="sourceLine" id="cb1-19" title="19">  c2[1L]<span class="op">&gt;</span>c1[1L] <span class="op">||</span><span class="st"> </span>(c2[1L]<span class="op">==</span>c1[1L] <span class="op">&amp;&amp;</span><span class="st"> </span>c2[2L]<span class="op">&gt;</span>c1[2L])</a>
<a class="sourceLine" id="cb1-20" title="20">}</a>
<a class="sourceLine" id="cb1-21" title="21">counter &lt;-<span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-22" title="22"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_len</span>(A)<span class="op">-</span>1L){</a>
<a class="sourceLine" id="cb1-23" title="23">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_len</span>(B)<span class="op">-</span>1L){</a>
<a class="sourceLine" id="cb1-24" title="24">    c1 &lt;-<span class="st"> </span><span class="kw">c</span>(i,j)</a>
<a class="sourceLine" id="cb1-25" title="25">    candidate &lt;-<span class="st"> </span><span class="kw">c</span>(i, (j<span class="op">-</span>1L)<span class="op">%%</span>B)</a>
<a class="sourceLine" id="cb1-26" title="26">    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</a>
<a class="sourceLine" id="cb1-27" title="27">      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-28" title="28">      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-29" title="29">    }</a>
<a class="sourceLine" id="cb1-30" title="30">    candidate &lt;-<span class="st"> </span><span class="kw">c</span>(i, (j<span class="op">+</span>1L)<span class="op">%%</span>B)</a>
<a class="sourceLine" id="cb1-31" title="31">    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</a>
<a class="sourceLine" id="cb1-32" title="32">      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-33" title="33">      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-34" title="34">    }</a>
<a class="sourceLine" id="cb1-35" title="35">    candidate &lt;-<span class="st"> </span><span class="kw">c</span>((i<span class="op">-</span>1L)<span class="op">%%</span>A, j)</a>
<a class="sourceLine" id="cb1-36" title="36">    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</a>
<a class="sourceLine" id="cb1-37" title="37">      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-38" title="38">      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-39" title="39">    }</a>
<a class="sourceLine" id="cb1-40" title="40">    candidate &lt;-<span class="st"> </span><span class="kw">c</span>((i<span class="op">+</span>1L)<span class="op">%%</span>A, j)</a>
<a class="sourceLine" id="cb1-41" title="41">    <span class="cf">if</span>(<span class="kw">dominates</span>(c1, candidate)){</a>
<a class="sourceLine" id="cb1-42" title="42">      edges[,,counter] &lt;-<span class="st"> </span><span class="kw">cbind</span>(c1, candidate) <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-43" title="43">      counter &lt;-<span class="st"> </span>counter <span class="op">+</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb1-44" title="44">    }</a>
<a class="sourceLine" id="cb1-45" title="45">  }</a>
<a class="sourceLine" id="cb1-46" title="46">}</a>
<a class="sourceLine" id="cb1-47" title="47"></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="co"># stereographic projection</span></a>
<a class="sourceLine" id="cb1-49" title="49">stereog &lt;-<span class="st"> </span><span class="cf">function</span>(v){</a>
<a class="sourceLine" id="cb1-50" title="50">  v[1L<span class="op">:</span>3L] <span class="op">/</span><span class="st"> </span>(<span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>v[4L])</a>
<a class="sourceLine" id="cb1-51" title="51">}</a>
<a class="sourceLine" id="cb1-52" title="52"></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="co"># spherical segment</span></a>
<a class="sourceLine" id="cb1-54" title="54">sphericalSegment &lt;-<span class="st"> </span><span class="cf">function</span>(P, Q, n){</a>
<a class="sourceLine" id="cb1-55" title="55">  out &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_real_</span>, <span class="dt">nrow =</span> n<span class="op">+</span>1L, <span class="dt">ncol =</span> 4L)</a>
<a class="sourceLine" id="cb1-56" title="56">  <span class="cf">for</span>(i <span class="cf">in</span> 0L<span class="op">:</span>n){</a>
<a class="sourceLine" id="cb1-57" title="57">    pt &lt;-<span class="st"> </span>P <span class="op">+</span><span class="st"> </span>(i<span class="op">/</span>n)<span class="op">*</span>(Q<span class="op">-</span>P)</a>
<a class="sourceLine" id="cb1-58" title="58">    out[i<span class="op">+</span>1L, ] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">c</span>(<span class="kw">crossprod</span>(pt))) <span class="op">*</span><span class="st"> </span>pt</a>
<a class="sourceLine" id="cb1-59" title="59">  }</a>
<a class="sourceLine" id="cb1-60" title="60">  out</a>
<a class="sourceLine" id="cb1-61" title="61">}</a>
<a class="sourceLine" id="cb1-62" title="62"></a>
<a class="sourceLine" id="cb1-63" title="63"><span class="co"># stereographic edge</span></a>
<a class="sourceLine" id="cb1-64" title="64">stereoEdge &lt;-<span class="st"> </span><span class="cf">function</span>(verts, v1, v2){</a>
<a class="sourceLine" id="cb1-65" title="65">  P &lt;-<span class="st"> </span>verts[v1[1L], v1[2L], ]</a>
<a class="sourceLine" id="cb1-66" title="66">  Q &lt;-<span class="st"> </span>verts[v2[1L], v2[2L], ]</a>
<a class="sourceLine" id="cb1-67" title="67">  PQ &lt;-<span class="st"> </span><span class="kw">sphericalSegment</span>(P, Q, 100L)</a>
<a class="sourceLine" id="cb1-68" title="68">  pq &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(PQ, 1L, stereog))</a>
<a class="sourceLine" id="cb1-69" title="69">  dists &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">apply</span>(pq, 1L, crossprod))</a>
<a class="sourceLine" id="cb1-70" title="70">  <span class="kw">cylinder3d</span>(pq, <span class="dt">radius =</span> dists<span class="op">/</span><span class="dv">15</span>, <span class="dt">sides =</span> <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb1-71" title="71">}</a>
<a class="sourceLine" id="cb1-72" title="72"></a>
<a class="sourceLine" id="cb1-73" title="73"><span class="co"># projected vertices</span></a>
<a class="sourceLine" id="cb1-74" title="74">vs &lt;-<span class="st"> </span><span class="kw">apply</span>(vertices, <span class="kw">c</span>(1L,2L), stereog)</a>
<a class="sourceLine" id="cb1-75" title="75"></a>
<a class="sourceLine" id="cb1-76" title="76"><span class="co">####~~~~ plot ~~~~####</span></a>
<a class="sourceLine" id="cb1-77" title="77"><span class="kw">open3d</span>(<span class="dt">windowRect =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">562</span>, <span class="dv">562</span>), <span class="dt">zoom =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb1-78" title="78"><span class="kw">bg3d</span>(<span class="kw">rgb</span>(<span class="dv">54</span>, <span class="dv">57</span>, <span class="dv">64</span>, <span class="dt">maxColorValue =</span> <span class="dv">255</span>))</a>
<a class="sourceLine" id="cb1-79" title="79"><span class="co">## plot the edges</span></a>
<a class="sourceLine" id="cb1-80" title="80"><span class="cf">for</span>(k <span class="cf">in</span> 1L<span class="op">:</span>(2L<span class="op">*</span>A<span class="op">*</span>B)){</a>
<a class="sourceLine" id="cb1-81" title="81">  v1 &lt;-<span class="st"> </span>edges[, 1L, k]</a>
<a class="sourceLine" id="cb1-82" title="82">  v2 &lt;-<span class="st"> </span>edges[, 2L, k]</a>
<a class="sourceLine" id="cb1-83" title="83">  edge &lt;-<span class="st"> </span><span class="kw">stereoEdge</span>(vertices, v1, v2)</a>
<a class="sourceLine" id="cb1-84" title="84">  <span class="kw">shade3d</span>(edge, <span class="dt">color =</span> <span class="st">&quot;gold&quot;</span>)</a>
<a class="sourceLine" id="cb1-85" title="85">}</a>
<a class="sourceLine" id="cb1-86" title="86"><span class="co">## plot the vertices</span></a>
<a class="sourceLine" id="cb1-87" title="87"><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>A){</a>
<a class="sourceLine" id="cb1-88" title="88">  <span class="cf">for</span>(j <span class="cf">in</span> 1L<span class="op">:</span>B){</a>
<a class="sourceLine" id="cb1-89" title="89">    v &lt;-<span class="st"> </span>vs[,i,j]</a>
<a class="sourceLine" id="cb1-90" title="90">    <span class="kw">spheres3d</span>(v, <span class="dt">radius =</span> <span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(v)))<span class="op">/</span><span class="dv">10</span> , <span class="dt">color =</span> <span class="st">&quot;gold2&quot;</span>)</a>
<a class="sourceLine" id="cb1-91" title="91">  }</a>
<a class="sourceLine" id="cb1-92" title="92">}</a></code></pre></div>
<p><img src="./figures/DuoprismStereo_R.png" /></p>
<h1 id="with-asymptote">With Asymptote</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb2-1" title="1">settings.render = <span class="dv">4</span>;</a>
<a class="sourceLine" id="cb2-2" title="2">settings.outformat = <span class="st">&quot;eps&quot;</span>;</a>
<a class="sourceLine" id="cb2-3" title="3">import tube;</a>
<a class="sourceLine" id="cb2-4" title="4">size(<span class="dv">200</span>,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6">currentprojection = orthographic(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>);</a>
<a class="sourceLine" id="cb2-7" title="7">currentlight = light(gray(<span class="fl">0.85</span>), ambient=black, specularfactor=<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2-8" title="8">                     (<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>), specular=gray(<span class="fl">0.9</span>), viewport=<span class="kw">false</span>);</a>
<a class="sourceLine" id="cb2-9" title="9">currentlight.background = rgb(<span class="st">&quot;363940ff&quot;</span>);</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">// files to be saved -----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-12" title="12">string[] files = {</a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="st">&quot;DP000&quot;</span>, <span class="st">&quot;DP001&quot;</span>, <span class="st">&quot;DP002&quot;</span>, <span class="st">&quot;DP003&quot;</span>, <span class="st">&quot;DP004&quot;</span>, <span class="st">&quot;DP005&quot;</span>,</a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="st">&quot;DP006&quot;</span>, <span class="st">&quot;DP007&quot;</span>, <span class="st">&quot;DP008&quot;</span>, <span class="st">&quot;DP009&quot;</span>, <span class="st">&quot;DP010&quot;</span>, <span class="st">&quot;DP011&quot;</span>,</a>
<a class="sourceLine" id="cb2-15" title="15">    <span class="st">&quot;DP012&quot;</span>, <span class="st">&quot;DP013&quot;</span>, <span class="st">&quot;DP014&quot;</span>, <span class="st">&quot;DP015&quot;</span>, <span class="st">&quot;DP016&quot;</span>, <span class="st">&quot;DP017&quot;</span>,</a>
<a class="sourceLine" id="cb2-16" title="16">    <span class="st">&quot;DP018&quot;</span>, <span class="st">&quot;DP019&quot;</span>, <span class="st">&quot;DP020&quot;</span>, <span class="st">&quot;DP021&quot;</span>, <span class="st">&quot;DP022&quot;</span>, <span class="st">&quot;DP023&quot;</span>,</a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="st">&quot;DP024&quot;</span>, <span class="st">&quot;DP025&quot;</span>, <span class="st">&quot;DP026&quot;</span>, <span class="st">&quot;DP027&quot;</span>, <span class="st">&quot;DP028&quot;</span>, <span class="st">&quot;DP029&quot;</span>,</a>
<a class="sourceLine" id="cb2-18" title="18">    <span class="st">&quot;DP030&quot;</span>, <span class="st">&quot;DP031&quot;</span>, <span class="st">&quot;DP032&quot;</span>, <span class="st">&quot;DP033&quot;</span>, <span class="st">&quot;DP034&quot;</span>, <span class="st">&quot;DP035&quot;</span>,</a>
<a class="sourceLine" id="cb2-19" title="19">    <span class="st">&quot;DP036&quot;</span>, <span class="st">&quot;DP037&quot;</span>, <span class="st">&quot;DP038&quot;</span>, <span class="st">&quot;DP039&quot;</span>, <span class="st">&quot;DP040&quot;</span>, <span class="st">&quot;DP041&quot;</span>,</a>
<a class="sourceLine" id="cb2-20" title="20">    <span class="st">&quot;DP042&quot;</span>, <span class="st">&quot;DP043&quot;</span>, <span class="st">&quot;DP044&quot;</span>, <span class="st">&quot;DP045&quot;</span>, <span class="st">&quot;DP046&quot;</span>, <span class="st">&quot;DP047&quot;</span>,</a>
<a class="sourceLine" id="cb2-21" title="21">    <span class="st">&quot;DP048&quot;</span>, <span class="st">&quot;DP049&quot;</span>, <span class="st">&quot;DP050&quot;</span>, <span class="st">&quot;DP051&quot;</span>, <span class="st">&quot;DP052&quot;</span>, <span class="st">&quot;DP053&quot;</span>,</a>
<a class="sourceLine" id="cb2-22" title="22">    <span class="st">&quot;DP054&quot;</span>, <span class="st">&quot;DP055&quot;</span>, <span class="st">&quot;DP056&quot;</span>, <span class="st">&quot;DP057&quot;</span>, <span class="st">&quot;DP058&quot;</span>, <span class="st">&quot;DP059&quot;</span>,</a>
<a class="sourceLine" id="cb2-23" title="23">    <span class="st">&quot;DP060&quot;</span>, <span class="st">&quot;DP061&quot;</span>, <span class="st">&quot;DP062&quot;</span>, <span class="st">&quot;DP063&quot;</span>, <span class="st">&quot;DP064&quot;</span>, <span class="st">&quot;DP065&quot;</span>,</a>
<a class="sourceLine" id="cb2-24" title="24">    <span class="st">&quot;DP066&quot;</span>, <span class="st">&quot;DP067&quot;</span>, <span class="st">&quot;DP068&quot;</span>, <span class="st">&quot;DP069&quot;</span>, <span class="st">&quot;DP070&quot;</span>, <span class="st">&quot;DP071&quot;</span>,</a>
<a class="sourceLine" id="cb2-25" title="25">    <span class="st">&quot;DP072&quot;</span>, <span class="st">&quot;DP073&quot;</span>, <span class="st">&quot;DP074&quot;</span>, <span class="st">&quot;DP075&quot;</span>, <span class="st">&quot;DP076&quot;</span>, <span class="st">&quot;DP077&quot;</span>,</a>
<a class="sourceLine" id="cb2-26" title="26">    <span class="st">&quot;DP078&quot;</span>, <span class="st">&quot;DP079&quot;</span>, <span class="st">&quot;DP080&quot;</span>, <span class="st">&quot;DP081&quot;</span>, <span class="st">&quot;DP082&quot;</span>, <span class="st">&quot;DP083&quot;</span>,</a>
<a class="sourceLine" id="cb2-27" title="27">    <span class="st">&quot;DP084&quot;</span>, <span class="st">&quot;DP085&quot;</span>, <span class="st">&quot;DP086&quot;</span>, <span class="st">&quot;DP087&quot;</span>, <span class="st">&quot;DP088&quot;</span>, <span class="st">&quot;DP089&quot;</span>,</a>
<a class="sourceLine" id="cb2-28" title="28">    <span class="st">&quot;DP090&quot;</span>, <span class="st">&quot;DP091&quot;</span>, <span class="st">&quot;DP092&quot;</span>, <span class="st">&quot;DP093&quot;</span>, <span class="st">&quot;DP094&quot;</span>, <span class="st">&quot;DP095&quot;</span>,</a>
<a class="sourceLine" id="cb2-29" title="29">    <span class="st">&quot;DP096&quot;</span>, <span class="st">&quot;DP097&quot;</span>, <span class="st">&quot;DP098&quot;</span>, <span class="st">&quot;DP099&quot;</span>, <span class="st">&quot;DP100&quot;</span>, <span class="st">&quot;DP101&quot;</span>,</a>
<a class="sourceLine" id="cb2-30" title="30">    <span class="st">&quot;DP102&quot;</span>, <span class="st">&quot;DP103&quot;</span>, <span class="st">&quot;DP104&quot;</span>, <span class="st">&quot;DP105&quot;</span>, <span class="st">&quot;DP106&quot;</span>, <span class="st">&quot;DP107&quot;</span>,</a>
<a class="sourceLine" id="cb2-31" title="31">    <span class="st">&quot;DP108&quot;</span>, <span class="st">&quot;DP109&quot;</span>, <span class="st">&quot;DP110&quot;</span>, <span class="st">&quot;DP111&quot;</span>, <span class="st">&quot;DP112&quot;</span>, <span class="st">&quot;DP113&quot;</span>,</a>
<a class="sourceLine" id="cb2-32" title="32">    <span class="st">&quot;DP114&quot;</span>, <span class="st">&quot;DP115&quot;</span>, <span class="st">&quot;DP116&quot;</span>, <span class="st">&quot;DP117&quot;</span>, <span class="st">&quot;DP118&quot;</span>, <span class="st">&quot;DP119&quot;</span>,</a>
<a class="sourceLine" id="cb2-33" title="33">    <span class="st">&quot;DP120&quot;</span>, <span class="st">&quot;DP121&quot;</span>, <span class="st">&quot;DP122&quot;</span>, <span class="st">&quot;DP123&quot;</span>, <span class="st">&quot;DP124&quot;</span>, <span class="st">&quot;DP125&quot;</span>,</a>
<a class="sourceLine" id="cb2-34" title="34">    <span class="st">&quot;DP126&quot;</span>, <span class="st">&quot;DP127&quot;</span>, <span class="st">&quot;DP128&quot;</span>, <span class="st">&quot;DP129&quot;</span>, <span class="st">&quot;DP130&quot;</span>, <span class="st">&quot;DP131&quot;</span>,</a>
<a class="sourceLine" id="cb2-35" title="35">    <span class="st">&quot;DP132&quot;</span>, <span class="st">&quot;DP133&quot;</span>, <span class="st">&quot;DP134&quot;</span>, <span class="st">&quot;DP135&quot;</span>, <span class="st">&quot;DP136&quot;</span>, <span class="st">&quot;DP137&quot;</span>,</a>
<a class="sourceLine" id="cb2-36" title="36">    <span class="st">&quot;DP138&quot;</span>, <span class="st">&quot;DP139&quot;</span>, <span class="st">&quot;DP140&quot;</span>, <span class="st">&quot;DP141&quot;</span>, <span class="st">&quot;DP142&quot;</span>, <span class="st">&quot;DP143&quot;</span>,</a>
<a class="sourceLine" id="cb2-37" title="37">    <span class="st">&quot;DP144&quot;</span>, <span class="st">&quot;DP145&quot;</span>, <span class="st">&quot;DP146&quot;</span>, <span class="st">&quot;DP147&quot;</span>, <span class="st">&quot;DP148&quot;</span>, <span class="st">&quot;DP149&quot;</span>,</a>
<a class="sourceLine" id="cb2-38" title="38">    <span class="st">&quot;DP150&quot;</span>, <span class="st">&quot;DP151&quot;</span>, <span class="st">&quot;DP152&quot;</span>, <span class="st">&quot;DP153&quot;</span>, <span class="st">&quot;DP154&quot;</span>, <span class="st">&quot;DP155&quot;</span>,</a>
<a class="sourceLine" id="cb2-39" title="39">    <span class="st">&quot;DP156&quot;</span>, <span class="st">&quot;DP157&quot;</span>, <span class="st">&quot;DP158&quot;</span>, <span class="st">&quot;DP159&quot;</span>, <span class="st">&quot;DP160&quot;</span>, <span class="st">&quot;DP161&quot;</span>,</a>
<a class="sourceLine" id="cb2-40" title="40">    <span class="st">&quot;DP162&quot;</span>, <span class="st">&quot;DP163&quot;</span>, <span class="st">&quot;DP164&quot;</span>, <span class="st">&quot;DP165&quot;</span>, <span class="st">&quot;DP166&quot;</span>, <span class="st">&quot;DP167&quot;</span>,</a>
<a class="sourceLine" id="cb2-41" title="41">    <span class="st">&quot;DP168&quot;</span>, <span class="st">&quot;DP169&quot;</span>, <span class="st">&quot;DP170&quot;</span>, <span class="st">&quot;DP171&quot;</span>, <span class="st">&quot;DP172&quot;</span>, <span class="st">&quot;DP173&quot;</span>,</a>
<a class="sourceLine" id="cb2-42" title="42">    <span class="st">&quot;DP174&quot;</span>, <span class="st">&quot;DP175&quot;</span>, <span class="st">&quot;DP176&quot;</span>, <span class="st">&quot;DP177&quot;</span>, <span class="st">&quot;DP178&quot;</span>, <span class="st">&quot;DP179&quot;</span>};</a>
<a class="sourceLine" id="cb2-43" title="43"></a>
<a class="sourceLine" id="cb2-44" title="44"><span class="co">// lexicographic order ---------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-45" title="45"><span class="dt">bool</span> dominates(<span class="dt">int</span>[] e1, <span class="dt">int</span>[] e2){</a>
<a class="sourceLine" id="cb2-46" title="46">    <span class="cf">return</span> e2[<span class="dv">0</span>]&gt;e1[<span class="dv">0</span>] || (e2[<span class="dv">0</span>]==e1[<span class="dv">0</span>] &amp;&amp; e2[<span class="dv">1</span>]&gt;e1[<span class="dv">1</span>]);</a>
<a class="sourceLine" id="cb2-47" title="47">}</a>
<a class="sourceLine" id="cb2-48" title="48"></a>
<a class="sourceLine" id="cb2-49" title="49"><span class="co">// vertices --------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-50" title="50"><span class="dt">int</span> A = <span class="dv">8</span>;</a>
<a class="sourceLine" id="cb2-51" title="51"><span class="dt">int</span> B = <span class="dv">4</span>;</a>
<a class="sourceLine" id="cb2-52" title="52"></a>
<a class="sourceLine" id="cb2-53" title="53"><span class="kw">struct</span> quadruple {</a>
<a class="sourceLine" id="cb2-54" title="54">    real x;</a>
<a class="sourceLine" id="cb2-55" title="55">    real y;</a>
<a class="sourceLine" id="cb2-56" title="56">    real z;</a>
<a class="sourceLine" id="cb2-57" title="57">    real t;</a>
<a class="sourceLine" id="cb2-58" title="58">}</a>
<a class="sourceLine" id="cb2-59" title="59"></a>
<a class="sourceLine" id="cb2-60" title="60">real[][] poly1 = <span class="kw">new</span> real[A][<span class="dv">2</span>];</a>
<a class="sourceLine" id="cb2-61" title="61"><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</a>
<a class="sourceLine" id="cb2-62" title="62">    poly1[i][<span class="dv">0</span>] = cos(i/A*<span class="dv">2</span><span class="er">pi</span>);</a>
<a class="sourceLine" id="cb2-63" title="63">    poly1[i][<span class="dv">1</span>] = sin(i/A*<span class="dv">2</span><span class="er">pi</span>);</a>
<a class="sourceLine" id="cb2-64" title="64">}</a>
<a class="sourceLine" id="cb2-65" title="65">real[][] poly2 = <span class="kw">new</span> real[B][<span class="dv">2</span>];</a>
<a class="sourceLine" id="cb2-66" title="66"><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; B; ++i){</a>
<a class="sourceLine" id="cb2-67" title="67">    poly2[i][<span class="dv">0</span>] = cos(pi/B+i/B*<span class="dv">2</span><span class="er">pi</span>);</a>
<a class="sourceLine" id="cb2-68" title="68">    poly2[i][<span class="dv">1</span>] = sin(pi/B+i/B*<span class="dv">2</span><span class="er">pi</span>);</a>
<a class="sourceLine" id="cb2-69" title="69">}</a>
<a class="sourceLine" id="cb2-70" title="70">quadruple[][] vertices = <span class="kw">new</span> quadruple[A][B];</a>
<a class="sourceLine" id="cb2-71" title="71"><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</a>
<a class="sourceLine" id="cb2-72" title="72">    <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; B; ++j){</a>
<a class="sourceLine" id="cb2-73" title="73">        quadruple v;</a>
<a class="sourceLine" id="cb2-74" title="74">        v.x = poly1[i][<span class="dv">0</span>]; v.y = poly1[i][<span class="dv">1</span>]; </a>
<a class="sourceLine" id="cb2-75" title="75">        v.z = poly2[j][<span class="dv">0</span>]; v.t = poly2[j][<span class="dv">1</span>];</a>
<a class="sourceLine" id="cb2-76" title="76">        vertices[i][j] = v;</a>
<a class="sourceLine" id="cb2-77" title="77">    }</a>
<a class="sourceLine" id="cb2-78" title="78">}</a>
<a class="sourceLine" id="cb2-79" title="79"></a>
<a class="sourceLine" id="cb2-80" title="80"><span class="co">// edges -----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-81" title="81"><span class="dt">int</span>[][][] edges;</a>
<a class="sourceLine" id="cb2-82" title="82"><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</a>
<a class="sourceLine" id="cb2-83" title="83">    <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; B; ++j){</a>
<a class="sourceLine" id="cb2-84" title="84">        <span class="dt">int</span>[] e = {i,j};</a>
<a class="sourceLine" id="cb2-85" title="85">        <span class="dt">int</span>[] candidate = {i,(j-<span class="dv">1</span>)%B};</a>
<a class="sourceLine" id="cb2-86" title="86">        <span class="cf">if</span>(dominates(e,candidate)){</a>
<a class="sourceLine" id="cb2-87" title="87">            <span class="dt">int</span>[][] edge = {e,candidate}; </a>
<a class="sourceLine" id="cb2-88" title="88">            edges.push(edge);</a>
<a class="sourceLine" id="cb2-89" title="89">        }</a>
<a class="sourceLine" id="cb2-90" title="90">        <span class="dt">int</span>[] candidate = {i,(j+<span class="dv">1</span>)%B};</a>
<a class="sourceLine" id="cb2-91" title="91">        <span class="cf">if</span>(dominates(e,candidate)){</a>
<a class="sourceLine" id="cb2-92" title="92">            <span class="dt">int</span>[][] edge = {e,candidate}; </a>
<a class="sourceLine" id="cb2-93" title="93">            edges.push(edge);</a>
<a class="sourceLine" id="cb2-94" title="94">        }</a>
<a class="sourceLine" id="cb2-95" title="95">        <span class="dt">int</span>[] candidate = {(i-<span class="dv">1</span>)%A,j};</a>
<a class="sourceLine" id="cb2-96" title="96">        <span class="cf">if</span>(dominates(e,candidate)){</a>
<a class="sourceLine" id="cb2-97" title="97">            <span class="dt">int</span>[][] edge = {e,candidate}; </a>
<a class="sourceLine" id="cb2-98" title="98">            edges.push(edge);</a>
<a class="sourceLine" id="cb2-99" title="99">        }</a>
<a class="sourceLine" id="cb2-100" title="100">        <span class="dt">int</span>[] candidate = {(i+<span class="dv">1</span>)%A,j};</a>
<a class="sourceLine" id="cb2-101" title="101">        <span class="cf">if</span>(dominates(e,candidate)){</a>
<a class="sourceLine" id="cb2-102" title="102">            <span class="dt">int</span>[][] edge = {e,candidate}; </a>
<a class="sourceLine" id="cb2-103" title="103">            edges.push(edge);</a>
<a class="sourceLine" id="cb2-104" title="104">        }</a>
<a class="sourceLine" id="cb2-105" title="105">    }</a>
<a class="sourceLine" id="cb2-106" title="106">}</a>
<a class="sourceLine" id="cb2-107" title="107"></a>
<a class="sourceLine" id="cb2-108" title="108"><span class="co">// rotation in 4D space (right-isoclinic) --------------------------------------</span></a>
<a class="sourceLine" id="cb2-109" title="109">quadruple rotate4d(real alpha, real beta, real xi, quadruple vec){</a>
<a class="sourceLine" id="cb2-110" title="110">    real a = cos(xi);</a>
<a class="sourceLine" id="cb2-111" title="111">    real b = sin(alpha)*cos(beta)*sin(xi);</a>
<a class="sourceLine" id="cb2-112" title="112">    real c = sin(alpha)*sin(beta)*sin(xi);</a>
<a class="sourceLine" id="cb2-113" title="113">    real d = cos(alpha)*sin(xi);</a>
<a class="sourceLine" id="cb2-114" title="114">    real p = vec.x;</a>
<a class="sourceLine" id="cb2-115" title="115">    real q = vec.y;</a>
<a class="sourceLine" id="cb2-116" title="116">    real r = vec.z;</a>
<a class="sourceLine" id="cb2-117" title="117">    real s = vec.t;</a>
<a class="sourceLine" id="cb2-118" title="118">    quadruple out;</a>
<a class="sourceLine" id="cb2-119" title="119">    out.x = a*p - b*q - c*r - d*s;</a>
<a class="sourceLine" id="cb2-120" title="120">    out.y = a*q + b*p + c*s - d*r;</a>
<a class="sourceLine" id="cb2-121" title="121">    out.z = a*r - b*s + c*p + d*q;</a>
<a class="sourceLine" id="cb2-122" title="122">    out.t = a*s + b*r - c*q + d*p;</a>
<a class="sourceLine" id="cb2-123" title="123">    <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-124" title="124">}</a>
<a class="sourceLine" id="cb2-125" title="125"></a>
<a class="sourceLine" id="cb2-126" title="126"><span class="co">// stereographic projection ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-127" title="127">triple stereog(quadruple A, real r){</a>
<a class="sourceLine" id="cb2-128" title="128">    <span class="cf">return</span> (A.x, A.y, A.z) / (r - A.t);</a>
<a class="sourceLine" id="cb2-129" title="129">}</a>
<a class="sourceLine" id="cb2-130" title="130"></a>
<a class="sourceLine" id="cb2-131" title="131"><span class="co">// stereographic path ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-132" title="132">path3 stereoPath(quadruple A, quadruple B, real r, <span class="dt">int</span> n){</a>
<a class="sourceLine" id="cb2-133" title="133">    path3 out;</a>
<a class="sourceLine" id="cb2-134" title="134">    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt;= n; ++i){</a>
<a class="sourceLine" id="cb2-135" title="135">        real t = i/n;</a>
<a class="sourceLine" id="cb2-136" title="136">        quadruple M;</a>
<a class="sourceLine" id="cb2-137" title="137">        real x = (<span class="dv">1</span>-t)*A.x + t*B.x;</a>
<a class="sourceLine" id="cb2-138" title="138">        real y = (<span class="dv">1</span>-t)*A.y + t*B.y;</a>
<a class="sourceLine" id="cb2-139" title="139">        real z = (<span class="dv">1</span>-t)*A.z + t*B.z;</a>
<a class="sourceLine" id="cb2-140" title="140">        real t = (<span class="dv">1</span>-t)*A.t + t*B.t;</a>
<a class="sourceLine" id="cb2-141" title="141">        real lg = sqrt(x*x + y*y + z*z + t*t) / r;</a>
<a class="sourceLine" id="cb2-142" title="142">        M.x = x / lg; M.y = y / lg; M.z = z / lg; M.t = t / lg;</a>
<a class="sourceLine" id="cb2-143" title="143">        out = out .. stereog(M, r);</a>
<a class="sourceLine" id="cb2-144" title="144">    }</a>
<a class="sourceLine" id="cb2-145" title="145">    <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-146" title="146">}</a>
<a class="sourceLine" id="cb2-147" title="147"></a>
<a class="sourceLine" id="cb2-148" title="148"><span class="co">// section transformation ------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-149" title="149">transform T(path3 p3, real t, <span class="dt">int</span> n){</a>
<a class="sourceLine" id="cb2-150" title="150">    triple M = relpoint(p3, t/(n/<span class="dv">4</span>));</a>
<a class="sourceLine" id="cb2-151" title="151">    <span class="cf">return</span> scale(length(M)/<span class="dv">15</span>); </a>
<a class="sourceLine" id="cb2-152" title="152">}</a>
<a class="sourceLine" id="cb2-153" title="153"></a>
<a class="sourceLine" id="cb2-154" title="154"><span class="co">// bounding box ----------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-155" title="155">real f=<span class="dv">3</span>, h = <span class="fl">4.5</span>, g = <span class="fl">1.5</span>;</a>
<a class="sourceLine" id="cb2-156" title="156">path3 boundingbox = (-h,<span class="dv">0</span>,-f)--(-h,<span class="dv">0</span>,g)--(h,<span class="dv">0</span>,f)--(h,<span class="dv">0</span>,-g)--cycle;</a>
<a class="sourceLine" id="cb2-157" title="157"></a>
<a class="sourceLine" id="cb2-158" title="158"><span class="co">// draw the duoprism -----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-159" title="159"><span class="dt">int</span> n = <span class="dv">100</span>;</a>
<a class="sourceLine" id="cb2-160" title="160">real r = sqrt(<span class="dv">2</span>);</a>
<a class="sourceLine" id="cb2-161" title="161">real alpha = pi/<span class="dv">2</span>, beta = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb2-162" title="162"></a>
<a class="sourceLine" id="cb2-163" title="163"><span class="cf">for</span>(<span class="dt">int</span> file = <span class="dv">0</span>; file &lt; <span class="dv">180</span>; ++file){</a>
<a class="sourceLine" id="cb2-164" title="164">    real xi = <span class="dv">2</span>*file*pi/<span class="dv">180</span>;</a>
<a class="sourceLine" id="cb2-165" title="165">    picture pic;</a>
<a class="sourceLine" id="cb2-166" title="166">    <span class="co">// draw bounding box</span></a>
<a class="sourceLine" id="cb2-167" title="167">    draw(pic, boundingbox, rgb(<span class="st">&quot;363940ff&quot;</span>)+opacity(<span class="dv">0</span>));</a>
<a class="sourceLine" id="cb2-168" title="168">    <span class="co">// draw edges</span></a>
<a class="sourceLine" id="cb2-169" title="169">    <span class="cf">for</span>(<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; <span class="dv">2</span>*A*B; ++k){</a>
<a class="sourceLine" id="cb2-170" title="170">        quadruple A = vertices[edges[k][<span class="dv">0</span>][<span class="dv">0</span>]][edges[k][<span class="dv">0</span>][<span class="dv">1</span>]];</a>
<a class="sourceLine" id="cb2-171" title="171">        quadruple B = vertices[edges[k][<span class="dv">1</span>][<span class="dv">0</span>]][edges[k][<span class="dv">1</span>][<span class="dv">1</span>]];</a>
<a class="sourceLine" id="cb2-172" title="172">        path3 p3 = </a>
<a class="sourceLine" id="cb2-173" title="173">            stereoPath(rotate4d(alpha, beta, xi, A), </a>
<a class="sourceLine" id="cb2-174" title="174">                       rotate4d(alpha, beta, xi, B), r, n);</a>
<a class="sourceLine" id="cb2-175" title="175">        transform S(real t){</a>
<a class="sourceLine" id="cb2-176" title="176">            <span class="cf">return</span> T(p3, t, n);</a>
<a class="sourceLine" id="cb2-177" title="177">        }</a>
<a class="sourceLine" id="cb2-178" title="178">        draw(pic, tube(p3, unitcircle, S), rgb(<span class="dv">139</span>,<span class="dv">0</span>,<span class="dv">139</span>), </a>
<a class="sourceLine" id="cb2-179" title="179">                                render(compression=Low, merge=<span class="kw">true</span>));</a>
<a class="sourceLine" id="cb2-180" title="180">    }</a>
<a class="sourceLine" id="cb2-181" title="181">    <span class="co">// draw vertices</span></a>
<a class="sourceLine" id="cb2-182" title="182">    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; A; ++i){</a>
<a class="sourceLine" id="cb2-183" title="183">        <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; B; ++j){</a>
<a class="sourceLine" id="cb2-184" title="184">            triple Asg = </a>
<a class="sourceLine" id="cb2-185" title="185">                stereog(rotate4d(alpha, beta, xi, vertices[i][j]), r);</a>
<a class="sourceLine" id="cb2-186" title="186">            draw(pic, shift(Asg)*scale3(length(Asg)/<span class="dv">10</span>)*unitsphere, purple);</a>
<a class="sourceLine" id="cb2-187" title="187">        }</a>
<a class="sourceLine" id="cb2-188" title="188">    }</a>
<a class="sourceLine" id="cb2-189" title="189">    <span class="co">// add and save picture</span></a>
<a class="sourceLine" id="cb2-190" title="190">    add(pic);</a>
<a class="sourceLine" id="cb2-191" title="191">    shipout(files[file], bbox(rgb(<span class="st">&quot;363940ff&quot;</span>), FillDraw(rgb(<span class="st">&quot;363940ff&quot;</span>))));</a>
<a class="sourceLine" id="cb2-192" title="192">    erase();</a>
<a class="sourceLine" id="cb2-193" title="193">}</a>
<a class="sourceLine" id="cb2-194" title="194"></a>
<a class="sourceLine" id="cb2-195" title="195"><span class="co">/* to do the animation</span></a>
<a class="sourceLine" id="cb2-196" title="196"><span class="co">gs -dSAFER -dBATCH -dNOPAUSE -dEPSCrop -sDEVICE=png16m -r600 -sOutputFile=zpic%03d.png DP*.eps</span></a>
<a class="sourceLine" id="cb2-197" title="197"><span class="co">mogrify -resize 512x zpic*.png</span></a>
<a class="sourceLine" id="cb2-198" title="198"><span class="co">gifski --fps 12 zpic*.png -o DuoprismStereo.gif</span></a>
<a class="sourceLine" id="cb2-199" title="199"><span class="co">*/</span></a></code></pre></div>
<p><img src="./figures/DuoprismStereo_Asy.gif" /></p>
<h1 id="with-pov-ray">With POV-Ray</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode povray"><code class="sourceCode povray"><a class="sourceLine" id="cb3-1" title="1"><span class="ot">#version</span> <span class="fl">3.7</span>;</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">global_settings</span> { <span class="kw">assumed_gamma</span> <span class="fl">1</span> }</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="ot">#include</span> <span class="st">&quot;colors.inc&quot;</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="ot">#include</span> <span class="st">&quot;textures.inc&quot;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">/* camera */</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">camera</span> {</a>
<a class="sourceLine" id="cb3-8" title="8">  <span class="kw">location</span> &lt;-<span class="fl">11</span>, <span class="fl">7</span>, <span class="fl">-32</span>&gt;</a>
<a class="sourceLine" id="cb3-9" title="9">  <span class="kw">look_at</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="kw">angle</span> <span class="fl">45</span></a>
<a class="sourceLine" id="cb3-11" title="11">  <span class="kw">right</span> <span class="kw">x</span>*<span class="kw">image_width</span>/<span class="kw">image_height</span></a>
<a class="sourceLine" id="cb3-12" title="12">}</a>
<a class="sourceLine" id="cb3-13" title="13"></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">// sun -------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="kw">light_source</span> {&lt; <span class="fl">4000</span>,<span class="fl">6000</span>,-<span class="fl">6000</span>&gt; <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">0.9</span>}           <span class="co">// sun </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="kw">light_source</span> {&lt;-<span class="fl">11</span>, <span class="fl">7</span>,-<span class="fl">32</span>&gt;  <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">1</span>&gt;*<span class="fl">0.1</span> <span class="kw">shadowless</span>} <span class="co">// flash</span></a>
<a class="sourceLine" id="cb3-17" title="17"></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">// sky -------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="kw">plane</span> {</a>
<a class="sourceLine" id="cb3-20" title="20">  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">1</span> <span class="kw">hollow</span>  </a>
<a class="sourceLine" id="cb3-21" title="21">  <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb3-22" title="22">    <span class="kw">pigment</span> { </a>
<a class="sourceLine" id="cb3-23" title="23">      <span class="kw">bozo</span> <span class="kw">turbulence</span> <span class="fl">1.3</span></a>
<a class="sourceLine" id="cb3-24" title="24">      <span class="kw">color_map</span> {</a>
<a class="sourceLine" id="cb3-25" title="25">        [<span class="fl">0.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</a>
<a class="sourceLine" id="cb3-26" title="26">        [<span class="fl">0.75</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</a>
<a class="sourceLine" id="cb3-27" title="27">        [<span class="fl">0.83</span> <span class="kw">rgb</span> &lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;]</a>
<a class="sourceLine" id="cb3-28" title="28">        [<span class="fl">0.95</span> <span class="kw">rgb</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;]</a>
<a class="sourceLine" id="cb3-29" title="29">        [<span class="fl">1.0</span> <span class="kw">rgb</span> &lt;<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>&gt;]</a>
<a class="sourceLine" id="cb3-30" title="30">      }</a>
<a class="sourceLine" id="cb3-31" title="31">      <span class="kw">scale</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">2.5</span>  <span class="kw">translate</span>&lt; <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span>&gt;</a>
<a class="sourceLine" id="cb3-32" title="32">    }</a>
<a class="sourceLine" id="cb3-33" title="33">    <span class="kw">finish</span> {</a>
<a class="sourceLine" id="cb3-34" title="34">      <span class="kw">ambient</span> <span class="fl">1</span> </a>
<a class="sourceLine" id="cb3-35" title="35">      <span class="kw">diffuse</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb3-36" title="36">    } </a>
<a class="sourceLine" id="cb3-37" title="37">  }      </a>
<a class="sourceLine" id="cb3-38" title="38">  <span class="kw">scale</span> <span class="fl">10000</span></a>
<a class="sourceLine" id="cb3-39" title="39">}</a>
<a class="sourceLine" id="cb3-40" title="40"></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">// fog on the ground -----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="kw">fog</span> {</a>
<a class="sourceLine" id="cb3-43" title="43">  <span class="kw">fog_type</span>   <span class="fl">2</span></a>
<a class="sourceLine" id="cb3-44" title="44">  <span class="kw">distance</span>   <span class="fl">50</span></a>
<a class="sourceLine" id="cb3-45" title="45">  <span class="kw">color</span>      Gray10  </a>
<a class="sourceLine" id="cb3-46" title="46">  <span class="kw">fog_offset</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb3-47" title="47">  <span class="kw">fog_alt</span>    <span class="fl">1.5</span></a>
<a class="sourceLine" id="cb3-48" title="48">  <span class="kw">turbulence</span> <span class="fl">1.8</span></a>
<a class="sourceLine" id="cb3-49" title="49">}</a>
<a class="sourceLine" id="cb3-50" title="50"></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="co">// ground ----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb3-52" title="52"><span class="kw">plane</span> {</a>
<a class="sourceLine" id="cb3-53" title="53">  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">0</span> </a>
<a class="sourceLine" id="cb3-54" title="54">  <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb3-55" title="55">    <span class="kw">pigment</span> { <span class="kw">color</span> <span class="kw">rgb</span> &lt;<span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.73</span>&gt;*<span class="fl">0.35</span> }</a>
<a class="sourceLine" id="cb3-56" title="56">    <span class="kw">normal</span> { <span class="kw">bumps</span> <span class="fl">2</span> <span class="kw">scale</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;*<span class="fl">0.5</span> <span class="kw">turbulence</span> <span class="fl">0.5</span> } </a>
<a class="sourceLine" id="cb3-57" title="57">    <span class="kw">finish</span> { <span class="kw">phong</span> <span class="fl">0.1</span> }</a>
<a class="sourceLine" id="cb3-58" title="58">  } </a>
<a class="sourceLine" id="cb3-59" title="59">} </a>
<a class="sourceLine" id="cb3-60" title="60"></a>
<a class="sourceLine" id="cb3-61" title="61"></a>
<a class="sourceLine" id="cb3-62" title="62"><span class="co">/* ----- vertices ----- */</span></a>
<a class="sourceLine" id="cb3-63" title="63"><span class="kw">#declare A </span>= <span class="fl">4</span>;</a>
<a class="sourceLine" id="cb3-64" title="64"><span class="kw">#declare B </span>= <span class="fl">30</span>;</a>
<a class="sourceLine" id="cb3-65" title="65"></a>
<a class="sourceLine" id="cb3-66" title="66"><span class="kw">#declare poly1 </span>= <span class="kw">array</span>[A];</a>
<a class="sourceLine" id="cb3-67" title="67">#for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-68" title="68">  <span class="kw">#declare poly1</span>[i] = <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">cos</span>(i/A*<span class="fl">2</span>*<span class="fl">pi</span>), <span class="kw">sin</span>(i/A*<span class="fl">2</span>*<span class="fl">pi</span>)};</a>
<a class="sourceLine" id="cb3-69" title="69"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-70" title="70"><span class="kw">#declare poly2 </span>= <span class="kw">array</span>[B];</a>
<a class="sourceLine" id="cb3-71" title="71">#for(i,<span class="fl">0</span>,B<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-72" title="72">  <span class="kw">#declare poly2</span>[i] = <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">cos</span>(i/B*<span class="fl">2</span>*<span class="fl">pi</span>), <span class="kw">sin</span>(i/B*<span class="fl">2</span>*<span class="fl">pi</span>)};</a>
<a class="sourceLine" id="cb3-73" title="73"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-74" title="74"><span class="kw">#declare vertices </span>= <span class="kw">array</span>[A][B];</a>
<a class="sourceLine" id="cb3-75" title="75">#for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-76" title="76">  #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-77" title="77">    <span class="kw">#declare vertices</span>[i][j] = </a>
<a class="sourceLine" id="cb3-78" title="78">      &lt; poly1[i][<span class="fl">0</span>], poly1[i][<span class="fl">1</span>], poly2[j][<span class="fl">0</span>], poly2[j][<span class="fl">1</span>] &gt;;</a>
<a class="sourceLine" id="cb3-79" title="79">  <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-80" title="80"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-81" title="81"></a>
<a class="sourceLine" id="cb3-82" title="82"><span class="co">/* ----- edges ----- */</span></a>
<a class="sourceLine" id="cb3-83" title="83"><span class="kw">#macro dominates</span>(e1,e2)</a>
<a class="sourceLine" id="cb3-84" title="84">  (e2[<span class="fl">0</span>]&gt;e1[<span class="fl">0</span>]) | ((e2[<span class="fl">0</span>]=e1[<span class="fl">0</span>]) &amp; (e2[<span class="fl">1</span>]&gt;e1[<span class="fl">1</span>]))</a>
<a class="sourceLine" id="cb3-85" title="85"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-86" title="86"><span class="kw">#declare nedges </span>= <span class="fl">2</span>*A*B;</a>
<a class="sourceLine" id="cb3-87" title="87"><span class="kw">#declare edges </span>= <span class="kw">array</span>[nedges];</a>
<a class="sourceLine" id="cb3-88" title="88"><span class="kw">#declare k</span>=<span class="fl">0</span>;</a>
<a class="sourceLine" id="cb3-89" title="89">#for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-90" title="90">  #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-91" title="91">    <span class="kw">#local e </span>= <span class="kw">array</span>[<span class="fl">2</span>] {i,j};</a>
<a class="sourceLine" id="cb3-92" title="92">    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {i,<span class="kw">mod</span>(<span class="kw">mod</span>(j<span class="fl">-1</span>,B)+B,B)};</a>
<a class="sourceLine" id="cb3-93" title="93">    <span class="ot">#if</span>(dominates(e,candidate))</a>
<a class="sourceLine" id="cb3-94" title="94">      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</a>
<a class="sourceLine" id="cb3-95" title="95">      <span class="kw">#declare edges</span>[k] = edge;</a>
<a class="sourceLine" id="cb3-96" title="96">      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</a>
<a class="sourceLine" id="cb3-97" title="97">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-98" title="98">    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {i,<span class="kw">mod</span>(<span class="kw">mod</span>(j+<span class="fl">1</span>,B)+B,B)};</a>
<a class="sourceLine" id="cb3-99" title="99">    <span class="ot">#if</span>(dominates(e,candidate))</a>
<a class="sourceLine" id="cb3-100" title="100">      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</a>
<a class="sourceLine" id="cb3-101" title="101">      <span class="kw">#declare edges</span>[k] = edge;</a>
<a class="sourceLine" id="cb3-102" title="102">      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</a>
<a class="sourceLine" id="cb3-103" title="103">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-104" title="104">    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">mod</span>(<span class="kw">mod</span>(i<span class="fl">-1</span>,A)+A,A),j};</a>
<a class="sourceLine" id="cb3-105" title="105">    <span class="ot">#if</span>(dominates(e,candidate))</a>
<a class="sourceLine" id="cb3-106" title="106">      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</a>
<a class="sourceLine" id="cb3-107" title="107">      <span class="kw">#declare edges</span>[k] = edge;</a>
<a class="sourceLine" id="cb3-108" title="108">      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</a>
<a class="sourceLine" id="cb3-109" title="109">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-110" title="110">    <span class="kw">#local candidate </span>= <span class="kw">array</span>[<span class="fl">2</span>] {<span class="kw">mod</span>(<span class="kw">mod</span>(i+<span class="fl">1</span>,A)+A,A),j};</a>
<a class="sourceLine" id="cb3-111" title="111">    <span class="ot">#if</span>(dominates(e,candidate))</a>
<a class="sourceLine" id="cb3-112" title="112">      <span class="kw">#local edge </span>= <span class="kw">array</span>[<span class="fl">2</span>] {e,candidate};</a>
<a class="sourceLine" id="cb3-113" title="113">      <span class="kw">#declare edges</span>[k] = edge;</a>
<a class="sourceLine" id="cb3-114" title="114">      <span class="kw">#declare k </span>= k+<span class="fl">1</span>;</a>
<a class="sourceLine" id="cb3-115" title="115">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-116" title="116">  <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-117" title="117"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-118" title="118"></a>
<a class="sourceLine" id="cb3-119" title="119"><span class="co">/* rotation in 4D space */</span></a>
<a class="sourceLine" id="cb3-120" title="120"><span class="kw">#macro rotate4d</span>(theta,phi,xi,vec)</a>
<a class="sourceLine" id="cb3-121" title="121">  <span class="kw">#local a </span>= <span class="kw">cos</span>(xi);</a>
<a class="sourceLine" id="cb3-122" title="122">  <span class="kw">#local b </span>= <span class="kw">sin</span>(theta)*<span class="kw">cos</span>(phi)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb3-123" title="123">  <span class="kw">#local c </span>= <span class="kw">sin</span>(theta)*<span class="kw">sin</span>(phi)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb3-124" title="124">  <span class="kw">#local d </span>= <span class="kw">cos</span>(theta)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb3-125" title="125">  <span class="kw">#local p </span>= vec.<span class="kw">x</span>;</a>
<a class="sourceLine" id="cb3-126" title="126">  <span class="kw">#local q </span>= vec.<span class="kw">y</span>;</a>
<a class="sourceLine" id="cb3-127" title="127">  <span class="kw">#local r </span>= vec.<span class="kw">z</span>;</a>
<a class="sourceLine" id="cb3-128" title="128">  <span class="kw">#local s </span>= vec.<span class="kw">t</span>;</a>
<a class="sourceLine" id="cb3-129" title="129">  &lt; a*p - b*q - c*r - d*s</a>
<a class="sourceLine" id="cb3-130" title="130">  , a*q + b*p + c*s - d*r</a>
<a class="sourceLine" id="cb3-131" title="131">  , a*r - b*s + c*p + d*q</a>
<a class="sourceLine" id="cb3-132" title="132">  , a*s + b*r - c*q + d*p &gt;</a>
<a class="sourceLine" id="cb3-133" title="133"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-134" title="134"></a>
<a class="sourceLine" id="cb3-135" title="135"><span class="co">/* stereographic projection */</span></a>
<a class="sourceLine" id="cb3-136" title="136"><span class="kw">#macro StereographicProjection</span>(q)</a>
<a class="sourceLine" id="cb3-137" title="137">  &lt;q.<span class="kw">x</span>,q.<span class="kw">y</span>,q.<span class="kw">z</span>&gt; / (<span class="kw">sqrt</span>(<span class="fl">2</span>)-q.<span class="kw">t</span>)</a>
<a class="sourceLine" id="cb3-138" title="138"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-139" title="139"></a>
<a class="sourceLine" id="cb3-140" title="140"><span class="co">/* rotated and projected vertices */</span></a>
<a class="sourceLine" id="cb3-141" title="141"><span class="kw">#macro ProjectedVertices</span>(theta,phi,xi)</a>
<a class="sourceLine" id="cb3-142" title="142">  <span class="kw">#local out </span>= <span class="kw">array</span>[A][B];</a>
<a class="sourceLine" id="cb3-143" title="143">  #for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-144" title="144">    #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-145" title="145">      <span class="kw">#local out</span>[i][j] = StereographicProjection(</a>
<a class="sourceLine" id="cb3-146" title="146">                            rotate4d(theta,phi,xi,vertices[i][j])</a>
<a class="sourceLine" id="cb3-147" title="147">                          );</a>
<a class="sourceLine" id="cb3-148" title="148">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-149" title="149">  <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-150" title="150">  out</a>
<a class="sourceLine" id="cb3-151" title="151"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-152" title="152"></a>
<a class="sourceLine" id="cb3-153" title="153"><span class="co">/* macro spherical segment */</span></a>
<a class="sourceLine" id="cb3-154" title="154"><span class="kw">#macro vlength4</span>(P)</a>
<a class="sourceLine" id="cb3-155" title="155">  <span class="kw">sqrt</span>(P.<span class="kw">x</span>*P.<span class="kw">x</span> + P.<span class="kw">y</span>*P.<span class="kw">y</span> + P.<span class="kw">z</span>*P.<span class="kw">z</span> + P.<span class="kw">t</span>*P.<span class="kw">t</span>)</a>
<a class="sourceLine" id="cb3-156" title="156"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-157" title="157"></a>
<a class="sourceLine" id="cb3-158" title="158"><span class="kw">#macro sphericalSegment</span>(P, Q, n)</a>
<a class="sourceLine" id="cb3-159" title="159">  <span class="kw">#local out </span>= <span class="kw">array</span>[n+<span class="fl">1</span>];</a>
<a class="sourceLine" id="cb3-160" title="160">  #for(i, <span class="fl">0</span>, n)</a>
<a class="sourceLine" id="cb3-161" title="161">    <span class="kw">#local pt </span>= P + (i/n)*(Q-P);</a>
<a class="sourceLine" id="cb3-162" title="162">    <span class="kw">#local out</span>[i] = <span class="kw">sqrt</span>(<span class="fl">2</span>)/vlength4(pt) * pt;</a>
<a class="sourceLine" id="cb3-163" title="163">  <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-164" title="164">  out</a>
<a class="sourceLine" id="cb3-165" title="165"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-166" title="166"></a>
<a class="sourceLine" id="cb3-167" title="167"><span class="co">/* macro to draw an edge */</span></a>
<a class="sourceLine" id="cb3-168" title="168"><span class="kw">#macro Edge</span>(verts, v1, v2, theta, phi, xi, Tex)</a>
<a class="sourceLine" id="cb3-169" title="169">  <span class="kw">#local P </span>= verts[v1[<span class="fl">0</span>]][v1[<span class="fl">1</span>]];</a>
<a class="sourceLine" id="cb3-170" title="170">  <span class="kw">#local Q </span>= verts[v2[<span class="fl">0</span>]][v2[<span class="fl">1</span>]];</a>
<a class="sourceLine" id="cb3-171" title="171">  <span class="kw">#local PQ </span>= sphericalSegment(P, Q, <span class="fl">100</span>);</a>
<a class="sourceLine" id="cb3-172" title="172">  <span class="kw">sphere_sweep</span> {</a>
<a class="sourceLine" id="cb3-173" title="173">    <span class="kw">b_spline</span> <span class="fl">101</span></a>
<a class="sourceLine" id="cb3-174" title="174">    #for(k,<span class="fl">0</span>,<span class="fl">100</span>)</a>
<a class="sourceLine" id="cb3-175" title="175">      <span class="kw">#local O </span>= </a>
<a class="sourceLine" id="cb3-176" title="176">        StereographicProjection(rotate4d(theta,phi,xi,PQ[k]));</a>
<a class="sourceLine" id="cb3-177" title="177">      O <span class="kw">vlength</span>(O)/<span class="fl">15</span></a>
<a class="sourceLine" id="cb3-178" title="178">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-179" title="179">    <span class="kw">texture</span> { Tex }</a>
<a class="sourceLine" id="cb3-180" title="180">  }</a>
<a class="sourceLine" id="cb3-181" title="181"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-182" title="182"></a>
<a class="sourceLine" id="cb3-183" title="183"><span class="co">/*-----------------------------------------*/</span></a>
<a class="sourceLine" id="cb3-184" title="184"><span class="co">/*-----      draw the duoprism       ------*/</span></a>
<a class="sourceLine" id="cb3-185" title="185"><span class="co">/*-----------------------------------------*/</span></a>
<a class="sourceLine" id="cb3-186" title="186"><span class="kw">#declare theta </span>= <span class="fl">pi</span>/<span class="fl">2</span>;</a>
<a class="sourceLine" id="cb3-187" title="187"><span class="kw">#declare phi </span>= <span class="fl">0</span>;</a>
<a class="sourceLine" id="cb3-188" title="188"><span class="kw">#declare xi </span>= <span class="fl">2</span>*<span class="kw">frame_number</span>*<span class="fl">pi</span>/<span class="fl">180</span>; </a>
<a class="sourceLine" id="cb3-189" title="189"></a>
<a class="sourceLine" id="cb3-190" title="190"><span class="kw">#declare vs </span>= ProjectedVertices(theta, phi, xi);</a>
<a class="sourceLine" id="cb3-191" title="191"></a>
<a class="sourceLine" id="cb3-192" title="192"><span class="kw">#declare edgeTexture </span>= <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb3-193" title="193">  <span class="kw">pigment</span> { <span class="kw">color</span> Red }</a>
<a class="sourceLine" id="cb3-194" title="194">  <span class="kw">finish</span> {</a>
<a class="sourceLine" id="cb3-195" title="195">    <span class="kw">ambient</span> <span class="fl">.1</span></a>
<a class="sourceLine" id="cb3-196" title="196">    <span class="kw">diffuse</span> <span class="fl">.9</span></a>
<a class="sourceLine" id="cb3-197" title="197">    <span class="kw">reflection</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb3-198" title="198">    <span class="kw">specular</span> <span class="fl">1</span></a>
<a class="sourceLine" id="cb3-199" title="199">    <span class="kw">metallic</span></a>
<a class="sourceLine" id="cb3-200" title="200">  }</a>
<a class="sourceLine" id="cb3-201" title="201">};</a>
<a class="sourceLine" id="cb3-202" title="202"></a>
<a class="sourceLine" id="cb3-203" title="203"><span class="kw">object</span> {</a>
<a class="sourceLine" id="cb3-204" title="204">  <span class="kw">union</span> {</a>
<a class="sourceLine" id="cb3-205" title="205">    <span class="co">/* draw edges */</span></a>
<a class="sourceLine" id="cb3-206" title="206">    #for(i, <span class="fl">0</span>, <span class="fl">2</span>*A*B<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-207" title="207">      Edge(vertices, edges[i][<span class="fl">0</span>], edges[i][<span class="fl">1</span>], </a>
<a class="sourceLine" id="cb3-208" title="208">                    theta, phi, xi, edgeTexture)</a>
<a class="sourceLine" id="cb3-209" title="209">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-210" title="210">    <span class="co">/* draw vertices */</span></a>
<a class="sourceLine" id="cb3-211" title="211">    #for(i,<span class="fl">0</span>,A<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-212" title="212">      #for(j,<span class="fl">0</span>,B<span class="fl">-1</span>)</a>
<a class="sourceLine" id="cb3-213" title="213">        <span class="kw">sphere</span> {</a>
<a class="sourceLine" id="cb3-214" title="214">          vs[i][j], <span class="kw">vlength</span>(vs[i][j])/<span class="fl">10</span></a>
<a class="sourceLine" id="cb3-215" title="215">          <span class="kw">texture</span> { edgeTexture }</a>
<a class="sourceLine" id="cb3-216" title="216">        }</a>
<a class="sourceLine" id="cb3-217" title="217">      <span class="ot">#end</span></a>
<a class="sourceLine" id="cb3-218" title="218">    <span class="ot">#end</span>  </a>
<a class="sourceLine" id="cb3-219" title="219">  }</a>
<a class="sourceLine" id="cb3-220" title="220">  <span class="kw">translate</span> &lt;-<span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">-15</span>&gt;</a>
<a class="sourceLine" id="cb3-221" title="221">  <span class="kw">scale</span> <span class="fl">0.8</span></a>
<a class="sourceLine" id="cb3-222" title="222">}</a>
<a class="sourceLine" id="cb3-223" title="223"></a>
<a class="sourceLine" id="cb3-224" title="224"><span class="co">/* ini file </span></a>
<a class="sourceLine" id="cb3-225" title="225"><span class="co">Width = 512</span></a>
<a class="sourceLine" id="cb3-226" title="226"><span class="co">Height = 512</span></a>
<a class="sourceLine" id="cb3-227" title="227"><span class="co">Antialias = On</span></a>
<a class="sourceLine" id="cb3-228" title="228"><span class="co">Antialias_Threshold = 0.3</span></a>
<a class="sourceLine" id="cb3-229" title="229"><span class="co">Input_File_Name = DuoprismStereographic.pov</span></a>
<a class="sourceLine" id="cb3-230" title="230"><span class="co">Initial_Clock = 0</span></a>
<a class="sourceLine" id="cb3-231" title="231"><span class="co">Final_Clock = 1</span></a>
<a class="sourceLine" id="cb3-232" title="232"><span class="co">Initial_Frame = 0</span></a>
<a class="sourceLine" id="cb3-233" title="233"><span class="co">Final_Frame = 179</span></a>
<a class="sourceLine" id="cb3-234" title="234"><span class="co">Subset_Start_Frame = 0</span></a>
<a class="sourceLine" id="cb3-235" title="235"><span class="co">Cyclic_Animation = on</span></a>
<a class="sourceLine" id="cb3-236" title="236"><span class="co">*/</span></a></code></pre></div>
<p><img src="./figures/DuoprismStereo_POVRAY.gif" /></p>
<p><br /></p>
<p>Here is another one. This is a hexagonal duoprism with a cell colored in red.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode povray"><code class="sourceCode povray"><a class="sourceLine" id="cb4-1" title="1"><span class="ot">#version</span> <span class="fl">3.7</span>;</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">global_settings</span> { <span class="kw">assumed_gamma</span> <span class="fl">1</span> } </a>
<a class="sourceLine" id="cb4-3" title="3"><span class="ot">#include</span> <span class="st">&quot;colors.inc&quot;</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="ot">#include</span> <span class="st">&quot;textures.inc&quot;</span></a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">// camera ----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">camera</span> {</a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="kw">location</span> &lt;<span class="fl">0</span>, <span class="fl">0</span>,-<span class="fl">10</span>&gt;</a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="kw">look_at</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="kw">angle</span> <span class="fl">45</span></a>
<a class="sourceLine" id="cb4-11" title="11">  <span class="kw">right</span> <span class="kw">x</span>*<span class="kw">image_width</span>/<span class="kw">image_height</span></a>
<a class="sourceLine" id="cb4-12" title="12">}</a>
<a class="sourceLine" id="cb4-13" title="13"></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">// light sources ---------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="kw">light_source</span> { &lt;<span class="fl">0</span>,<span class="fl">0</span>,-<span class="fl">100</span>&gt; White <span class="kw">shadowless</span> } </a>
<a class="sourceLine" id="cb4-16" title="16"><span class="kw">light_source</span> { &lt;<span class="fl">100</span>,<span class="fl">0</span>,-<span class="fl">100</span>&gt; White <span class="kw">shadowless</span> } </a>
<a class="sourceLine" id="cb4-17" title="17"></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">// moon ------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="kw">light_source</span> { </a>
<a class="sourceLine" id="cb4-20" title="20">  &lt;-<span class="fl">1000</span>, <span class="fl">800</span>, <span class="fl">3000</span>&gt; </a>
<a class="sourceLine" id="cb4-21" title="21">  <span class="kw">color</span> White</a>
<a class="sourceLine" id="cb4-22" title="22">  <span class="kw">shadowless</span></a>
<a class="sourceLine" id="cb4-23" title="23">  <span class="kw">looks_like</span> { </a>
<a class="sourceLine" id="cb4-24" title="24">    <span class="kw">sphere</span> { </a>
<a class="sourceLine" id="cb4-25" title="25">      &lt;<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>&gt;, <span class="fl">300</span> </a>
<a class="sourceLine" id="cb4-26" title="26">      <span class="kw">texture</span> { </a>
<a class="sourceLine" id="cb4-27" title="27">        <span class="kw">pigment</span> { </a>
<a class="sourceLine" id="cb4-28" title="28">          <span class="kw">color</span> Yellow</a>
<a class="sourceLine" id="cb4-29" title="29">        }</a>
<a class="sourceLine" id="cb4-30" title="30">        <span class="kw">normal</span> { </a>
<a class="sourceLine" id="cb4-31" title="31">          <span class="kw">bumps</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb4-32" title="32">          <span class="kw">scale</span> <span class="fl">50</span></a>
<a class="sourceLine" id="cb4-33" title="33">        }</a>
<a class="sourceLine" id="cb4-34" title="34">        <span class="kw">finish</span> { </a>
<a class="sourceLine" id="cb4-35" title="35">          <span class="kw">emission</span> <span class="fl">0.8</span>   </a>
<a class="sourceLine" id="cb4-36" title="36">          <span class="kw">diffuse</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb4-37" title="37">          <span class="kw">phong</span> <span class="fl">1</span></a>
<a class="sourceLine" id="cb4-38" title="38">        }                                        </a>
<a class="sourceLine" id="cb4-39" title="39">      } </a>
<a class="sourceLine" id="cb4-40" title="40">    } </a>
<a class="sourceLine" id="cb4-41" title="41">  } </a>
<a class="sourceLine" id="cb4-42" title="42">} </a>
<a class="sourceLine" id="cb4-43" title="43"></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">// sky -------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="kw">plane</span> { </a>
<a class="sourceLine" id="cb4-46" title="46">  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">1</span> <span class="kw">hollow</span>  </a>
<a class="sourceLine" id="cb4-47" title="47">  <span class="kw">texture</span> { </a>
<a class="sourceLine" id="cb4-48" title="48">    <span class="kw">pigment</span> { </a>
<a class="sourceLine" id="cb4-49" title="49">      <span class="kw">color</span> <span class="kw">rgb</span> &lt;<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.2</span>&gt; </a>
<a class="sourceLine" id="cb4-50" title="50">    }</a>
<a class="sourceLine" id="cb4-51" title="51">    <span class="kw">finish</span> { </a>
<a class="sourceLine" id="cb4-52" title="52">      <span class="kw">emission</span> <span class="fl">0.5</span> </a>
<a class="sourceLine" id="cb4-53" title="53">      <span class="kw">diffuse</span> <span class="fl">0.5</span> </a>
<a class="sourceLine" id="cb4-54" title="54">    } </a>
<a class="sourceLine" id="cb4-55" title="55">  }  </a>
<a class="sourceLine" id="cb4-56" title="56">  <span class="kw">scale</span> <span class="fl">10000</span></a>
<a class="sourceLine" id="cb4-57" title="57">}</a>
<a class="sourceLine" id="cb4-58" title="58"></a>
<a class="sourceLine" id="cb4-59" title="59"><span class="co">// the clouds ------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-60" title="60"><span class="kw">plane</span> { </a>
<a class="sourceLine" id="cb4-61" title="61">  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;,<span class="fl">1</span> <span class="kw">hollow</span>  </a>
<a class="sourceLine" id="cb4-62" title="62">  <span class="kw">texture</span> { </a>
<a class="sourceLine" id="cb4-63" title="63">    <span class="kw">pigment</span> { </a>
<a class="sourceLine" id="cb4-64" title="64">      <span class="kw">bozo</span> <span class="kw">turbulence</span> <span class="fl">1.3</span></a>
<a class="sourceLine" id="cb4-65" title="65">      <span class="kw">color_map</span> { </a>
<a class="sourceLine" id="cb4-66" title="66">        [<span class="fl">0.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</a>
<a class="sourceLine" id="cb4-67" title="67">        [<span class="fl">0.75</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</a>
<a class="sourceLine" id="cb4-68" title="68">        [<span class="fl">0.83</span> <span class="kw">rgb</span> &lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;              ]</a>
<a class="sourceLine" id="cb4-69" title="69">        [<span class="fl">0.95</span> <span class="kw">rgb</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;     ]</a>
<a class="sourceLine" id="cb4-70" title="70">        [<span class="fl">1.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>&gt;        ]</a>
<a class="sourceLine" id="cb4-71" title="71">      }</a>
<a class="sourceLine" id="cb4-72" title="72">      <span class="kw">scale</span> <span class="fl">2.5</span></a>
<a class="sourceLine" id="cb4-73" title="73">      <span class="kw">translate</span> &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;</a>
<a class="sourceLine" id="cb4-74" title="74">    }</a>
<a class="sourceLine" id="cb4-75" title="75">    <span class="kw">finish</span> { </a>
<a class="sourceLine" id="cb4-76" title="76">      <span class="kw">emission</span> <span class="fl">0.25</span> </a>
<a class="sourceLine" id="cb4-77" title="77">      <span class="kw">diffuse</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb4-78" title="78">    } </a>
<a class="sourceLine" id="cb4-79" title="79">  }      </a>
<a class="sourceLine" id="cb4-80" title="80">  <span class="kw">scale</span> <span class="fl">5000</span></a>
<a class="sourceLine" id="cb4-81" title="81">}</a>
<a class="sourceLine" id="cb4-82" title="82"></a>
<a class="sourceLine" id="cb4-83" title="83"><span class="co">// fog on the ground -----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-84" title="84"><span class="kw">fog</span> { </a>
<a class="sourceLine" id="cb4-85" title="85">  <span class="kw">fog_type</span>   <span class="fl">2</span></a>
<a class="sourceLine" id="cb4-86" title="86">  <span class="kw">distance</span>   <span class="fl">50</span></a>
<a class="sourceLine" id="cb4-87" title="87">  <span class="kw">color</span>      Gray50  </a>
<a class="sourceLine" id="cb4-88" title="88">  <span class="kw">fog_offset</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb4-89" title="89">  <span class="kw">fog_alt</span>    <span class="fl">1.5</span></a>
<a class="sourceLine" id="cb4-90" title="90">  <span class="kw">turbulence</span> <span class="fl">1.8</span></a>
<a class="sourceLine" id="cb4-91" title="91">}</a>
<a class="sourceLine" id="cb4-92" title="92"></a>
<a class="sourceLine" id="cb4-93" title="93"><span class="co">// sea -------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-94" title="94"><span class="kw">plane</span> { </a>
<a class="sourceLine" id="cb4-95" title="95">  &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">-1</span> <span class="kw">hollow</span></a>
<a class="sourceLine" id="cb4-96" title="96">  <span class="kw">texture</span>{</a>
<a class="sourceLine" id="cb4-97" title="97">    <span class="kw">pigment</span>{</a>
<a class="sourceLine" id="cb4-98" title="98">      <span class="kw">rgb</span> &lt;.<span class="fl">098</span>,.<span class="fl">098</span>,.<span class="fl">439</span>&gt;</a>
<a class="sourceLine" id="cb4-99" title="99">    }</a>
<a class="sourceLine" id="cb4-100" title="100">    <span class="kw">finish</span> {</a>
<a class="sourceLine" id="cb4-101" title="101">      <span class="kw">ambient</span> <span class="fl">0.15</span></a>
<a class="sourceLine" id="cb4-102" title="102">      <span class="kw">diffuse</span> <span class="fl">0.55</span></a>
<a class="sourceLine" id="cb4-103" title="103">      <span class="kw">brilliance</span> <span class="fl">6.0</span></a>
<a class="sourceLine" id="cb4-104" title="104">      <span class="kw">phong</span> <span class="fl">0.8</span></a>
<a class="sourceLine" id="cb4-105" title="105">      <span class="kw">phong_size</span> <span class="fl">120</span></a>
<a class="sourceLine" id="cb4-106" title="106">      <span class="kw">reflection</span> <span class="fl">0.2</span></a>
<a class="sourceLine" id="cb4-107" title="107">    }</a>
<a class="sourceLine" id="cb4-108" title="108">    <span class="kw">normal</span> { </a>
<a class="sourceLine" id="cb4-109" title="109">      <span class="kw">bumps</span> <span class="fl">0.95</span></a>
<a class="sourceLine" id="cb4-110" title="110">      <span class="kw">turbulence</span> <span class="fl">.05</span> </a>
<a class="sourceLine" id="cb4-111" title="111">      <span class="kw">scale</span> &lt;<span class="fl">1</span>,<span class="fl">0.25</span>,<span class="fl">1</span>&gt; </a>
<a class="sourceLine" id="cb4-112" title="112">    }</a>
<a class="sourceLine" id="cb4-113" title="113">  }</a>
<a class="sourceLine" id="cb4-114" title="114">}</a>
<a class="sourceLine" id="cb4-115" title="115"></a>
<a class="sourceLine" id="cb4-116" title="116"><span class="co">// vertices --------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-117" title="117"><span class="kw">#declare a </span>= <span class="kw">sqrt</span>(<span class="fl">3</span>) / <span class="fl">2</span>;</a>
<a class="sourceLine" id="cb4-118" title="118"><span class="kw">#declare vertices </span>= <span class="kw">array</span>[<span class="fl">36</span>]</a>
<a class="sourceLine" id="cb4-119" title="119">  {</a>
<a class="sourceLine" id="cb4-120" title="120">    &lt;a, <span class="fl">0.5</span>, a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-121" title="121">    &lt;a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-122" title="122">    &lt;a, <span class="fl">0.5</span>, -a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-123" title="123">    &lt;a, <span class="fl">0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-124" title="124">    &lt;a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-125" title="125">    &lt;a, <span class="fl">0.5</span>, a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-126" title="126">    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-127" title="127">    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-128" title="128">    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, -a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-129" title="129">    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, -a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-130" title="130">    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-131" title="131">    &lt;<span class="fl">0.0</span>, <span class="fl">1.0</span>, a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-132" title="132">    &lt;-a, <span class="fl">0.5</span>, a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-133" title="133">    &lt;-a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-134" title="134">    &lt;-a, <span class="fl">0.5</span>, -a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-135" title="135">    &lt;-a, <span class="fl">0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-136" title="136">    &lt;-a, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-137" title="137">    &lt;-a, <span class="fl">0.5</span>, a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-138" title="138">    &lt;-a, <span class="fl">-0.5</span>, a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-139" title="139">    &lt;-a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-140" title="140">    &lt;-a, <span class="fl">-0.5</span>, -a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-141" title="141">    &lt;-a, <span class="fl">-0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-142" title="142">    &lt;-a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-143" title="143">    &lt;-a, <span class="fl">-0.5</span>, a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-144" title="144">    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-145" title="145">    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-146" title="146">    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, -a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-147" title="147">    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, -a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-148" title="148">    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-149" title="149">    &lt;<span class="fl">0.0</span>, <span class="fl">-1.0</span>, a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-150" title="150">    &lt;a, <span class="fl">-0.5</span>, a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-151" title="151">    &lt;a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-152" title="152">    &lt;a, <span class="fl">-0.5</span>, -a, <span class="fl">0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-153" title="153">    &lt;a, <span class="fl">-0.5</span>, -a, <span class="fl">-0.5</span>&gt;,</a>
<a class="sourceLine" id="cb4-154" title="154">    &lt;a, <span class="fl">-0.5</span>, <span class="fl">0.0</span>, <span class="fl">-1.0</span>&gt;,</a>
<a class="sourceLine" id="cb4-155" title="155">    &lt;a, <span class="fl">-0.5</span>, a, <span class="fl">-0.5</span>&gt;</a>
<a class="sourceLine" id="cb4-156" title="156">  };</a>
<a class="sourceLine" id="cb4-157" title="157"><span class="kw">#declare facetVertices </span>= <span class="kw">array</span>[<span class="fl">12</span>] {<span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">30</span>,<span class="fl">11</span>,<span class="fl">35</span>,<span class="fl">12</span>,<span class="fl">17</span>,<span class="fl">18</span>,<span class="fl">23</span>,<span class="fl">24</span>,<span class="fl">29</span>};</a>
<a class="sourceLine" id="cb4-158" title="158"><span class="kw">#declare otherVertices </span>= <span class="kw">array</span>[<span class="fl">24</span>] </a>
<a class="sourceLine" id="cb4-159" title="159">  {<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">8</span>,</a>
<a class="sourceLine" id="cb4-160" title="160">  <span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span>,</a>
<a class="sourceLine" id="cb4-161" title="161">  <span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">21</span>,<span class="fl">22</span>,<span class="fl">25</span>,<span class="fl">26</span>,</a>
<a class="sourceLine" id="cb4-162" title="162">  <span class="fl">27</span>,<span class="fl">28</span>,<span class="fl">31</span>,<span class="fl">32</span>,<span class="fl">33</span>,<span class="fl">34</span>};</a>
<a class="sourceLine" id="cb4-163" title="163"></a>
<a class="sourceLine" id="cb4-164" title="164"><span class="co">// edges -------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-165" title="165"><span class="kw">#declare facetEdges </span>= <span class="kw">array</span>[<span class="fl">18</span>][<span class="fl">2</span>]</a>
<a class="sourceLine" id="cb4-166" title="166">  {</a>
<a class="sourceLine" id="cb4-167" title="167">    {<span class="fl">0</span>, <span class="fl">5</span>},</a>
<a class="sourceLine" id="cb4-168" title="168">    {<span class="fl">0</span>, <span class="fl">6</span>},</a>
<a class="sourceLine" id="cb4-169" title="169">    {<span class="fl">0</span>, <span class="fl">30</span>},</a>
<a class="sourceLine" id="cb4-170" title="170">    {<span class="fl">5</span>, <span class="fl">11</span>},</a>
<a class="sourceLine" id="cb4-171" title="171">    {<span class="fl">5</span>, <span class="fl">35</span>},</a>
<a class="sourceLine" id="cb4-172" title="172">    {<span class="fl">6</span>, <span class="fl">11</span>},</a>
<a class="sourceLine" id="cb4-173" title="173">    {<span class="fl">6</span>, <span class="fl">12</span>},</a>
<a class="sourceLine" id="cb4-174" title="174">    {<span class="fl">11</span>, <span class="fl">17</span>},</a>
<a class="sourceLine" id="cb4-175" title="175">    {<span class="fl">12</span>, <span class="fl">17</span>},</a>
<a class="sourceLine" id="cb4-176" title="176">    {<span class="fl">12</span>, <span class="fl">18</span>},</a>
<a class="sourceLine" id="cb4-177" title="177">    {<span class="fl">17</span>, <span class="fl">23</span>},</a>
<a class="sourceLine" id="cb4-178" title="178">    {<span class="fl">18</span>, <span class="fl">23</span>},</a>
<a class="sourceLine" id="cb4-179" title="179">    {<span class="fl">18</span>, <span class="fl">24</span>},</a>
<a class="sourceLine" id="cb4-180" title="180">    {<span class="fl">23</span>, <span class="fl">29</span>},</a>
<a class="sourceLine" id="cb4-181" title="181">    {<span class="fl">24</span>, <span class="fl">29</span>},</a>
<a class="sourceLine" id="cb4-182" title="182">    {<span class="fl">24</span>, <span class="fl">30</span>},</a>
<a class="sourceLine" id="cb4-183" title="183">    {<span class="fl">29</span>, <span class="fl">35</span>},</a>
<a class="sourceLine" id="cb4-184" title="184">    {<span class="fl">30</span>, <span class="fl">35</span>}</a>
<a class="sourceLine" id="cb4-185" title="185">  };</a>
<a class="sourceLine" id="cb4-186" title="186"><span class="kw">#declare otherEdges </span>= <span class="kw">array</span>[<span class="fl">54</span>][<span class="fl">2</span>]</a>
<a class="sourceLine" id="cb4-187" title="187">  {</a>
<a class="sourceLine" id="cb4-188" title="188">    {<span class="fl">0</span>, <span class="fl">1</span>},</a>
<a class="sourceLine" id="cb4-189" title="189">    {<span class="fl">1</span>, <span class="fl">2</span>},</a>
<a class="sourceLine" id="cb4-190" title="190">    {<span class="fl">1</span>, <span class="fl">7</span>},</a>
<a class="sourceLine" id="cb4-191" title="191">    {<span class="fl">1</span>, <span class="fl">31</span>},</a>
<a class="sourceLine" id="cb4-192" title="192">    {<span class="fl">2</span>, <span class="fl">3</span>},</a>
<a class="sourceLine" id="cb4-193" title="193">    {<span class="fl">2</span>, <span class="fl">8</span>},</a>
<a class="sourceLine" id="cb4-194" title="194">    {<span class="fl">2</span>, <span class="fl">32</span>},</a>
<a class="sourceLine" id="cb4-195" title="195">    {<span class="fl">3</span>, <span class="fl">4</span>},</a>
<a class="sourceLine" id="cb4-196" title="196">    {<span class="fl">3</span>, <span class="fl">9</span>},</a>
<a class="sourceLine" id="cb4-197" title="197">    {<span class="fl">3</span>, <span class="fl">33</span>},</a>
<a class="sourceLine" id="cb4-198" title="198">    {<span class="fl">4</span>, <span class="fl">5</span>},</a>
<a class="sourceLine" id="cb4-199" title="199">    {<span class="fl">4</span>, <span class="fl">10</span>},</a>
<a class="sourceLine" id="cb4-200" title="200">    {<span class="fl">4</span>, <span class="fl">34</span>},</a>
<a class="sourceLine" id="cb4-201" title="201">    {<span class="fl">6</span>, <span class="fl">7</span>},</a>
<a class="sourceLine" id="cb4-202" title="202">    {<span class="fl">7</span>, <span class="fl">8</span>},</a>
<a class="sourceLine" id="cb4-203" title="203">    {<span class="fl">7</span>, <span class="fl">13</span>},</a>
<a class="sourceLine" id="cb4-204" title="204">    {<span class="fl">8</span>, <span class="fl">9</span>},</a>
<a class="sourceLine" id="cb4-205" title="205">    {<span class="fl">8</span>, <span class="fl">14</span>},</a>
<a class="sourceLine" id="cb4-206" title="206">    {<span class="fl">9</span>, <span class="fl">10</span>},</a>
<a class="sourceLine" id="cb4-207" title="207">    {<span class="fl">9</span>, <span class="fl">15</span>},</a>
<a class="sourceLine" id="cb4-208" title="208">    {<span class="fl">10</span>, <span class="fl">11</span>},</a>
<a class="sourceLine" id="cb4-209" title="209">    {<span class="fl">10</span>, <span class="fl">16</span>},</a>
<a class="sourceLine" id="cb4-210" title="210">    {<span class="fl">12</span>, <span class="fl">13</span>},</a>
<a class="sourceLine" id="cb4-211" title="211">    {<span class="fl">13</span>, <span class="fl">14</span>},</a>
<a class="sourceLine" id="cb4-212" title="212">    {<span class="fl">13</span>, <span class="fl">19</span>},</a>
<a class="sourceLine" id="cb4-213" title="213">    {<span class="fl">14</span>, <span class="fl">15</span>},</a>
<a class="sourceLine" id="cb4-214" title="214">    {<span class="fl">14</span>, <span class="fl">20</span>},</a>
<a class="sourceLine" id="cb4-215" title="215">    {<span class="fl">15</span>, <span class="fl">16</span>},</a>
<a class="sourceLine" id="cb4-216" title="216">    {<span class="fl">15</span>, <span class="fl">21</span>},</a>
<a class="sourceLine" id="cb4-217" title="217">    {<span class="fl">16</span>, <span class="fl">17</span>},</a>
<a class="sourceLine" id="cb4-218" title="218">    {<span class="fl">16</span>, <span class="fl">22</span>},</a>
<a class="sourceLine" id="cb4-219" title="219">    {<span class="fl">18</span>, <span class="fl">19</span>},</a>
<a class="sourceLine" id="cb4-220" title="220">    {<span class="fl">19</span>, <span class="fl">20</span>},</a>
<a class="sourceLine" id="cb4-221" title="221">    {<span class="fl">19</span>, <span class="fl">25</span>},</a>
<a class="sourceLine" id="cb4-222" title="222">    {<span class="fl">20</span>, <span class="fl">21</span>},</a>
<a class="sourceLine" id="cb4-223" title="223">    {<span class="fl">20</span>, <span class="fl">26</span>},</a>
<a class="sourceLine" id="cb4-224" title="224">    {<span class="fl">21</span>, <span class="fl">22</span>},</a>
<a class="sourceLine" id="cb4-225" title="225">    {<span class="fl">21</span>, <span class="fl">27</span>},</a>
<a class="sourceLine" id="cb4-226" title="226">    {<span class="fl">22</span>, <span class="fl">23</span>},</a>
<a class="sourceLine" id="cb4-227" title="227">    {<span class="fl">22</span>, <span class="fl">28</span>},</a>
<a class="sourceLine" id="cb4-228" title="228">    {<span class="fl">24</span>, <span class="fl">25</span>},</a>
<a class="sourceLine" id="cb4-229" title="229">    {<span class="fl">25</span>, <span class="fl">26</span>},</a>
<a class="sourceLine" id="cb4-230" title="230">    {<span class="fl">25</span>, <span class="fl">31</span>},</a>
<a class="sourceLine" id="cb4-231" title="231">    {<span class="fl">26</span>, <span class="fl">27</span>},</a>
<a class="sourceLine" id="cb4-232" title="232">    {<span class="fl">26</span>, <span class="fl">32</span>},</a>
<a class="sourceLine" id="cb4-233" title="233">    {<span class="fl">27</span>, <span class="fl">28</span>},</a>
<a class="sourceLine" id="cb4-234" title="234">    {<span class="fl">27</span>, <span class="fl">33</span>},</a>
<a class="sourceLine" id="cb4-235" title="235">    {<span class="fl">28</span>, <span class="fl">29</span>},</a>
<a class="sourceLine" id="cb4-236" title="236">    {<span class="fl">28</span>, <span class="fl">34</span>},</a>
<a class="sourceLine" id="cb4-237" title="237">    {<span class="fl">30</span>, <span class="fl">31</span>},</a>
<a class="sourceLine" id="cb4-238" title="238">    {<span class="fl">31</span>, <span class="fl">32</span>},</a>
<a class="sourceLine" id="cb4-239" title="239">    {<span class="fl">32</span>, <span class="fl">33</span>},</a>
<a class="sourceLine" id="cb4-240" title="240">    {<span class="fl">33</span>, <span class="fl">34</span>},</a>
<a class="sourceLine" id="cb4-241" title="241">    {<span class="fl">34</span>, <span class="fl">35</span>}</a>
<a class="sourceLine" id="cb4-242" title="242">  };</a>
<a class="sourceLine" id="cb4-243" title="243"></a>
<a class="sourceLine" id="cb4-244" title="244"><span class="co">// macros ----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-245" title="245"><span class="kw">#macro vlength4</span>(P)</a>
<a class="sourceLine" id="cb4-246" title="246">  <span class="kw">sqrt</span>(P.<span class="kw">x</span>*P.<span class="kw">x</span> + P.<span class="kw">y</span>*P.<span class="kw">y</span> + P.<span class="kw">z</span>*P.<span class="kw">z</span> + P.<span class="kw">t</span>*P.<span class="kw">t</span>)</a>
<a class="sourceLine" id="cb4-247" title="247"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-248" title="248"></a>
<a class="sourceLine" id="cb4-249" title="249"><span class="kw">#macro sphericalSegment</span>(P, Q, n)</a>
<a class="sourceLine" id="cb4-250" title="250">  <span class="kw">#local out </span>= <span class="kw">array</span>[n+<span class="fl">1</span>];</a>
<a class="sourceLine" id="cb4-251" title="251">  #for(i, <span class="fl">0</span>, n)</a>
<a class="sourceLine" id="cb4-252" title="252">    <span class="kw">#local pt </span>= P + (i/n)*(Q-P);</a>
<a class="sourceLine" id="cb4-253" title="253">    <span class="kw">#local out</span>[i] = <span class="kw">sqrt</span>(<span class="fl">2</span>)/vlength4(pt) * pt;</a>
<a class="sourceLine" id="cb4-254" title="254">  <span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-255" title="255">  out</a>
<a class="sourceLine" id="cb4-256" title="256"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-257" title="257"></a>
<a class="sourceLine" id="cb4-258" title="258"><span class="kw">#macro rotate4d</span>(theta,phi,xi,vec)</a>
<a class="sourceLine" id="cb4-259" title="259">  <span class="kw">#local a </span>= <span class="kw">cos</span>(xi);</a>
<a class="sourceLine" id="cb4-260" title="260">  <span class="kw">#local b </span>= <span class="kw">sin</span>(theta)*<span class="kw">cos</span>(phi)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb4-261" title="261">  <span class="kw">#local c </span>= <span class="kw">sin</span>(theta)*<span class="kw">sin</span>(phi)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb4-262" title="262">  <span class="kw">#local d </span>= <span class="kw">cos</span>(theta)*<span class="kw">sin</span>(xi);</a>
<a class="sourceLine" id="cb4-263" title="263">  <span class="kw">#local p </span>= vec.<span class="kw">x</span>;</a>
<a class="sourceLine" id="cb4-264" title="264">  <span class="kw">#local q </span>= vec.<span class="kw">y</span>;</a>
<a class="sourceLine" id="cb4-265" title="265">  <span class="kw">#local r </span>= vec.<span class="kw">z</span>;</a>
<a class="sourceLine" id="cb4-266" title="266">  <span class="kw">#local s </span>= vec.<span class="kw">t</span>;</a>
<a class="sourceLine" id="cb4-267" title="267">  &lt; a*p - b*q - c*r - d*s</a>
<a class="sourceLine" id="cb4-268" title="268">  , a*q + b*p + c*s - d*r</a>
<a class="sourceLine" id="cb4-269" title="269">  , a*r - b*s + c*p + d*q</a>
<a class="sourceLine" id="cb4-270" title="270">  , a*s + b*r - c*q + d*p &gt;</a>
<a class="sourceLine" id="cb4-271" title="271"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-272" title="272"></a>
<a class="sourceLine" id="cb4-273" title="273"><span class="kw">#macro StereographicProjection</span>(q) </a>
<a class="sourceLine" id="cb4-274" title="274">  <span class="kw">acos</span>(q.<span class="kw">t</span>/<span class="kw">sqrt</span>(<span class="fl">2</span>))/<span class="kw">sqrt</span>(<span class="fl">2</span>-q.<span class="kw">t</span>*q.<span class="kw">t</span>) * &lt;q.<span class="kw">x</span>,q.<span class="kw">y</span>,q.<span class="kw">z</span>&gt;</a>
<a class="sourceLine" id="cb4-275" title="275"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-276" title="276"></a>
<a class="sourceLine" id="cb4-277" title="277"><span class="kw">#macro ProjectedFacetVertices</span>(theta, phi, xi)</a>
<a class="sourceLine" id="cb4-278" title="278">  <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="fl">12</span>];</a>
<a class="sourceLine" id="cb4-279" title="279">  #for(i, <span class="fl">0</span>, <span class="fl">11</span>)</a>
<a class="sourceLine" id="cb4-280" title="280">    <span class="kw">#local out</span>[i] = </a>
<a class="sourceLine" id="cb4-281" title="281">      StereographicProjection(</a>
<a class="sourceLine" id="cb4-282" title="282">        rotate4d(theta, phi, xi, vertices[facetVertices[i]])</a>
<a class="sourceLine" id="cb4-283" title="283">      );</a>
<a class="sourceLine" id="cb4-284" title="284">  <span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-285" title="285">  out</a>
<a class="sourceLine" id="cb4-286" title="286"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-287" title="287"></a>
<a class="sourceLine" id="cb4-288" title="288"><span class="kw">#macro ProjectedOtherVertices</span>(theta, phi, xi)</a>
<a class="sourceLine" id="cb4-289" title="289">  <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="fl">24</span>];</a>
<a class="sourceLine" id="cb4-290" title="290">  #for(i, <span class="fl">0</span>, <span class="fl">23</span>)</a>
<a class="sourceLine" id="cb4-291" title="291">    <span class="kw">#local out</span>[i] = </a>
<a class="sourceLine" id="cb4-292" title="292">      StereographicProjection(</a>
<a class="sourceLine" id="cb4-293" title="293">        rotate4d(theta, phi, xi, vertices[otherVertices[i]])</a>
<a class="sourceLine" id="cb4-294" title="294">      );</a>
<a class="sourceLine" id="cb4-295" title="295">  <span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-296" title="296">  out</a>
<a class="sourceLine" id="cb4-297" title="297"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-298" title="298"></a>
<a class="sourceLine" id="cb4-299" title="299"><span class="co">// texture ---------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-300" title="300"><span class="kw">#declare edgeTexture1 </span>= </a>
<a class="sourceLine" id="cb4-301" title="301">  <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb4-302" title="302">    New_Penny</a>
<a class="sourceLine" id="cb4-303" title="303">    <span class="kw">finish</span> {</a>
<a class="sourceLine" id="cb4-304" title="304">      <span class="kw">ambient</span> <span class="fl">0.01</span></a>
<a class="sourceLine" id="cb4-305" title="305">      <span class="kw">diffuse</span> <span class="fl">2</span></a>
<a class="sourceLine" id="cb4-306" title="306">      <span class="kw">reflection</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb4-307" title="307">      <span class="kw">brilliance</span> <span class="fl">8</span></a>
<a class="sourceLine" id="cb4-308" title="308">      <span class="kw">specular</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb4-309" title="309">      <span class="kw">roughness</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb4-310" title="310">    }</a>
<a class="sourceLine" id="cb4-311" title="311">  };</a>
<a class="sourceLine" id="cb4-312" title="312"></a>
<a class="sourceLine" id="cb4-313" title="313"><span class="kw">#declare edgeTexture2 </span>= </a>
<a class="sourceLine" id="cb4-314" title="314">  <span class="kw">texture</span> {</a>
<a class="sourceLine" id="cb4-315" title="315">    <span class="kw">pigment</span> { Red }</a>
<a class="sourceLine" id="cb4-316" title="316">    <span class="kw">finish</span> {</a>
<a class="sourceLine" id="cb4-317" title="317">      <span class="kw">ambient</span> <span class="fl">0.01</span></a>
<a class="sourceLine" id="cb4-318" title="318">      <span class="kw">diffuse</span> <span class="fl">2</span></a>
<a class="sourceLine" id="cb4-319" title="319">      <span class="kw">reflection</span> <span class="fl">0</span></a>
<a class="sourceLine" id="cb4-320" title="320">      <span class="kw">brilliance</span> <span class="fl">8</span></a>
<a class="sourceLine" id="cb4-321" title="321">      <span class="kw">specular</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb4-322" title="322">      <span class="kw">roughness</span> <span class="fl">0.1</span></a>
<a class="sourceLine" id="cb4-323" title="323">    }</a>
<a class="sourceLine" id="cb4-324" title="324">  };</a>
<a class="sourceLine" id="cb4-325" title="325"></a>
<a class="sourceLine" id="cb4-326" title="326"><span class="co">// draw an edge ----------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-327" title="327"><span class="kw">#macro Edge</span>(verts, v1, v2, theta, phi, xi, Tex)</a>
<a class="sourceLine" id="cb4-328" title="328">  <span class="kw">#local P </span>= verts[v1];</a>
<a class="sourceLine" id="cb4-329" title="329">  <span class="kw">#local Q </span>= verts[v2];</a>
<a class="sourceLine" id="cb4-330" title="330">  <span class="kw">#local PQ </span>= sphericalSegment(P, Q, <span class="fl">100</span>);</a>
<a class="sourceLine" id="cb4-331" title="331">  <span class="kw">sphere_sweep</span> {</a>
<a class="sourceLine" id="cb4-332" title="332">    <span class="kw">b_spline</span> <span class="fl">101</span></a>
<a class="sourceLine" id="cb4-333" title="333">    #for(k,<span class="fl">0</span>,<span class="fl">100</span>)</a>
<a class="sourceLine" id="cb4-334" title="334">      <span class="kw">#local O </span>= StereographicProjection(rotate4d(theta,phi,xi,PQ[k]));</a>
<a class="sourceLine" id="cb4-335" title="335">      O <span class="kw">vlength</span>(O)/<span class="fl">20</span></a>
<a class="sourceLine" id="cb4-336" title="336">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-337" title="337">    <span class="kw">texture</span> { </a>
<a class="sourceLine" id="cb4-338" title="338">        Tex</a>
<a class="sourceLine" id="cb4-339" title="339">    }</a>
<a class="sourceLine" id="cb4-340" title="340">  }</a>
<a class="sourceLine" id="cb4-341" title="341"><span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-342" title="342"></a>
<a class="sourceLine" id="cb4-343" title="343"><span class="co">// draw ------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-344" title="344"><span class="kw">#declare theta </span>= <span class="fl">pi</span>/<span class="fl">2</span>;</a>
<a class="sourceLine" id="cb4-345" title="345"><span class="kw">#declare phi </span>= <span class="fl">0</span>;</a>
<a class="sourceLine" id="cb4-346" title="346"><span class="kw">#declare xi </span>= <span class="fl">2</span>*<span class="kw">frame_number</span>*<span class="fl">pi</span>/<span class="fl">180</span>;</a>
<a class="sourceLine" id="cb4-347" title="347"><span class="kw">#declare vsFacet </span>= ProjectedFacetVertices(theta, phi, xi);</a>
<a class="sourceLine" id="cb4-348" title="348"><span class="kw">#declare vsOther </span>= ProjectedOtherVertices(theta, phi, xi);</a>
<a class="sourceLine" id="cb4-349" title="349"><span class="kw">object</span> {</a>
<a class="sourceLine" id="cb4-350" title="350">  <span class="kw">union</span> {</a>
<a class="sourceLine" id="cb4-351" title="351">    #for(i, <span class="fl">0</span>, <span class="fl">53</span>)</a>
<a class="sourceLine" id="cb4-352" title="352">      Edge(vertices, otherEdges[i][<span class="fl">0</span>], otherEdges[i][<span class="fl">1</span>], </a>
<a class="sourceLine" id="cb4-353" title="353">                            theta, phi, xi, edgeTexture1)</a>
<a class="sourceLine" id="cb4-354" title="354">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-355" title="355">    #for(i, <span class="fl">0</span>, <span class="fl">17</span>)</a>
<a class="sourceLine" id="cb4-356" title="356">      Edge(vertices, facetEdges[i][<span class="fl">0</span>], facetEdges[i][<span class="fl">1</span>], </a>
<a class="sourceLine" id="cb4-357" title="357">                            theta, phi, xi, edgeTexture2)</a>
<a class="sourceLine" id="cb4-358" title="358">    <span class="ot">#end</span></a>
<a class="sourceLine" id="cb4-359" title="359">    #for(i, <span class="fl">0</span>, <span class="fl">23</span>)</a>
<a class="sourceLine" id="cb4-360" title="360">      <span class="kw">sphere</span> {</a>
<a class="sourceLine" id="cb4-361" title="361">        vsOther[i], <span class="kw">vlength</span>(vsOther[i])/<span class="fl">10</span></a>
<a class="sourceLine" id="cb4-362" title="362">        <span class="kw">texture</span> { edgeTexture1 }</a>
<a class="sourceLine" id="cb4-363" title="363">      }</a>
<a class="sourceLine" id="cb4-364" title="364">    <span class="ot">#end</span>  </a>
<a class="sourceLine" id="cb4-365" title="365">    #for(i, <span class="fl">0</span>, <span class="fl">11</span>)</a>
<a class="sourceLine" id="cb4-366" title="366">      <span class="kw">sphere</span> {</a>
<a class="sourceLine" id="cb4-367" title="367">        vsFacet[i], <span class="kw">vlength</span>(vsFacet[i])/<span class="fl">10</span></a>
<a class="sourceLine" id="cb4-368" title="368">        <span class="kw">texture</span> { edgeTexture2 }</a>
<a class="sourceLine" id="cb4-369" title="369">      }</a>
<a class="sourceLine" id="cb4-370" title="370">    <span class="ot">#end</span>  </a>
<a class="sourceLine" id="cb4-371" title="371">  }</a>
<a class="sourceLine" id="cb4-372" title="372">  <span class="kw">scale</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb4-373" title="373">  <span class="kw">rotate</span> &lt;<span class="fl">60</span>, <span class="fl">0</span>, <span class="fl">0</span>&gt;</a>
<a class="sourceLine" id="cb4-374" title="374">  <span class="kw">translate</span> &lt;<span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">-2</span>&gt;</a>
<a class="sourceLine" id="cb4-375" title="375">}</a></code></pre></div>
<p><img src="./figures/DuoprismStereo_POVRAY2.gif" /></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->

  <!-- Google Prettify -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script> -->
  <script src="../libraries/highlighters/prettify/js/lang-r.js"></script>
  <script>
    var pres = document.getElementsByTagName("pre");
    for (var i = 0; i < pres.length; ++i) {
      
        pres[i].className = pres[i].className + " prettyprint linenums";
      
    }
    prettyPrint();
  </script> 


</html>