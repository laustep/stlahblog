<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Stereographic truncated tesseract</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:25px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:21px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Stereographic truncated tesseract</h1> 
          <div class="info">
    Posted on December 16, 2019
    
        by St√©phane Laurent
    
</div>
<div class="info">
    
    Tags: <a title="All pages tagged 'R'." href="../tags/R.html">R</a>, <a title="All pages tagged 'asymptote'." href="../tags/asymptote.html">asymptote</a>, <a title="All pages tagged 'povray'." href="../tags/povray.html">povray</a>, <a title="All pages tagged 'rgl'." href="../tags/rgl.html">rgl</a>, <a title="All pages tagged 'graphics'." href="../tags/graphics.html">graphics</a>, <a title="All pages tagged 'geometry'." href="../tags/geometry.html">geometry</a>
    
</div>

<ul>
<li><a href="#the-stereographic-truncated-tesseract">The stereographic truncated tesseract</a></li>
<li><a href="#drawing-with-rgl-r">Drawing with rgl (R)</a></li>
<li><a href="#drawing-with-asymptote">Drawing with Asymptote</a></li>
<li><a href="#drawing-with-pov-ray">Drawing with POV-Ray</a></li>
</ul>
<h1 id="the-stereographic-truncated-tesseract">The stereographic truncated tesseract</h1>
<p>We show how to draw a stereographic truncated tesseract with rgl (R), Asymptote, and POV-Ray.</p>
<p>The truncated tesseract is a uniform polychoron. Among its cells, there are sixteen tetrahedra, and we fill the faces of these tetrahedra.</p>
<p>Using Asymptote and POV-Ray, we include a 4D rotation to animate the figure.</p>
<p>We call it <em>stereographic</em> because we map each edge to the 3-sphere before applying the stereographic projection.</p>
<h1 id="drawing-with-rgl-r">Drawing with rgl (R)</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(rgl)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(cxhull)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(abind)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># vertices #####################################################################</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>sqr2p1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>vertices &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, sqr2p1),</span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-15"><a href="#cb1-15"></a>  <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, sqr2p1, sqr2p1, sqr2p1),</span>
<span id="cb1-16"><a href="#cb1-16"></a>  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-18"><a href="#cb1-18"></a>  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1, sqr2p1),</span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-23"><a href="#cb1-23"></a>  <span class="kw">c</span>(<span class="dv">1</span>, sqr2p1, sqr2p1, sqr2p1),</span>
<span id="cb1-24"><a href="#cb1-24"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-25"><a href="#cb1-25"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-26"><a href="#cb1-26"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-27"><a href="#cb1-27"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1, sqr2p1),</span>
<span id="cb1-28"><a href="#cb1-28"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-29"><a href="#cb1-29"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-30"><a href="#cb1-30"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-31"><a href="#cb1-31"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1, sqr2p1),</span>
<span id="cb1-32"><a href="#cb1-32"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-33"><a href="#cb1-33"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-34"><a href="#cb1-34"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-35"><a href="#cb1-35"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">-1</span>, sqr2p1, sqr2p1),</span>
<span id="cb1-36"><a href="#cb1-36"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-37"><a href="#cb1-37"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1, sqr2p1),</span>
<span id="cb1-38"><a href="#cb1-38"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, sqr2p1, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-39"><a href="#cb1-39"></a>  <span class="kw">c</span>(sqr2p1, <span class="dv">1</span>, sqr2p1, sqr2p1),</span>
<span id="cb1-40"><a href="#cb1-40"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-41"><a href="#cb1-41"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1),</span>
<span id="cb1-42"><a href="#cb1-42"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-43"><a href="#cb1-43"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1),</span>
<span id="cb1-44"><a href="#cb1-44"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-45"><a href="#cb1-45"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>, sqr2p1),</span>
<span id="cb1-46"><a href="#cb1-46"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-47"><a href="#cb1-47"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>, sqr2p1),</span>
<span id="cb1-48"><a href="#cb1-48"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-49"><a href="#cb1-49"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>, sqr2p1),</span>
<span id="cb1-50"><a href="#cb1-50"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-51"><a href="#cb1-51"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>, sqr2p1),</span>
<span id="cb1-52"><a href="#cb1-52"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">-1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-53"><a href="#cb1-53"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">-1</span>, sqr2p1),</span>
<span id="cb1-54"><a href="#cb1-54"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">1</span>, <span class="op">-</span>sqr2p1),</span>
<span id="cb1-55"><a href="#cb1-55"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="dv">1</span>, sqr2p1),</span>
<span id="cb1-56"><a href="#cb1-56"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-57"><a href="#cb1-57"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</span>
<span id="cb1-58"><a href="#cb1-58"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-59"><a href="#cb1-59"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>),</span>
<span id="cb1-60"><a href="#cb1-60"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-61"><a href="#cb1-61"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</span>
<span id="cb1-62"><a href="#cb1-62"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-63"><a href="#cb1-63"></a>  <span class="kw">c</span>(<span class="op">-</span>sqr2p1, sqr2p1, sqr2p1, <span class="dv">1</span>),</span>
<span id="cb1-64"><a href="#cb1-64"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-65"><a href="#cb1-65"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</span>
<span id="cb1-66"><a href="#cb1-66"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-67"><a href="#cb1-67"></a>  <span class="kw">c</span>(sqr2p1, <span class="op">-</span>sqr2p1, sqr2p1, <span class="dv">1</span>),</span>
<span id="cb1-68"><a href="#cb1-68"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-69"><a href="#cb1-69"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, <span class="op">-</span>sqr2p1, <span class="dv">1</span>),</span>
<span id="cb1-70"><a href="#cb1-70"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, sqr2p1, <span class="dv">-1</span>),</span>
<span id="cb1-71"><a href="#cb1-71"></a>  <span class="kw">c</span>(sqr2p1, sqr2p1, sqr2p1, <span class="dv">1</span>)</span>
<span id="cb1-72"><a href="#cb1-72"></a>)</span>
<span id="cb1-73"><a href="#cb1-73"></a></span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="co"># convex hull is the polytope itself, since it is convex #######################</span></span>
<span id="cb1-75"><a href="#cb1-75"></a>hull &lt;-<span class="st"> </span><span class="kw">cxhull</span>(vertices)</span>
<span id="cb1-76"><a href="#cb1-76"></a></span>
<span id="cb1-77"><a href="#cb1-77"></a><span class="co"># edges ########################################################################</span></span>
<span id="cb1-78"><a href="#cb1-78"></a>edges &lt;-<span class="st"> </span>hull<span class="op">$</span>edges</span>
<span id="cb1-79"><a href="#cb1-79"></a></span>
<span id="cb1-80"><a href="#cb1-80"></a><span class="co"># (triangular) faces of the tetrahedra ######################################### </span></span>
<span id="cb1-81"><a href="#cb1-81"></a>ridgeSizes &lt;-<span class="st"> </span><span class="kw">sapply</span>(hull<span class="op">$</span>ridges, <span class="cf">function</span>(ridge) <span class="kw">length</span>(ridge<span class="op">$</span>vertices))</span>
<span id="cb1-82"><a href="#cb1-82"></a>triangles &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">sapply</span>(hull<span class="op">$</span>ridges[<span class="kw">which</span>(ridgeSizes<span class="op">==</span><span class="dv">3</span>)], </span>
<span id="cb1-83"><a href="#cb1-83"></a>                      <span class="cf">function</span>(ridge) ridge<span class="op">$</span>vertices))</span>
<span id="cb1-84"><a href="#cb1-84"></a></span>
<span id="cb1-85"><a href="#cb1-85"></a><span class="co"># stereographic projection #####################################################</span></span>
<span id="cb1-86"><a href="#cb1-86"></a>sproj &lt;-<span class="st"> </span><span class="cf">function</span>(p, r){</span>
<span id="cb1-87"><a href="#cb1-87"></a>  <span class="kw">c</span>(p[<span class="dv">1</span>], p[<span class="dv">2</span>], p[<span class="dv">3</span>])<span class="op">/</span>(r<span class="op">-</span>p[<span class="dv">4</span>])</span>
<span id="cb1-88"><a href="#cb1-88"></a>}</span>
<span id="cb1-89"><a href="#cb1-89"></a></span>
<span id="cb1-90"><a href="#cb1-90"></a><span class="co"># spherical segment ############################################################</span></span>
<span id="cb1-91"><a href="#cb1-91"></a>sphericalSegment &lt;-<span class="st"> </span><span class="cf">function</span>(P, Q, r, n){</span>
<span id="cb1-92"><a href="#cb1-92"></a>  out &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_real_</span>, <span class="dt">nrow =</span> n<span class="op">+</span><span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb1-93"><a href="#cb1-93"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>n){</span>
<span id="cb1-94"><a href="#cb1-94"></a>    pt &lt;-<span class="st"> </span>P <span class="op">+</span><span class="st"> </span>(i<span class="op">/</span>n)<span class="op">*</span>(Q<span class="op">-</span>P)</span>
<span id="cb1-95"><a href="#cb1-95"></a>    out[i<span class="op">+</span>1L, ] &lt;-<span class="st"> </span>r<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(pt))) <span class="op">*</span><span class="st"> </span>pt</span>
<span id="cb1-96"><a href="#cb1-96"></a>  }</span>
<span id="cb1-97"><a href="#cb1-97"></a>  out</span>
<span id="cb1-98"><a href="#cb1-98"></a>}</span>
<span id="cb1-99"><a href="#cb1-99"></a></span>
<span id="cb1-100"><a href="#cb1-100"></a><span class="co"># stereographic edge ###########################################################</span></span>
<span id="cb1-101"><a href="#cb1-101"></a>stereoEdge &lt;-<span class="st"> </span><span class="cf">function</span>(verts, edge, r, n){</span>
<span id="cb1-102"><a href="#cb1-102"></a>  P &lt;-<span class="st"> </span>verts[edge[<span class="dv">1</span>], ]</span>
<span id="cb1-103"><a href="#cb1-103"></a>  Q &lt;-<span class="st"> </span>verts[edge[<span class="dv">2</span>], ]</span>
<span id="cb1-104"><a href="#cb1-104"></a>  PQ &lt;-<span class="st"> </span><span class="kw">sphericalSegment</span>(P, Q, r, n)</span>
<span id="cb1-105"><a href="#cb1-105"></a>  pq &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(PQ, <span class="dv">1</span>, <span class="cf">function</span>(M){<span class="kw">sproj</span>(M, r)}))</span>
<span id="cb1-106"><a href="#cb1-106"></a>  dists &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">apply</span>(pq, <span class="dv">1</span>, crossprod))</span>
<span id="cb1-107"><a href="#cb1-107"></a>  <span class="kw">cylinder3d</span>(pq, <span class="dt">radius =</span> <span class="kw">log1p</span>(dists<span class="op">/</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">4</span>, <span class="dt">sides =</span> <span class="dv">60</span>)</span>
<span id="cb1-108"><a href="#cb1-108"></a>}</span>
<span id="cb1-109"><a href="#cb1-109"></a></span>
<span id="cb1-110"><a href="#cb1-110"></a><span class="co"># stereographic subdivision (to fill the triangles) ############################</span></span>
<span id="cb1-111"><a href="#cb1-111"></a>midpoint4 &lt;-<span class="st"> </span><span class="cf">function</span>(A, B, r){</span>
<span id="cb1-112"><a href="#cb1-112"></a>  M &lt;-<span class="st"> </span>(A <span class="op">+</span><span class="st"> </span>B) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb1-113"><a href="#cb1-113"></a>  lg &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(M))) <span class="op">/</span><span class="st"> </span>r</span>
<span id="cb1-114"><a href="#cb1-114"></a>  M <span class="op">/</span><span class="st"> </span>lg</span>
<span id="cb1-115"><a href="#cb1-115"></a>} </span>
<span id="cb1-116"><a href="#cb1-116"></a></span>
<span id="cb1-117"><a href="#cb1-117"></a>subdiv0 &lt;-<span class="st"> </span><span class="cf">function</span>(A, B, C, r){</span>
<span id="cb1-118"><a href="#cb1-118"></a>  mAB &lt;-<span class="st"> </span><span class="kw">midpoint4</span>(A, B, r)</span>
<span id="cb1-119"><a href="#cb1-119"></a>  mAC &lt;-<span class="st"> </span><span class="kw">midpoint4</span>(A, C, r)</span>
<span id="cb1-120"><a href="#cb1-120"></a>  mBC &lt;-<span class="st"> </span><span class="kw">midpoint4</span>(B, C, r)</span>
<span id="cb1-121"><a href="#cb1-121"></a>  out &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_real_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(4L, 3L, 4L))</span>
<span id="cb1-122"><a href="#cb1-122"></a>  out[<span class="dv">1</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(A, mAB, mAC)</span>
<span id="cb1-123"><a href="#cb1-123"></a>  out[<span class="dv">2</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(B, mBC, mAB)</span>
<span id="cb1-124"><a href="#cb1-124"></a>  out[<span class="dv">3</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(C, mAC, mBC)</span>
<span id="cb1-125"><a href="#cb1-125"></a>  out[<span class="dv">4</span>,,] &lt;-<span class="st"> </span><span class="kw">rbind</span>(mAB, mBC, mAC)</span>
<span id="cb1-126"><a href="#cb1-126"></a>  out</span>
<span id="cb1-127"><a href="#cb1-127"></a>}</span>
<span id="cb1-128"><a href="#cb1-128"></a></span>
<span id="cb1-129"><a href="#cb1-129"></a>subdiv &lt;-<span class="st"> </span><span class="cf">function</span>(n, A, B, C, r){</span>
<span id="cb1-130"><a href="#cb1-130"></a>  <span class="cf">if</span>(n <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</span>
<span id="cb1-131"><a href="#cb1-131"></a>    <span class="kw">return</span>(<span class="kw">subdiv0</span>(A, B, C, r))</span>
<span id="cb1-132"><a href="#cb1-132"></a>  }</span>
<span id="cb1-133"><a href="#cb1-133"></a>  triangles &lt;-<span class="st"> </span><span class="kw">subdiv</span>(n<span class="dv">-1</span>, A, B, C, r)</span>
<span id="cb1-134"><a href="#cb1-134"></a>  out &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA_real_</span>, <span class="dt">dim =</span> <span class="kw">c</span>(0L, 3L, 4L))</span>
<span id="cb1-135"><a href="#cb1-135"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">4</span><span class="op">^</span>(n<span class="dv">-1</span>))){</span>
<span id="cb1-136"><a href="#cb1-136"></a>    trgl &lt;-<span class="st"> </span>triangles[i,,]</span>
<span id="cb1-137"><a href="#cb1-137"></a>    out &lt;-<span class="st"> </span><span class="kw">abind</span>(out, <span class="kw">subdiv0</span>(trgl[1L,], trgl[2L,], trgl[3L,], r), <span class="dt">along =</span> 1L)</span>
<span id="cb1-138"><a href="#cb1-138"></a>  }</span>
<span id="cb1-139"><a href="#cb1-139"></a>  out</span>
<span id="cb1-140"><a href="#cb1-140"></a>}</span>
<span id="cb1-141"><a href="#cb1-141"></a></span>
<span id="cb1-142"><a href="#cb1-142"></a><span class="co"># mesh maker ###################################################################</span></span>
<span id="cb1-143"><a href="#cb1-143"></a>stereoTriangle &lt;-<span class="st"> </span><span class="cf">function</span>(n, A, B, C, r){</span>
<span id="cb1-144"><a href="#cb1-144"></a>  triangles &lt;-<span class="st"> </span><span class="kw">subdiv</span>(n, A, B, C, r)</span>
<span id="cb1-145"><a href="#cb1-145"></a>  ntriangles &lt;-<span class="st"> </span><span class="kw">dim</span>(triangles)[1L]</span>
<span id="cb1-146"><a href="#cb1-146"></a>  indices &lt;-<span class="st"> </span><span class="kw">matrix</span>(1L<span class="op">:</span>(3L<span class="op">*</span>ntriangles), <span class="dt">nrow =</span> 3L, <span class="dt">ncol =</span> ntriangles)</span>
<span id="cb1-147"><a href="#cb1-147"></a>  vertices &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_real_</span>, <span class="dt">nrow =</span> 3L, <span class="dt">ncol =</span> 3L<span class="op">*</span>ntriangles)</span>
<span id="cb1-148"><a href="#cb1-148"></a>  <span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>ntriangles){</span>
<span id="cb1-149"><a href="#cb1-149"></a>    trgl &lt;-<span class="st"> </span>triangles[i,,]</span>
<span id="cb1-150"><a href="#cb1-150"></a>    vertices[, 3L<span class="op">*</span>(i<span class="op">-</span>1L)<span class="op">+</span>1L] &lt;-<span class="st"> </span><span class="kw">sproj</span>(trgl[1L,], r)</span>
<span id="cb1-151"><a href="#cb1-151"></a>    vertices[, 3L<span class="op">*</span>(i<span class="op">-</span>1L)<span class="op">+</span>2L] &lt;-<span class="st"> </span><span class="kw">sproj</span>(trgl[2L,], r)</span>
<span id="cb1-152"><a href="#cb1-152"></a>    vertices[, 3L<span class="op">*</span>(i<span class="op">-</span>1L)<span class="op">+</span>3L] &lt;-<span class="st"> </span><span class="kw">sproj</span>(trgl[3L,], r)</span>
<span id="cb1-153"><a href="#cb1-153"></a>  }</span>
<span id="cb1-154"><a href="#cb1-154"></a>  mesh &lt;-<span class="st"> </span><span class="kw">tmesh3d</span>(vertices, indices, <span class="dt">homogeneous =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-155"><a href="#cb1-155"></a>  Rvcg<span class="op">::</span><span class="kw">vcgClean</span>(mesh, <span class="dt">sel =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">7</span>), <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-156"><a href="#cb1-156"></a>}</span>
<span id="cb1-157"><a href="#cb1-157"></a></span>
<span id="cb1-158"><a href="#cb1-158"></a><span class="co"># projected vertices ###########################################################</span></span>
<span id="cb1-159"><a href="#cb1-159"></a>r &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>sqr2p1<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb1-160"><a href="#cb1-160"></a>vs &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(vertices, 1L, <span class="cf">function</span>(M){<span class="kw">sproj</span>(M, r)}))</span>
<span id="cb1-161"><a href="#cb1-161"></a></span>
<span id="cb1-162"><a href="#cb1-162"></a><span class="co">####~~~~ plot ~~~~##############################################################</span></span>
<span id="cb1-163"><a href="#cb1-163"></a><span class="kw">open3d</span>(<span class="dt">windowRect =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">562</span>, <span class="dv">562</span>), <span class="dt">zoom =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-164"><a href="#cb1-164"></a><span class="kw">bg3d</span>(<span class="kw">rgb</span>(<span class="dv">54</span>, <span class="dv">57</span>, <span class="dv">64</span>, <span class="dt">maxColorValue =</span> <span class="dv">255</span>))</span>
<span id="cb1-165"><a href="#cb1-165"></a><span class="co">## plot the edges</span></span>
<span id="cb1-166"><a href="#cb1-166"></a><span class="cf">for</span>(k <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(edges)){</span>
<span id="cb1-167"><a href="#cb1-167"></a>  edge &lt;-<span class="st"> </span><span class="kw">stereoEdge</span>(vertices, edges[k,], r, <span class="dt">n =</span> <span class="dv">100</span>)</span>
<span id="cb1-168"><a href="#cb1-168"></a>  <span class="kw">shade3d</span>(edge, <span class="dt">color =</span> <span class="st">&quot;gold&quot;</span>)</span>
<span id="cb1-169"><a href="#cb1-169"></a>}</span>
<span id="cb1-170"><a href="#cb1-170"></a><span class="co">## plot the vertices</span></span>
<span id="cb1-171"><a href="#cb1-171"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(vs)){</span>
<span id="cb1-172"><a href="#cb1-172"></a>  v &lt;-<span class="st"> </span>vs[i,]</span>
<span id="cb1-173"><a href="#cb1-173"></a>  <span class="kw">spheres3d</span>(v, <span class="dt">radius =</span> <span class="kw">log1p</span>(<span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(v)))<span class="op">/</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;gold2&quot;</span>)</span>
<span id="cb1-174"><a href="#cb1-174"></a>}</span>
<span id="cb1-175"><a href="#cb1-175"></a><span class="co">## plot the filled triangles</span></span>
<span id="cb1-176"><a href="#cb1-176"></a><span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span><span class="kw">nrow</span>(triangles)){</span>
<span id="cb1-177"><a href="#cb1-177"></a>  trgl &lt;-<span class="st"> </span>triangles[i,]</span>
<span id="cb1-178"><a href="#cb1-178"></a>  A &lt;-<span class="st"> </span>vertices[trgl[1L], ]</span>
<span id="cb1-179"><a href="#cb1-179"></a>  B &lt;-<span class="st"> </span>vertices[trgl[2L], ]</span>
<span id="cb1-180"><a href="#cb1-180"></a>  C &lt;-<span class="st"> </span>vertices[trgl[3L], ]</span>
<span id="cb1-181"><a href="#cb1-181"></a>  mesh &lt;-<span class="st"> </span><span class="kw">stereoTriangle</span>(<span class="dv">6</span>, A, B, C, r)</span>
<span id="cb1-182"><a href="#cb1-182"></a>  <span class="kw">shade3d</span>(mesh, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb1-183"><a href="#cb1-183"></a>}</span></code></pre></div>
<p><img src="figures/truncatedTesseract_stereographic_rgl.gif" /></p>
<h1 id="drawing-with-asymptote">Drawing with Asymptote</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1"></a>settings.render = <span class="dv">4</span>;</span>
<span id="cb2-2"><a href="#cb2-2"></a>settings.outformat = <span class="st">&quot;eps&quot;</span>;</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">import</span> tube;</span>
<span id="cb2-4"><a href="#cb2-4"></a>size(<span class="dv">200</span>,<span class="dv">0</span>);</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>currentprojection = orthographic(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>);</span>
<span id="cb2-7"><a href="#cb2-7"></a>currentlight = light(gray(<span class="fl">0.85</span>), ambient=black, specularfactor=<span class="dv">3</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>                     (<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>), specular=gray(<span class="fl">0.9</span>), viewport=<span class="kw">false</span>);</span>
<span id="cb2-9"><a href="#cb2-9"></a>currentlight.background = rgb(<span class="st">&quot;363940ff&quot;</span>);</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">// files to be saved -----------------------------------------------------------</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>string[] files = {</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="st">&quot;TT000&quot;</span>, <span class="st">&quot;TT001&quot;</span>, <span class="st">&quot;TT002&quot;</span>, <span class="st">&quot;TT003&quot;</span>, <span class="st">&quot;TT004&quot;</span>, <span class="st">&quot;TT005&quot;</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="st">&quot;TT006&quot;</span>, <span class="st">&quot;TT007&quot;</span>, <span class="st">&quot;TT008&quot;</span>, <span class="st">&quot;TT009&quot;</span>, <span class="st">&quot;TT010&quot;</span>, <span class="st">&quot;TT011&quot;</span>,</span>
<span id="cb2-15"><a href="#cb2-15"></a>    <span class="st">&quot;TT012&quot;</span>, <span class="st">&quot;TT013&quot;</span>, <span class="st">&quot;TT014&quot;</span>, <span class="st">&quot;TT015&quot;</span>, <span class="st">&quot;TT016&quot;</span>, <span class="st">&quot;TT017&quot;</span>,</span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="st">&quot;TT018&quot;</span>, <span class="st">&quot;TT019&quot;</span>, <span class="st">&quot;TT020&quot;</span>, <span class="st">&quot;TT021&quot;</span>, <span class="st">&quot;TT022&quot;</span>, <span class="st">&quot;TT023&quot;</span>,</span>
<span id="cb2-17"><a href="#cb2-17"></a>    <span class="st">&quot;TT024&quot;</span>, <span class="st">&quot;TT025&quot;</span>, <span class="st">&quot;TT026&quot;</span>, <span class="st">&quot;TT027&quot;</span>, <span class="st">&quot;TT028&quot;</span>, <span class="st">&quot;TT029&quot;</span>,</span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="st">&quot;TT030&quot;</span>, <span class="st">&quot;TT031&quot;</span>, <span class="st">&quot;TT032&quot;</span>, <span class="st">&quot;TT033&quot;</span>, <span class="st">&quot;TT034&quot;</span>, <span class="st">&quot;TT035&quot;</span>,</span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="st">&quot;TT036&quot;</span>, <span class="st">&quot;TT037&quot;</span>, <span class="st">&quot;TT038&quot;</span>, <span class="st">&quot;TT039&quot;</span>, <span class="st">&quot;TT040&quot;</span>, <span class="st">&quot;TT041&quot;</span>,</span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="st">&quot;TT042&quot;</span>, <span class="st">&quot;TT043&quot;</span>, <span class="st">&quot;TT044&quot;</span>, <span class="st">&quot;TT045&quot;</span>, <span class="st">&quot;TT046&quot;</span>, <span class="st">&quot;TT047&quot;</span>,</span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="st">&quot;TT048&quot;</span>, <span class="st">&quot;TT049&quot;</span>, <span class="st">&quot;TT050&quot;</span>, <span class="st">&quot;TT051&quot;</span>, <span class="st">&quot;TT052&quot;</span>, <span class="st">&quot;TT053&quot;</span>,</span>
<span id="cb2-22"><a href="#cb2-22"></a>    <span class="st">&quot;TT054&quot;</span>, <span class="st">&quot;TT055&quot;</span>, <span class="st">&quot;TT056&quot;</span>, <span class="st">&quot;TT057&quot;</span>, <span class="st">&quot;TT058&quot;</span>, <span class="st">&quot;TT059&quot;</span>,</span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="st">&quot;TT060&quot;</span>, <span class="st">&quot;TT061&quot;</span>, <span class="st">&quot;TT062&quot;</span>, <span class="st">&quot;TT063&quot;</span>, <span class="st">&quot;TT064&quot;</span>, <span class="st">&quot;TT065&quot;</span>,</span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="st">&quot;TT066&quot;</span>, <span class="st">&quot;TT067&quot;</span>, <span class="st">&quot;TT068&quot;</span>, <span class="st">&quot;TT069&quot;</span>, <span class="st">&quot;TT070&quot;</span>, <span class="st">&quot;TT071&quot;</span>,</span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="st">&quot;TT072&quot;</span>, <span class="st">&quot;TT073&quot;</span>, <span class="st">&quot;TT074&quot;</span>, <span class="st">&quot;TT075&quot;</span>, <span class="st">&quot;TT076&quot;</span>, <span class="st">&quot;TT077&quot;</span>,</span>
<span id="cb2-26"><a href="#cb2-26"></a>    <span class="st">&quot;TT078&quot;</span>, <span class="st">&quot;TT079&quot;</span>, <span class="st">&quot;TT080&quot;</span>, <span class="st">&quot;TT081&quot;</span>, <span class="st">&quot;TT082&quot;</span>, <span class="st">&quot;TT083&quot;</span>,</span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="st">&quot;TT084&quot;</span>, <span class="st">&quot;TT085&quot;</span>, <span class="st">&quot;TT086&quot;</span>, <span class="st">&quot;TT087&quot;</span>, <span class="st">&quot;TT088&quot;</span>, <span class="st">&quot;TT089&quot;</span>,</span>
<span id="cb2-28"><a href="#cb2-28"></a>    <span class="st">&quot;TT090&quot;</span>, <span class="st">&quot;TT091&quot;</span>, <span class="st">&quot;TT092&quot;</span>, <span class="st">&quot;TT093&quot;</span>, <span class="st">&quot;TT094&quot;</span>, <span class="st">&quot;TT095&quot;</span>,</span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="st">&quot;TT096&quot;</span>, <span class="st">&quot;TT097&quot;</span>, <span class="st">&quot;TT098&quot;</span>, <span class="st">&quot;TT099&quot;</span>, <span class="st">&quot;TT100&quot;</span>, <span class="st">&quot;TT101&quot;</span>,</span>
<span id="cb2-30"><a href="#cb2-30"></a>    <span class="st">&quot;TT102&quot;</span>, <span class="st">&quot;TT103&quot;</span>, <span class="st">&quot;TT104&quot;</span>, <span class="st">&quot;TT105&quot;</span>, <span class="st">&quot;TT106&quot;</span>, <span class="st">&quot;TT107&quot;</span>,</span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="st">&quot;TT108&quot;</span>, <span class="st">&quot;TT109&quot;</span>, <span class="st">&quot;TT110&quot;</span>, <span class="st">&quot;TT111&quot;</span>, <span class="st">&quot;TT112&quot;</span>, <span class="st">&quot;TT113&quot;</span>,</span>
<span id="cb2-32"><a href="#cb2-32"></a>    <span class="st">&quot;TT114&quot;</span>, <span class="st">&quot;TT115&quot;</span>, <span class="st">&quot;TT116&quot;</span>, <span class="st">&quot;TT117&quot;</span>, <span class="st">&quot;TT118&quot;</span>, <span class="st">&quot;TT119&quot;</span>,</span>
<span id="cb2-33"><a href="#cb2-33"></a>    <span class="st">&quot;TT120&quot;</span>, <span class="st">&quot;TT121&quot;</span>, <span class="st">&quot;TT122&quot;</span>, <span class="st">&quot;TT123&quot;</span>, <span class="st">&quot;TT124&quot;</span>, <span class="st">&quot;TT125&quot;</span>,</span>
<span id="cb2-34"><a href="#cb2-34"></a>    <span class="st">&quot;TT126&quot;</span>, <span class="st">&quot;TT127&quot;</span>, <span class="st">&quot;TT128&quot;</span>, <span class="st">&quot;TT129&quot;</span>, <span class="st">&quot;TT130&quot;</span>, <span class="st">&quot;TT131&quot;</span>,</span>
<span id="cb2-35"><a href="#cb2-35"></a>    <span class="st">&quot;TT132&quot;</span>, <span class="st">&quot;TT133&quot;</span>, <span class="st">&quot;TT134&quot;</span>, <span class="st">&quot;TT135&quot;</span>, <span class="st">&quot;TT136&quot;</span>, <span class="st">&quot;TT137&quot;</span>,</span>
<span id="cb2-36"><a href="#cb2-36"></a>    <span class="st">&quot;TT138&quot;</span>, <span class="st">&quot;TT139&quot;</span>, <span class="st">&quot;TT140&quot;</span>, <span class="st">&quot;TT141&quot;</span>, <span class="st">&quot;TT142&quot;</span>, <span class="st">&quot;TT143&quot;</span>,</span>
<span id="cb2-37"><a href="#cb2-37"></a>    <span class="st">&quot;TT144&quot;</span>, <span class="st">&quot;TT145&quot;</span>, <span class="st">&quot;TT146&quot;</span>, <span class="st">&quot;TT147&quot;</span>, <span class="st">&quot;TT148&quot;</span>, <span class="st">&quot;TT149&quot;</span>,</span>
<span id="cb2-38"><a href="#cb2-38"></a>    <span class="st">&quot;TT150&quot;</span>, <span class="st">&quot;TT151&quot;</span>, <span class="st">&quot;TT152&quot;</span>, <span class="st">&quot;TT153&quot;</span>, <span class="st">&quot;TT154&quot;</span>, <span class="st">&quot;TT155&quot;</span>,</span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="st">&quot;TT156&quot;</span>, <span class="st">&quot;TT157&quot;</span>, <span class="st">&quot;TT158&quot;</span>, <span class="st">&quot;TT159&quot;</span>, <span class="st">&quot;TT160&quot;</span>, <span class="st">&quot;TT161&quot;</span>,</span>
<span id="cb2-40"><a href="#cb2-40"></a>    <span class="st">&quot;TT162&quot;</span>, <span class="st">&quot;TT163&quot;</span>, <span class="st">&quot;TT164&quot;</span>, <span class="st">&quot;TT165&quot;</span>, <span class="st">&quot;TT166&quot;</span>, <span class="st">&quot;TT167&quot;</span>,</span>
<span id="cb2-41"><a href="#cb2-41"></a>    <span class="st">&quot;TT168&quot;</span>, <span class="st">&quot;TT169&quot;</span>, <span class="st">&quot;TT170&quot;</span>, <span class="st">&quot;TT171&quot;</span>, <span class="st">&quot;TT172&quot;</span>, <span class="st">&quot;TT173&quot;</span>,</span>
<span id="cb2-42"><a href="#cb2-42"></a>    <span class="st">&quot;TT174&quot;</span>, <span class="st">&quot;TT175&quot;</span>, <span class="st">&quot;TT176&quot;</span>, <span class="st">&quot;TT177&quot;</span>, <span class="st">&quot;TT178&quot;</span>, <span class="st">&quot;TT179&quot;</span>};</span>
<span id="cb2-43"><a href="#cb2-43"></a></span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="co">// vertices --------------------------------------------------------------------</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="kw">struct</span> quadruple {</span>
<span id="cb2-46"><a href="#cb2-46"></a>    real x;</span>
<span id="cb2-47"><a href="#cb2-47"></a>    real y;</span>
<span id="cb2-48"><a href="#cb2-48"></a>    real z;</span>
<span id="cb2-49"><a href="#cb2-49"></a>    real t;</span>
<span id="cb2-50"><a href="#cb2-50"></a>}</span>
<span id="cb2-51"><a href="#cb2-51"></a></span>
<span id="cb2-52"><a href="#cb2-52"></a>quadruple array2quadruple(real[] v){</span>
<span id="cb2-53"><a href="#cb2-53"></a>    quadruple q;</span>
<span id="cb2-54"><a href="#cb2-54"></a>    q.x = v[<span class="dv">0</span>]; q.y = v[<span class="dv">1</span>]; q.z = v[<span class="dv">2</span>]; q.t = v[<span class="dv">3</span>];</span>
<span id="cb2-55"><a href="#cb2-55"></a>    <span class="cf">return</span> q;</span>
<span id="cb2-56"><a href="#cb2-56"></a>}</span>
<span id="cb2-57"><a href="#cb2-57"></a></span>
<span id="cb2-58"><a href="#cb2-58"></a>real x = <span class="dv">1</span> + sqrt(<span class="dv">2</span>);</span>
<span id="cb2-59"><a href="#cb2-59"></a>real r = sqrt(<span class="dv">1</span> + <span class="dv">3</span> * x * x);</span>
<span id="cb2-60"><a href="#cb2-60"></a>real[][] vertices0 = {</span>
<span id="cb2-61"><a href="#cb2-61"></a>    {-<span class="fl">1.0</span>, -x, -x, -x},</span>
<span id="cb2-62"><a href="#cb2-62"></a>    {-<span class="fl">1.0</span>, -x, -x, x},</span>
<span id="cb2-63"><a href="#cb2-63"></a>    {-<span class="fl">1.0</span>, -x, x, -x},</span>
<span id="cb2-64"><a href="#cb2-64"></a>    {-<span class="fl">1.0</span>, -x, x, x},</span>
<span id="cb2-65"><a href="#cb2-65"></a>    {-<span class="fl">1.0</span>, x, -x, -x},</span>
<span id="cb2-66"><a href="#cb2-66"></a>    {-<span class="fl">1.0</span>, x, -x, x},</span>
<span id="cb2-67"><a href="#cb2-67"></a>    {-<span class="fl">1.0</span>, x, x, -x},</span>
<span id="cb2-68"><a href="#cb2-68"></a>    {-<span class="fl">1.0</span>, x, x, x},</span>
<span id="cb2-69"><a href="#cb2-69"></a>    {<span class="fl">1.0</span>, -x, -x, -x},</span>
<span id="cb2-70"><a href="#cb2-70"></a>    {<span class="fl">1.0</span>, -x, -x, x},</span>
<span id="cb2-71"><a href="#cb2-71"></a>    {<span class="fl">1.0</span>, -x, x, -x},</span>
<span id="cb2-72"><a href="#cb2-72"></a>    {<span class="fl">1.0</span>, -x, x, x},</span>
<span id="cb2-73"><a href="#cb2-73"></a>    {<span class="fl">1.0</span>, x, -x, -x},</span>
<span id="cb2-74"><a href="#cb2-74"></a>    {<span class="fl">1.0</span>, x, -x, x},</span>
<span id="cb2-75"><a href="#cb2-75"></a>    {<span class="fl">1.0</span>, x, x, -x},</span>
<span id="cb2-76"><a href="#cb2-76"></a>    {<span class="fl">1.0</span>, x, x, x},</span>
<span id="cb2-77"><a href="#cb2-77"></a>    {-x, -<span class="fl">1.0</span>, -x, -x},</span>
<span id="cb2-78"><a href="#cb2-78"></a>    {-x, -<span class="fl">1.0</span>, -x, x},</span>
<span id="cb2-79"><a href="#cb2-79"></a>    {-x, -<span class="fl">1.0</span>, x, -x},</span>
<span id="cb2-80"><a href="#cb2-80"></a>    {-x, -<span class="fl">1.0</span>, x, x},</span>
<span id="cb2-81"><a href="#cb2-81"></a>    {-x, <span class="fl">1.0</span>, -x, -x},</span>
<span id="cb2-82"><a href="#cb2-82"></a>    {-x, <span class="fl">1.0</span>, -x, x},</span>
<span id="cb2-83"><a href="#cb2-83"></a>    {-x, <span class="fl">1.0</span>, x, -x},</span>
<span id="cb2-84"><a href="#cb2-84"></a>    {-x, <span class="fl">1.0</span>, x, x},</span>
<span id="cb2-85"><a href="#cb2-85"></a>    {x, -<span class="fl">1.0</span>, -x, -x},</span>
<span id="cb2-86"><a href="#cb2-86"></a>    {x, -<span class="fl">1.0</span>, -x, x},</span>
<span id="cb2-87"><a href="#cb2-87"></a>    {x, -<span class="fl">1.0</span>, x, -x},</span>
<span id="cb2-88"><a href="#cb2-88"></a>    {x, -<span class="fl">1.0</span>, x, x},</span>
<span id="cb2-89"><a href="#cb2-89"></a>    {x, <span class="fl">1.0</span>, -x, -x},</span>
<span id="cb2-90"><a href="#cb2-90"></a>    {x, <span class="fl">1.0</span>, -x, x},</span>
<span id="cb2-91"><a href="#cb2-91"></a>    {x, <span class="fl">1.0</span>, x, -x},</span>
<span id="cb2-92"><a href="#cb2-92"></a>    {x, <span class="fl">1.0</span>, x, x},</span>
<span id="cb2-93"><a href="#cb2-93"></a>    {-x, -x, -<span class="fl">1.0</span>, -x},</span>
<span id="cb2-94"><a href="#cb2-94"></a>    {-x, -x, -<span class="fl">1.0</span>, x},</span>
<span id="cb2-95"><a href="#cb2-95"></a>    {-x, -x, <span class="fl">1.0</span>, -x},</span>
<span id="cb2-96"><a href="#cb2-96"></a>    {-x, -x, <span class="fl">1.0</span>, x},</span>
<span id="cb2-97"><a href="#cb2-97"></a>    {-x, x, -<span class="fl">1.0</span>, -x},</span>
<span id="cb2-98"><a href="#cb2-98"></a>    {-x, x, -<span class="fl">1.0</span>, x},</span>
<span id="cb2-99"><a href="#cb2-99"></a>    {-x, x, <span class="fl">1.0</span>, -x},</span>
<span id="cb2-100"><a href="#cb2-100"></a>    {-x, x, <span class="fl">1.0</span>, x},</span>
<span id="cb2-101"><a href="#cb2-101"></a>    {x, -x, -<span class="fl">1.0</span>, -x},</span>
<span id="cb2-102"><a href="#cb2-102"></a>    {x, -x, -<span class="fl">1.0</span>, x},</span>
<span id="cb2-103"><a href="#cb2-103"></a>    {x, -x, <span class="fl">1.0</span>, -x},</span>
<span id="cb2-104"><a href="#cb2-104"></a>    {x, -x, <span class="fl">1.0</span>, x},</span>
<span id="cb2-105"><a href="#cb2-105"></a>    {x, x, -<span class="fl">1.0</span>, -x},</span>
<span id="cb2-106"><a href="#cb2-106"></a>    {x, x, -<span class="fl">1.0</span>, x},</span>
<span id="cb2-107"><a href="#cb2-107"></a>    {x, x, <span class="fl">1.0</span>, -x},</span>
<span id="cb2-108"><a href="#cb2-108"></a>    {x, x, <span class="fl">1.0</span>, x},</span>
<span id="cb2-109"><a href="#cb2-109"></a>    {-x, -x, -x, -<span class="fl">1.0</span>},</span>
<span id="cb2-110"><a href="#cb2-110"></a>    {-x, -x, -x, <span class="fl">1.0</span>},</span>
<span id="cb2-111"><a href="#cb2-111"></a>    {-x, -x, x, -<span class="fl">1.0</span>},</span>
<span id="cb2-112"><a href="#cb2-112"></a>    {-x, -x, x, <span class="fl">1.0</span>},</span>
<span id="cb2-113"><a href="#cb2-113"></a>    {-x, x, -x, -<span class="fl">1.0</span>},</span>
<span id="cb2-114"><a href="#cb2-114"></a>    {-x, x, -x, <span class="fl">1.0</span>},</span>
<span id="cb2-115"><a href="#cb2-115"></a>    {-x, x, x, -<span class="fl">1.0</span>},</span>
<span id="cb2-116"><a href="#cb2-116"></a>    {-x, x, x, <span class="fl">1.0</span>},</span>
<span id="cb2-117"><a href="#cb2-117"></a>    {x, -x, -x, -<span class="fl">1.0</span>},</span>
<span id="cb2-118"><a href="#cb2-118"></a>    {x, -x, -x, <span class="fl">1.0</span>},</span>
<span id="cb2-119"><a href="#cb2-119"></a>    {x, -x, x, -<span class="fl">1.0</span>},</span>
<span id="cb2-120"><a href="#cb2-120"></a>    {x, -x, x, <span class="fl">1.0</span>},</span>
<span id="cb2-121"><a href="#cb2-121"></a>    {x, x, -x, -<span class="fl">1.0</span>},</span>
<span id="cb2-122"><a href="#cb2-122"></a>    {x, x, -x, <span class="fl">1.0</span>},</span>
<span id="cb2-123"><a href="#cb2-123"></a>    {x, x, x, -<span class="fl">1.0</span>},</span>
<span id="cb2-124"><a href="#cb2-124"></a>    {x, x, x, <span class="fl">1.0</span>} };</span>
<span id="cb2-125"><a href="#cb2-125"></a>    </span>
<span id="cb2-126"><a href="#cb2-126"></a>quadruple[] vertices = <span class="kw">new</span> quadruple[vertices0.length];</span>
<span id="cb2-127"><a href="#cb2-127"></a><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; vertices0.length; ++i){</span>
<span id="cb2-128"><a href="#cb2-128"></a>    vertices[i] = array2quadruple(vertices0[i]);</span>
<span id="cb2-129"><a href="#cb2-129"></a>}</span>
<span id="cb2-130"><a href="#cb2-130"></a></span>
<span id="cb2-131"><a href="#cb2-131"></a><span class="co">// edges -----------------------------------------------------------------------</span></span>
<span id="cb2-132"><a href="#cb2-132"></a><span class="dt">int</span>[][] edges = {</span>
<span id="cb2-133"><a href="#cb2-133"></a>    {<span class="dv">0</span>, <span class="dv">8</span>},</span>
<span id="cb2-134"><a href="#cb2-134"></a>    {<span class="dv">0</span>, <span class="dv">16</span>},</span>
<span id="cb2-135"><a href="#cb2-135"></a>    {<span class="dv">0</span>, <span class="dv">32</span>},</span>
<span id="cb2-136"><a href="#cb2-136"></a>    {<span class="dv">0</span>, <span class="dv">48</span>},</span>
<span id="cb2-137"><a href="#cb2-137"></a>    {<span class="dv">1</span>, <span class="dv">9</span>},</span>
<span id="cb2-138"><a href="#cb2-138"></a>    {<span class="dv">1</span>, <span class="dv">17</span>},</span>
<span id="cb2-139"><a href="#cb2-139"></a>    {<span class="dv">1</span>, <span class="dv">33</span>},</span>
<span id="cb2-140"><a href="#cb2-140"></a>    {<span class="dv">1</span>, <span class="dv">49</span>},</span>
<span id="cb2-141"><a href="#cb2-141"></a>    {<span class="dv">2</span>, <span class="dv">10</span>},</span>
<span id="cb2-142"><a href="#cb2-142"></a>    {<span class="dv">2</span>, <span class="dv">18</span>},</span>
<span id="cb2-143"><a href="#cb2-143"></a>    {<span class="dv">2</span>, <span class="dv">34</span>},</span>
<span id="cb2-144"><a href="#cb2-144"></a>    {<span class="dv">2</span>, <span class="dv">50</span>},</span>
<span id="cb2-145"><a href="#cb2-145"></a>    {<span class="dv">3</span>, <span class="dv">11</span>},</span>
<span id="cb2-146"><a href="#cb2-146"></a>    {<span class="dv">3</span>, <span class="dv">19</span>},</span>
<span id="cb2-147"><a href="#cb2-147"></a>    {<span class="dv">3</span>, <span class="dv">35</span>},</span>
<span id="cb2-148"><a href="#cb2-148"></a>    {<span class="dv">3</span>, <span class="dv">51</span>},</span>
<span id="cb2-149"><a href="#cb2-149"></a>    {<span class="dv">4</span>, <span class="dv">12</span>},</span>
<span id="cb2-150"><a href="#cb2-150"></a>    {<span class="dv">4</span>, <span class="dv">20</span>},</span>
<span id="cb2-151"><a href="#cb2-151"></a>    {<span class="dv">4</span>, <span class="dv">36</span>},</span>
<span id="cb2-152"><a href="#cb2-152"></a>    {<span class="dv">4</span>, <span class="dv">52</span>},</span>
<span id="cb2-153"><a href="#cb2-153"></a>    {<span class="dv">5</span>, <span class="dv">13</span>},</span>
<span id="cb2-154"><a href="#cb2-154"></a>    {<span class="dv">5</span>, <span class="dv">21</span>},</span>
<span id="cb2-155"><a href="#cb2-155"></a>    {<span class="dv">5</span>, <span class="dv">37</span>},</span>
<span id="cb2-156"><a href="#cb2-156"></a>    {<span class="dv">5</span>, <span class="dv">53</span>},</span>
<span id="cb2-157"><a href="#cb2-157"></a>    {<span class="dv">6</span>, <span class="dv">14</span>},</span>
<span id="cb2-158"><a href="#cb2-158"></a>    {<span class="dv">6</span>, <span class="dv">22</span>},</span>
<span id="cb2-159"><a href="#cb2-159"></a>    {<span class="dv">6</span>, <span class="dv">38</span>},</span>
<span id="cb2-160"><a href="#cb2-160"></a>    {<span class="dv">6</span>, <span class="dv">54</span>},</span>
<span id="cb2-161"><a href="#cb2-161"></a>    {<span class="dv">7</span>, <span class="dv">15</span>},</span>
<span id="cb2-162"><a href="#cb2-162"></a>    {<span class="dv">7</span>, <span class="dv">23</span>},</span>
<span id="cb2-163"><a href="#cb2-163"></a>    {<span class="dv">7</span>, <span class="dv">39</span>},</span>
<span id="cb2-164"><a href="#cb2-164"></a>    {<span class="dv">7</span>, <span class="dv">55</span>},</span>
<span id="cb2-165"><a href="#cb2-165"></a>    {<span class="dv">8</span>, <span class="dv">24</span>},</span>
<span id="cb2-166"><a href="#cb2-166"></a>    {<span class="dv">8</span>, <span class="dv">40</span>},</span>
<span id="cb2-167"><a href="#cb2-167"></a>    {<span class="dv">8</span>, <span class="dv">56</span>},</span>
<span id="cb2-168"><a href="#cb2-168"></a>    {<span class="dv">9</span>, <span class="dv">25</span>},</span>
<span id="cb2-169"><a href="#cb2-169"></a>    {<span class="dv">9</span>, <span class="dv">41</span>},</span>
<span id="cb2-170"><a href="#cb2-170"></a>    {<span class="dv">9</span>, <span class="dv">57</span>},</span>
<span id="cb2-171"><a href="#cb2-171"></a>    {<span class="dv">10</span>, <span class="dv">26</span>},</span>
<span id="cb2-172"><a href="#cb2-172"></a>    {<span class="dv">10</span>, <span class="dv">42</span>},</span>
<span id="cb2-173"><a href="#cb2-173"></a>    {<span class="dv">10</span>, <span class="dv">58</span>},</span>
<span id="cb2-174"><a href="#cb2-174"></a>    {<span class="dv">11</span>, <span class="dv">27</span>},</span>
<span id="cb2-175"><a href="#cb2-175"></a>    {<span class="dv">11</span>, <span class="dv">43</span>},</span>
<span id="cb2-176"><a href="#cb2-176"></a>    {<span class="dv">11</span>, <span class="dv">59</span>},</span>
<span id="cb2-177"><a href="#cb2-177"></a>    {<span class="dv">12</span>, <span class="dv">28</span>},</span>
<span id="cb2-178"><a href="#cb2-178"></a>    {<span class="dv">12</span>, <span class="dv">44</span>},</span>
<span id="cb2-179"><a href="#cb2-179"></a>    {<span class="dv">12</span>, <span class="dv">60</span>},</span>
<span id="cb2-180"><a href="#cb2-180"></a>    {<span class="dv">13</span>, <span class="dv">29</span>},</span>
<span id="cb2-181"><a href="#cb2-181"></a>    {<span class="dv">13</span>, <span class="dv">45</span>},</span>
<span id="cb2-182"><a href="#cb2-182"></a>    {<span class="dv">13</span>, <span class="dv">61</span>},</span>
<span id="cb2-183"><a href="#cb2-183"></a>    {<span class="dv">14</span>, <span class="dv">30</span>},</span>
<span id="cb2-184"><a href="#cb2-184"></a>    {<span class="dv">14</span>, <span class="dv">46</span>},</span>
<span id="cb2-185"><a href="#cb2-185"></a>    {<span class="dv">14</span>, <span class="dv">62</span>},</span>
<span id="cb2-186"><a href="#cb2-186"></a>    {<span class="dv">15</span>, <span class="dv">31</span>},</span>
<span id="cb2-187"><a href="#cb2-187"></a>    {<span class="dv">15</span>, <span class="dv">47</span>},</span>
<span id="cb2-188"><a href="#cb2-188"></a>    {<span class="dv">15</span>, <span class="dv">63</span>},</span>
<span id="cb2-189"><a href="#cb2-189"></a>    {<span class="dv">16</span>, <span class="dv">20</span>},</span>
<span id="cb2-190"><a href="#cb2-190"></a>    {<span class="dv">16</span>, <span class="dv">32</span>},</span>
<span id="cb2-191"><a href="#cb2-191"></a>    {<span class="dv">16</span>, <span class="dv">48</span>},</span>
<span id="cb2-192"><a href="#cb2-192"></a>    {<span class="dv">17</span>, <span class="dv">21</span>},</span>
<span id="cb2-193"><a href="#cb2-193"></a>    {<span class="dv">17</span>, <span class="dv">33</span>},</span>
<span id="cb2-194"><a href="#cb2-194"></a>    {<span class="dv">17</span>, <span class="dv">49</span>},</span>
<span id="cb2-195"><a href="#cb2-195"></a>    {<span class="dv">18</span>, <span class="dv">22</span>},</span>
<span id="cb2-196"><a href="#cb2-196"></a>    {<span class="dv">18</span>, <span class="dv">34</span>},</span>
<span id="cb2-197"><a href="#cb2-197"></a>    {<span class="dv">18</span>, <span class="dv">50</span>},</span>
<span id="cb2-198"><a href="#cb2-198"></a>    {<span class="dv">19</span>, <span class="dv">23</span>},</span>
<span id="cb2-199"><a href="#cb2-199"></a>    {<span class="dv">19</span>, <span class="dv">35</span>},</span>
<span id="cb2-200"><a href="#cb2-200"></a>    {<span class="dv">19</span>, <span class="dv">51</span>},</span>
<span id="cb2-201"><a href="#cb2-201"></a>    {<span class="dv">20</span>, <span class="dv">36</span>},</span>
<span id="cb2-202"><a href="#cb2-202"></a>    {<span class="dv">20</span>, <span class="dv">52</span>},</span>
<span id="cb2-203"><a href="#cb2-203"></a>    {<span class="dv">21</span>, <span class="dv">37</span>},</span>
<span id="cb2-204"><a href="#cb2-204"></a>    {<span class="dv">21</span>, <span class="dv">53</span>},</span>
<span id="cb2-205"><a href="#cb2-205"></a>    {<span class="dv">22</span>, <span class="dv">38</span>},</span>
<span id="cb2-206"><a href="#cb2-206"></a>    {<span class="dv">22</span>, <span class="dv">54</span>},</span>
<span id="cb2-207"><a href="#cb2-207"></a>    {<span class="dv">23</span>, <span class="dv">39</span>},</span>
<span id="cb2-208"><a href="#cb2-208"></a>    {<span class="dv">23</span>, <span class="dv">55</span>},</span>
<span id="cb2-209"><a href="#cb2-209"></a>    {<span class="dv">24</span>, <span class="dv">28</span>},</span>
<span id="cb2-210"><a href="#cb2-210"></a>    {<span class="dv">24</span>, <span class="dv">40</span>},</span>
<span id="cb2-211"><a href="#cb2-211"></a>    {<span class="dv">24</span>, <span class="dv">56</span>},</span>
<span id="cb2-212"><a href="#cb2-212"></a>    {<span class="dv">25</span>, <span class="dv">29</span>},</span>
<span id="cb2-213"><a href="#cb2-213"></a>    {<span class="dv">25</span>, <span class="dv">41</span>},</span>
<span id="cb2-214"><a href="#cb2-214"></a>    {<span class="dv">25</span>, <span class="dv">57</span>},</span>
<span id="cb2-215"><a href="#cb2-215"></a>    {<span class="dv">26</span>, <span class="dv">30</span>},</span>
<span id="cb2-216"><a href="#cb2-216"></a>    {<span class="dv">26</span>, <span class="dv">42</span>},</span>
<span id="cb2-217"><a href="#cb2-217"></a>    {<span class="dv">26</span>, <span class="dv">58</span>},</span>
<span id="cb2-218"><a href="#cb2-218"></a>    {<span class="dv">27</span>, <span class="dv">31</span>},</span>
<span id="cb2-219"><a href="#cb2-219"></a>    {<span class="dv">27</span>, <span class="dv">43</span>},</span>
<span id="cb2-220"><a href="#cb2-220"></a>    {<span class="dv">27</span>, <span class="dv">59</span>},</span>
<span id="cb2-221"><a href="#cb2-221"></a>    {<span class="dv">28</span>, <span class="dv">44</span>},</span>
<span id="cb2-222"><a href="#cb2-222"></a>    {<span class="dv">28</span>, <span class="dv">60</span>},</span>
<span id="cb2-223"><a href="#cb2-223"></a>    {<span class="dv">29</span>, <span class="dv">45</span>},</span>
<span id="cb2-224"><a href="#cb2-224"></a>    {<span class="dv">29</span>, <span class="dv">61</span>},</span>
<span id="cb2-225"><a href="#cb2-225"></a>    {<span class="dv">30</span>, <span class="dv">46</span>},</span>
<span id="cb2-226"><a href="#cb2-226"></a>    {<span class="dv">30</span>, <span class="dv">62</span>},</span>
<span id="cb2-227"><a href="#cb2-227"></a>    {<span class="dv">31</span>, <span class="dv">47</span>},</span>
<span id="cb2-228"><a href="#cb2-228"></a>    {<span class="dv">31</span>, <span class="dv">63</span>},</span>
<span id="cb2-229"><a href="#cb2-229"></a>    {<span class="dv">32</span>, <span class="dv">34</span>},</span>
<span id="cb2-230"><a href="#cb2-230"></a>    {<span class="dv">32</span>, <span class="dv">48</span>},</span>
<span id="cb2-231"><a href="#cb2-231"></a>    {<span class="dv">33</span>, <span class="dv">35</span>},</span>
<span id="cb2-232"><a href="#cb2-232"></a>    {<span class="dv">33</span>, <span class="dv">49</span>},</span>
<span id="cb2-233"><a href="#cb2-233"></a>    {<span class="dv">34</span>, <span class="dv">50</span>},</span>
<span id="cb2-234"><a href="#cb2-234"></a>    {<span class="dv">35</span>, <span class="dv">51</span>},</span>
<span id="cb2-235"><a href="#cb2-235"></a>    {<span class="dv">36</span>, <span class="dv">38</span>},</span>
<span id="cb2-236"><a href="#cb2-236"></a>    {<span class="dv">36</span>, <span class="dv">52</span>},</span>
<span id="cb2-237"><a href="#cb2-237"></a>    {<span class="dv">37</span>, <span class="dv">39</span>},</span>
<span id="cb2-238"><a href="#cb2-238"></a>    {<span class="dv">37</span>, <span class="dv">53</span>},</span>
<span id="cb2-239"><a href="#cb2-239"></a>    {<span class="dv">38</span>, <span class="dv">54</span>},</span>
<span id="cb2-240"><a href="#cb2-240"></a>    {<span class="dv">39</span>, <span class="dv">55</span>},</span>
<span id="cb2-241"><a href="#cb2-241"></a>    {<span class="dv">40</span>, <span class="dv">42</span>},</span>
<span id="cb2-242"><a href="#cb2-242"></a>    {<span class="dv">40</span>, <span class="dv">56</span>},</span>
<span id="cb2-243"><a href="#cb2-243"></a>    {<span class="dv">41</span>, <span class="dv">43</span>},</span>
<span id="cb2-244"><a href="#cb2-244"></a>    {<span class="dv">41</span>, <span class="dv">57</span>},</span>
<span id="cb2-245"><a href="#cb2-245"></a>    {<span class="dv">42</span>, <span class="dv">58</span>},</span>
<span id="cb2-246"><a href="#cb2-246"></a>    {<span class="dv">43</span>, <span class="dv">59</span>},</span>
<span id="cb2-247"><a href="#cb2-247"></a>    {<span class="dv">44</span>, <span class="dv">46</span>},</span>
<span id="cb2-248"><a href="#cb2-248"></a>    {<span class="dv">44</span>, <span class="dv">60</span>},</span>
<span id="cb2-249"><a href="#cb2-249"></a>    {<span class="dv">45</span>, <span class="dv">47</span>},</span>
<span id="cb2-250"><a href="#cb2-250"></a>    {<span class="dv">45</span>, <span class="dv">61</span>},</span>
<span id="cb2-251"><a href="#cb2-251"></a>    {<span class="dv">46</span>, <span class="dv">62</span>},</span>
<span id="cb2-252"><a href="#cb2-252"></a>    {<span class="dv">47</span>, <span class="dv">63</span>},</span>
<span id="cb2-253"><a href="#cb2-253"></a>    {<span class="dv">48</span>, <span class="dv">49</span>},</span>
<span id="cb2-254"><a href="#cb2-254"></a>    {<span class="dv">50</span>, <span class="dv">51</span>},</span>
<span id="cb2-255"><a href="#cb2-255"></a>    {<span class="dv">52</span>, <span class="dv">53</span>},</span>
<span id="cb2-256"><a href="#cb2-256"></a>    {<span class="dv">54</span>, <span class="dv">55</span>},</span>
<span id="cb2-257"><a href="#cb2-257"></a>    {<span class="dv">56</span>, <span class="dv">57</span>},</span>
<span id="cb2-258"><a href="#cb2-258"></a>    {<span class="dv">58</span>, <span class="dv">59</span>},</span>
<span id="cb2-259"><a href="#cb2-259"></a>    {<span class="dv">60</span>, <span class="dv">61</span>},</span>
<span id="cb2-260"><a href="#cb2-260"></a>    {<span class="dv">62</span>, <span class="dv">63</span>} };</span>
<span id="cb2-261"><a href="#cb2-261"></a></span>
<span id="cb2-262"><a href="#cb2-262"></a><span class="co">// tetrahedra ------------------------------------------------------------------</span></span>
<span id="cb2-263"><a href="#cb2-263"></a><span class="dt">int</span>[][] tetrahedra = {</span>
<span id="cb2-264"><a href="#cb2-264"></a>    {<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">48</span>},</span>
<span id="cb2-265"><a href="#cb2-265"></a>    {<span class="dv">11</span>, <span class="dv">27</span>, <span class="dv">43</span>, <span class="dv">59</span>},</span>
<span id="cb2-266"><a href="#cb2-266"></a>    {<span class="dv">12</span>, <span class="dv">28</span>, <span class="dv">44</span>, <span class="dv">60</span>},</span>
<span id="cb2-267"><a href="#cb2-267"></a>    {<span class="dv">8</span>, <span class="dv">24</span>, <span class="dv">40</span>, <span class="dv">56</span>},</span>
<span id="cb2-268"><a href="#cb2-268"></a>    {<span class="dv">9</span>, <span class="dv">25</span>, <span class="dv">41</span>, <span class="dv">57</span>},</span>
<span id="cb2-269"><a href="#cb2-269"></a>    {<span class="dv">15</span>, <span class="dv">31</span>, <span class="dv">47</span>, <span class="dv">63</span>},</span>
<span id="cb2-270"><a href="#cb2-270"></a>    {<span class="dv">13</span>, <span class="dv">29</span>, <span class="dv">45</span>, <span class="dv">61</span>},</span>
<span id="cb2-271"><a href="#cb2-271"></a>    {<span class="dv">14</span>, <span class="dv">30</span>, <span class="dv">46</span>, <span class="dv">62</span>},</span>
<span id="cb2-272"><a href="#cb2-272"></a>    {<span class="dv">10</span>, <span class="dv">26</span>, <span class="dv">42</span>, <span class="dv">58</span>},</span>
<span id="cb2-273"><a href="#cb2-273"></a>    {<span class="dv">3</span>, <span class="dv">19</span>, <span class="dv">35</span>, <span class="dv">51</span>},</span>
<span id="cb2-274"><a href="#cb2-274"></a>    {<span class="dv">2</span>, <span class="dv">18</span>, <span class="dv">34</span>, <span class="dv">50</span>},</span>
<span id="cb2-275"><a href="#cb2-275"></a>    {<span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">33</span>, <span class="dv">49</span>},</span>
<span id="cb2-276"><a href="#cb2-276"></a>    {<span class="dv">4</span>, <span class="dv">20</span>, <span class="dv">36</span>, <span class="dv">52</span>},</span>
<span id="cb2-277"><a href="#cb2-277"></a>    {<span class="dv">5</span>, <span class="dv">21</span>, <span class="dv">37</span>, <span class="dv">53</span>},</span>
<span id="cb2-278"><a href="#cb2-278"></a>    {<span class="dv">6</span>, <span class="dv">22</span>, <span class="dv">38</span>, <span class="dv">54</span>},</span>
<span id="cb2-279"><a href="#cb2-279"></a>    {<span class="dv">7</span>, <span class="dv">23</span>, <span class="dv">39</span>, <span class="dv">55</span>} };</span>
<span id="cb2-280"><a href="#cb2-280"></a></span>
<span id="cb2-281"><a href="#cb2-281"></a><span class="co">// rotation in 4D space (right-isoclinic) --------------------------------------</span></span>
<span id="cb2-282"><a href="#cb2-282"></a>quadruple rotate4d(real alpha, real beta, real xi, quadruple vec){</span>
<span id="cb2-283"><a href="#cb2-283"></a>    real a = cos(xi);</span>
<span id="cb2-284"><a href="#cb2-284"></a>    real b = sin(alpha)*cos(beta)*sin(xi);</span>
<span id="cb2-285"><a href="#cb2-285"></a>    real c = sin(alpha)*sin(beta)*sin(xi);</span>
<span id="cb2-286"><a href="#cb2-286"></a>    real d = cos(alpha)*sin(xi);</span>
<span id="cb2-287"><a href="#cb2-287"></a>    real p = vec.x;</span>
<span id="cb2-288"><a href="#cb2-288"></a>    real q = vec.y;</span>
<span id="cb2-289"><a href="#cb2-289"></a>    real r = vec.z;</span>
<span id="cb2-290"><a href="#cb2-290"></a>    real s = vec.t;</span>
<span id="cb2-291"><a href="#cb2-291"></a>    quadruple out;</span>
<span id="cb2-292"><a href="#cb2-292"></a>    out.x = a*p - b*q - c*r - d*s;</span>
<span id="cb2-293"><a href="#cb2-293"></a>    out.y = a*q + b*p + c*s - d*r;</span>
<span id="cb2-294"><a href="#cb2-294"></a>    out.z = a*r - b*s + c*p + d*q;</span>
<span id="cb2-295"><a href="#cb2-295"></a>    out.t = a*s + b*r - c*q + d*p;</span>
<span id="cb2-296"><a href="#cb2-296"></a>    <span class="cf">return</span> out;</span>
<span id="cb2-297"><a href="#cb2-297"></a>}</span>
<span id="cb2-298"><a href="#cb2-298"></a></span>
<span id="cb2-299"><a href="#cb2-299"></a></span>
<span id="cb2-300"><a href="#cb2-300"></a><span class="co">// stereographic projection ----------------------------------------------------</span></span>
<span id="cb2-301"><a href="#cb2-301"></a>triple stereog(quadruple A, real r){</span>
<span id="cb2-302"><a href="#cb2-302"></a>    <span class="cf">return</span> (A.x, A.y, A.z) / (r - A.t);</span>
<span id="cb2-303"><a href="#cb2-303"></a>}</span>
<span id="cb2-304"><a href="#cb2-304"></a></span>
<span id="cb2-305"><a href="#cb2-305"></a><span class="co">// stereographic path ----------------------------------------------------------</span></span>
<span id="cb2-306"><a href="#cb2-306"></a>path3 stereoPath(quadruple A, quadruple B, real r, <span class="dt">int</span> n){</span>
<span id="cb2-307"><a href="#cb2-307"></a>    path3 out;</span>
<span id="cb2-308"><a href="#cb2-308"></a>    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt;= n; ++i){</span>
<span id="cb2-309"><a href="#cb2-309"></a>        real t = i/n;</span>
<span id="cb2-310"><a href="#cb2-310"></a>        quadruple M;</span>
<span id="cb2-311"><a href="#cb2-311"></a>        real x = (<span class="dv">1</span>-t)*A.x + t*B.x;</span>
<span id="cb2-312"><a href="#cb2-312"></a>        real y = (<span class="dv">1</span>-t)*A.y + t*B.y;</span>
<span id="cb2-313"><a href="#cb2-313"></a>        real z = (<span class="dv">1</span>-t)*A.z + t*B.z;</span>
<span id="cb2-314"><a href="#cb2-314"></a>        real t = (<span class="dv">1</span>-t)*A.t + t*B.t;</span>
<span id="cb2-315"><a href="#cb2-315"></a>        real lg = sqrt(x*x + y*y + z*z + t*t) / r;</span>
<span id="cb2-316"><a href="#cb2-316"></a>        M.x = x / lg; M.y = y / lg; M.z = z / lg; M.t = t / lg;</span>
<span id="cb2-317"><a href="#cb2-317"></a>        out = out .. stereog(M, r);</span>
<span id="cb2-318"><a href="#cb2-318"></a>    }</span>
<span id="cb2-319"><a href="#cb2-319"></a>    <span class="cf">return</span> out;</span>
<span id="cb2-320"><a href="#cb2-320"></a>}</span>
<span id="cb2-321"><a href="#cb2-321"></a></span>
<span id="cb2-322"><a href="#cb2-322"></a><span class="co">// section transformation ------------------------------------------------------</span></span>
<span id="cb2-323"><a href="#cb2-323"></a>transform T(path3 p3, real t, <span class="dt">int</span> n){</span>
<span id="cb2-324"><a href="#cb2-324"></a>    triple M = relpoint(p3, t/(n/<span class="dv">4</span>));</span>
<span id="cb2-325"><a href="#cb2-325"></a>    <span class="cf">return</span> scale(length(M)/<span class="dv">15</span>); </span>
<span id="cb2-326"><a href="#cb2-326"></a>}</span>
<span id="cb2-327"><a href="#cb2-327"></a></span>
<span id="cb2-328"><a href="#cb2-328"></a><span class="co">// stereographic subdivision (to fill the tetrahedra) --------------------------</span></span>
<span id="cb2-329"><a href="#cb2-329"></a>quadruple midpoint4(quadruple A, quadruple B, real r){</span>
<span id="cb2-330"><a href="#cb2-330"></a>    quadruple M;</span>
<span id="cb2-331"><a href="#cb2-331"></a>    real x = (A.x + B.x)/<span class="dv">2</span>;</span>
<span id="cb2-332"><a href="#cb2-332"></a>    real y = (A.y + B.y)/<span class="dv">2</span>;</span>
<span id="cb2-333"><a href="#cb2-333"></a>    real z = (A.z + B.z)/<span class="dv">2</span>;</span>
<span id="cb2-334"><a href="#cb2-334"></a>    real t = (A.t + B.t)/<span class="dv">2</span>;</span>
<span id="cb2-335"><a href="#cb2-335"></a>    real lg = sqrt(x*x + y*y + z*z + t*t) / r;</span>
<span id="cb2-336"><a href="#cb2-336"></a>    M.x = x / lg; M.y = y / lg; M.z = z / lg; M.t = t / lg;</span>
<span id="cb2-337"><a href="#cb2-337"></a>    <span class="cf">return</span>(M);</span>
<span id="cb2-338"><a href="#cb2-338"></a>} </span>
<span id="cb2-339"><a href="#cb2-339"></a></span>
<span id="cb2-340"><a href="#cb2-340"></a>quadruple[][] subdiv0(quadruple A, quadruple B, quadruple C, real r){</span>
<span id="cb2-341"><a href="#cb2-341"></a>    quadruple m01 = midpoint4(A, B, r);</span>
<span id="cb2-342"><a href="#cb2-342"></a>    quadruple m02 = midpoint4(A, C, r);</span>
<span id="cb2-343"><a href="#cb2-343"></a>    quadruple m12 = midpoint4(B, C, r);</span>
<span id="cb2-344"><a href="#cb2-344"></a>    <span class="cf">return</span> <span class="kw">new</span> quadruple[][] {</span>
<span id="cb2-345"><a href="#cb2-345"></a>        {A, m01, m02}, </span>
<span id="cb2-346"><a href="#cb2-346"></a>        {B, m12, m01}, </span>
<span id="cb2-347"><a href="#cb2-347"></a>        {C, m02, m12}, </span>
<span id="cb2-348"><a href="#cb2-348"></a>        {m01, m12, m02}</span>
<span id="cb2-349"><a href="#cb2-349"></a>    };</span>
<span id="cb2-350"><a href="#cb2-350"></a>}</span>
<span id="cb2-351"><a href="#cb2-351"></a></span>
<span id="cb2-352"><a href="#cb2-352"></a>quadruple[][] subdiv(<span class="dt">int</span> n, quadruple A, quadruple B, quadruple C, real r){</span>
<span id="cb2-353"><a href="#cb2-353"></a>  <span class="cf">if</span>(n == <span class="dv">1</span>){</span>
<span id="cb2-354"><a href="#cb2-354"></a>    <span class="cf">return</span> subdiv0(A, B, C, r);</span>
<span id="cb2-355"><a href="#cb2-355"></a>  }</span>
<span id="cb2-356"><a href="#cb2-356"></a>  quadruple[][] triangles = subdiv(n-<span class="dv">1</span>, A, B, C, r);</span>
<span id="cb2-357"><a href="#cb2-357"></a>  quadruple[][] out = <span class="kw">new</span> quadruple[<span class="dv">0</span>][<span class="dv">3</span>];</span>
<span id="cb2-358"><a href="#cb2-358"></a>  <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">4</span>^(n-<span class="dv">1</span>); ++i){</span>
<span id="cb2-359"><a href="#cb2-359"></a>    quadruple[] trgl = triangles[i];</span>
<span id="cb2-360"><a href="#cb2-360"></a>    out.append(subdiv0(trgl[<span class="dv">0</span>], trgl[<span class="dv">1</span>], trgl[<span class="dv">2</span>], r));</span>
<span id="cb2-361"><a href="#cb2-361"></a>  }</span>
<span id="cb2-362"><a href="#cb2-362"></a>  <span class="cf">return</span> out;</span>
<span id="cb2-363"><a href="#cb2-363"></a>}</span>
<span id="cb2-364"><a href="#cb2-364"></a></span>
<span id="cb2-365"><a href="#cb2-365"></a><span class="co">// mesh maker ------------------------------------------------------------------</span></span>
<span id="cb2-366"><a href="#cb2-366"></a><span class="kw">struct</span> Mesh {</span>
<span id="cb2-367"><a href="#cb2-367"></a>    triple[] vertices;</span>
<span id="cb2-368"><a href="#cb2-368"></a>    <span class="dt">int</span>[][] indices;</span>
<span id="cb2-369"><a href="#cb2-369"></a>}</span>
<span id="cb2-370"><a href="#cb2-370"></a>Mesh stereoTriangle(<span class="dt">int</span> n, quadruple A, quadruple B, quadruple C, real r){</span>
<span id="cb2-371"><a href="#cb2-371"></a>    quadruple[][] triangles = subdiv(n, A, B, C, r);</span>
<span id="cb2-372"><a href="#cb2-372"></a>    triple[] vertices;</span>
<span id="cb2-373"><a href="#cb2-373"></a>    <span class="dt">int</span>[][] indices;</span>
<span id="cb2-374"><a href="#cb2-374"></a>    <span class="dt">int</span> faceIndex = <span class="dv">0</span>;</span>
<span id="cb2-375"><a href="#cb2-375"></a>    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; triangles.length; ++i){</span>
<span id="cb2-376"><a href="#cb2-376"></a>        quadruple[] triangle = triangles[i];</span>
<span id="cb2-377"><a href="#cb2-377"></a>        vertices.push(stereog(triangle[<span class="dv">0</span>], r));</span>
<span id="cb2-378"><a href="#cb2-378"></a>        vertices.push(stereog(triangle[<span class="dv">1</span>], r));</span>
<span id="cb2-379"><a href="#cb2-379"></a>        vertices.push(stereog(triangle[<span class="dv">2</span>], r));</span>
<span id="cb2-380"><a href="#cb2-380"></a>        <span class="dt">int</span>[] x = {faceIndex, faceIndex+<span class="dv">1</span>, faceIndex+<span class="dv">2</span>};</span>
<span id="cb2-381"><a href="#cb2-381"></a>        indices.push(x);</span>
<span id="cb2-382"><a href="#cb2-382"></a>        faceIndex += <span class="dv">3</span>;</span>
<span id="cb2-383"><a href="#cb2-383"></a>    }</span>
<span id="cb2-384"><a href="#cb2-384"></a>    Mesh out;</span>
<span id="cb2-385"><a href="#cb2-385"></a>    out.vertices = vertices;</span>
<span id="cb2-386"><a href="#cb2-386"></a>    out.indices = indices;</span>
<span id="cb2-387"><a href="#cb2-387"></a>    <span class="cf">return</span> out;</span>
<span id="cb2-388"><a href="#cb2-388"></a>}</span>
<span id="cb2-389"><a href="#cb2-389"></a></span>
<span id="cb2-390"><a href="#cb2-390"></a></span>
<span id="cb2-391"><a href="#cb2-391"></a><span class="co">// &quot;bounding box&quot; (to clip the animation) --------------------------------------</span></span>
<span id="cb2-392"><a href="#cb2-392"></a>path3 boundingbox = scale(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">1</span>)*circle(c=O, r=<span class="dv">4</span>, normal=Z);</span>
<span id="cb2-393"><a href="#cb2-393"></a></span>
<span id="cb2-394"><a href="#cb2-394"></a><span class="co">// plot ------------------------------------------------------------------------</span></span>
<span id="cb2-395"><a href="#cb2-395"></a><span class="dt">int</span> n = <span class="dv">75</span>;</span>
<span id="cb2-396"><a href="#cb2-396"></a><span class="dt">int</span> depth = <span class="dv">6</span>;</span>
<span id="cb2-397"><a href="#cb2-397"></a>real alpha = <span class="dv">0</span>, beta = <span class="dv">0</span>;</span>
<span id="cb2-398"><a href="#cb2-398"></a></span>
<span id="cb2-399"><a href="#cb2-399"></a><span class="cf">for</span>(<span class="dt">int</span> f = <span class="dv">0</span>; f &lt; <span class="dv">180</span>; ++f){</span>
<span id="cb2-400"><a href="#cb2-400"></a>    <span class="co">// rotation angle</span></span>
<span id="cb2-401"><a href="#cb2-401"></a>    real xi = <span class="dv">2</span>*f*pi/<span class="dv">180</span>;</span>
<span id="cb2-402"><a href="#cb2-402"></a>    <span class="co">// rotated vertices</span></span>
<span id="cb2-403"><a href="#cb2-403"></a>    quadruple[] vs = <span class="kw">new</span> quadruple[vertices.length];</span>
<span id="cb2-404"><a href="#cb2-404"></a>    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; vertices.length; ++i){</span>
<span id="cb2-405"><a href="#cb2-405"></a>        vs[i] = rotate4d(alpha, beta, xi, vertices[i]);</span>
<span id="cb2-406"><a href="#cb2-406"></a>    }</span>
<span id="cb2-407"><a href="#cb2-407"></a>    <span class="co">// new picture</span></span>
<span id="cb2-408"><a href="#cb2-408"></a>    picture pic;</span>
<span id="cb2-409"><a href="#cb2-409"></a>    <span class="co">// draw boundingbox</span></span>
<span id="cb2-410"><a href="#cb2-410"></a>    draw(pic, boundingbox, rgb(<span class="st">&quot;363940ff&quot;</span>)+opacity(<span class="dv">0</span>));</span>
<span id="cb2-411"><a href="#cb2-411"></a>    <span class="co">// draw edges</span></span>
<span id="cb2-412"><a href="#cb2-412"></a>    <span class="cf">for</span>(<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; edges.length; ++k){</span>
<span id="cb2-413"><a href="#cb2-413"></a>        quadruple A = vs[edges[k][<span class="dv">0</span>]];</span>
<span id="cb2-414"><a href="#cb2-414"></a>        quadruple B = vs[edges[k][<span class="dv">1</span>]];</span>
<span id="cb2-415"><a href="#cb2-415"></a>        path3 p3 = stereoPath(A, B, r, n);</span>
<span id="cb2-416"><a href="#cb2-416"></a>        transform S(real t){</span>
<span id="cb2-417"><a href="#cb2-417"></a>            <span class="cf">return</span> T(p3, t, n);</span>
<span id="cb2-418"><a href="#cb2-418"></a>        }</span>
<span id="cb2-419"><a href="#cb2-419"></a>        draw(pic, tube(p3, unitcircle, S), rgb(<span class="dv">139</span>, <span class="dv">0</span>, <span class="dv">139</span>), </span>
<span id="cb2-420"><a href="#cb2-420"></a>                render(compression=Low, merge=<span class="kw">true</span>));</span>
<span id="cb2-421"><a href="#cb2-421"></a>    }</span>
<span id="cb2-422"><a href="#cb2-422"></a>    <span class="co">// draw vertices</span></span>
<span id="cb2-423"><a href="#cb2-423"></a>    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; vertices.length; ++i){</span>
<span id="cb2-424"><a href="#cb2-424"></a>        triple Asg = stereog(vs[i], r);</span>
<span id="cb2-425"><a href="#cb2-425"></a>        draw(pic, shift(Asg)*scale3(length(Asg)/<span class="dv">10</span>)*unitsphere, purple);</span>
<span id="cb2-426"><a href="#cb2-426"></a>    }</span>
<span id="cb2-427"><a href="#cb2-427"></a>    <span class="co">// draw tetrahedra</span></span>
<span id="cb2-428"><a href="#cb2-428"></a>    <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; tetrahedra.length; ++i){</span>
<span id="cb2-429"><a href="#cb2-429"></a>        <span class="dt">int</span>[] t = tetrahedra[i];</span>
<span id="cb2-430"><a href="#cb2-430"></a>        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">0</span>]], vs[t[<span class="dv">1</span>]], vs[t[<span class="dv">2</span>]], r);</span>
<span id="cb2-431"><a href="#cb2-431"></a>        draw(pic, mesh.vertices, mesh.indices, m = red);</span>
<span id="cb2-432"><a href="#cb2-432"></a>        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">0</span>]], vs[t[<span class="dv">1</span>]], vs[t[<span class="dv">3</span>]], r);</span>
<span id="cb2-433"><a href="#cb2-433"></a>        draw(pic, mesh.vertices, mesh.indices, m = red);</span>
<span id="cb2-434"><a href="#cb2-434"></a>        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">0</span>]], vs[t[<span class="dv">2</span>]], vs[t[<span class="dv">3</span>]], r);</span>
<span id="cb2-435"><a href="#cb2-435"></a>        draw(pic, mesh.vertices, mesh.indices, m = red);</span>
<span id="cb2-436"><a href="#cb2-436"></a>        Mesh mesh = stereoTriangle(depth, vs[t[<span class="dv">1</span>]], vs[t[<span class="dv">2</span>]], vs[t[<span class="dv">3</span>]], r);</span>
<span id="cb2-437"><a href="#cb2-437"></a>        draw(pic, mesh.vertices, mesh.indices, m = red);</span>
<span id="cb2-438"><a href="#cb2-438"></a>    }</span>
<span id="cb2-439"><a href="#cb2-439"></a>    <span class="co">// add picture and save</span></span>
<span id="cb2-440"><a href="#cb2-440"></a>    add(pic);</span>
<span id="cb2-441"><a href="#cb2-441"></a>    shipout(files[f], bbox(rgb(<span class="st">&quot;363940ff&quot;</span>), FillDraw(rgb(<span class="st">&quot;363940ff&quot;</span>))));</span>
<span id="cb2-442"><a href="#cb2-442"></a>    erase();</span>
<span id="cb2-443"><a href="#cb2-443"></a>}   </span></code></pre></div>
<p><img src="figures/truncatedTesseract_stereographic_asy.gif" /></p>
<h1 id="drawing-with-pov-ray">Drawing with POV-Ray</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource povray numberLines"><code class="sourceCode povray"><span id="cb3-1"><a href="#cb3-1"></a><span class="ot">#version</span> <span class="fl">3.7</span>;</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">global_settings</span> { <span class="kw">assumed_gamma</span> <span class="fl">1</span> }</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="ot">#include</span> <span class="st">&quot;colors.inc&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="ot">#include</span> <span class="st">&quot;textures.inc&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">/* camera */</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">camera</span> {</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="kw">location</span> &lt;-<span class="fl">11</span>, <span class="fl">7</span>,-<span class="fl">32</span>&gt;</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="kw">look_at</span> <span class="fl">0</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="kw">angle</span> <span class="fl">45</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>}</span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">// sun -------------------------------------------------------------------------</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="kw">light_source</span> {&lt; <span class="fl">1000</span>,<span class="fl">3000</span>,-<span class="fl">6000</span>&gt; <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">0.9</span>}             <span class="co">// sun </span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="kw">light_source</span> {&lt;-<span class="fl">11</span>, <span class="fl">7</span>,-<span class="fl">32</span>&gt;  <span class="kw">color</span> <span class="kw">rgb</span>&lt;<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">1</span>&gt;*<span class="fl">0.1</span> <span class="kw">shadowless</span>}   <span class="co">// flash</span></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">// sky -------------------------------------------------------------------------</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="kw">plane</span>{&lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;,<span class="fl">1</span> <span class="kw">hollow</span>  </span>
<span id="cb3-19"><a href="#cb3-19"></a>       <span class="kw">texture</span>{ <span class="kw">pigment</span>{ <span class="kw">bozo</span> <span class="kw">turbulence</span> <span class="fl">1.3</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>                         <span class="kw">color_map</span> { [<span class="fl">0.00</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</span>
<span id="cb3-21"><a href="#cb3-21"></a>                                     [<span class="fl">0.75</span> <span class="kw">rgb</span> &lt;<span class="fl">0.24</span>, <span class="fl">0.32</span>, <span class="fl">1.0</span>&gt;*<span class="fl">0.6</span>]</span>
<span id="cb3-22"><a href="#cb3-22"></a>                                     [<span class="fl">0.83</span> <span class="kw">rgb</span> &lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;]</span>
<span id="cb3-23"><a href="#cb3-23"></a>                                     [<span class="fl">0.95</span> <span class="kw">rgb</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;]</span>
<span id="cb3-24"><a href="#cb3-24"></a>                                     [<span class="fl">1.0</span> <span class="kw">rgb</span> &lt;<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>&gt;]}</span>
<span id="cb3-25"><a href="#cb3-25"></a>                        <span class="kw">scale</span>&lt;<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>&gt;*<span class="fl">2.5</span>  <span class="kw">translate</span>&lt; <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span>&gt;</span>
<span id="cb3-26"><a href="#cb3-26"></a>                       }</span>
<span id="cb3-27"><a href="#cb3-27"></a>                <span class="kw">finish</span> {<span class="kw">ambient</span> <span class="fl">1</span> <span class="kw">diffuse</span> <span class="fl">0</span>} }      </span>
<span id="cb3-28"><a href="#cb3-28"></a>       <span class="kw">scale</span> <span class="fl">10000</span>}</span>
<span id="cb3-29"><a href="#cb3-29"></a></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">// fog on the ground -----------------------------------------------------------</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="kw">fog</span> { <span class="kw">fog_type</span>   <span class="fl">2</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>      <span class="kw">distance</span>   <span class="fl">50</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>      <span class="kw">color</span>      Gray10  </span>
<span id="cb3-34"><a href="#cb3-34"></a>      <span class="kw">fog_offset</span> <span class="fl">0.1</span></span>
<span id="cb3-35"><a href="#cb3-35"></a>      <span class="kw">fog_alt</span>    <span class="fl">1.5</span></span>
<span id="cb3-36"><a href="#cb3-36"></a>      <span class="kw">turbulence</span> <span class="fl">1.8</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>    }</span>
<span id="cb3-38"><a href="#cb3-38"></a></span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="co">// ground ----------------------------------------------------------------------</span></span>
<span id="cb3-40"><a href="#cb3-40"></a><span class="kw">plane</span> { &lt;<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>&gt;, <span class="fl">0</span> </span>
<span id="cb3-41"><a href="#cb3-41"></a>    <span class="kw">texture</span> {</span>
<span id="cb3-42"><a href="#cb3-42"></a>        <span class="kw">pigment</span> { <span class="kw">color</span> <span class="kw">rgb</span> &lt;<span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.73</span>&gt;*<span class="fl">0.35</span> }</span>
<span id="cb3-43"><a href="#cb3-43"></a>        <span class="kw">normal</span> { <span class="kw">bumps</span> <span class="fl">2</span> <span class="kw">scale</span> &lt;<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>&gt;*<span class="fl">0.5</span> <span class="kw">turbulence</span> <span class="fl">0.5</span> } </span>
<span id="cb3-44"><a href="#cb3-44"></a>        <span class="kw">finish</span> { <span class="kw">phong</span> <span class="fl">0.1</span> }</span>
<span id="cb3-45"><a href="#cb3-45"></a>    } </span>
<span id="cb3-46"><a href="#cb3-46"></a>} </span>
<span id="cb3-47"><a href="#cb3-47"></a></span>
<span id="cb3-48"><a href="#cb3-48"></a></span>
<span id="cb3-49"><a href="#cb3-49"></a><span class="co">/* vertices */</span></span>
<span id="cb3-50"><a href="#cb3-50"></a><span class="kw">#declare sqr2p1 </span>= <span class="kw">sqrt</span>(<span class="fl">2</span>) + <span class="fl">1</span>;</span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="kw">#declare v0 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-52"><a href="#cb3-52"></a><span class="kw">#declare v1 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-53"><a href="#cb3-53"></a><span class="kw">#declare v2 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-54"><a href="#cb3-54"></a><span class="kw">#declare v3 </span>= &lt; <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-55"><a href="#cb3-55"></a><span class="kw">#declare v4 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-56"><a href="#cb3-56"></a><span class="kw">#declare v5 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-57"><a href="#cb3-57"></a><span class="kw">#declare v6 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-58"><a href="#cb3-58"></a><span class="kw">#declare v7 </span>= &lt; <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-59"><a href="#cb3-59"></a><span class="kw">#declare v8 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-60"><a href="#cb3-60"></a><span class="kw">#declare v9 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-61"><a href="#cb3-61"></a><span class="kw">#declare v10 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-62"><a href="#cb3-62"></a><span class="kw">#declare v11 </span>= &lt; <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-63"><a href="#cb3-63"></a><span class="kw">#declare v12 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-64"><a href="#cb3-64"></a><span class="kw">#declare v13 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-65"><a href="#cb3-65"></a><span class="kw">#declare v14 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-66"><a href="#cb3-66"></a><span class="kw">#declare v15 </span>= &lt; <span class="fl">1.0</span> , sqr2p1 , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-67"><a href="#cb3-67"></a><span class="kw">#declare v16 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-68"><a href="#cb3-68"></a><span class="kw">#declare v17 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-69"><a href="#cb3-69"></a><span class="kw">#declare v18 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-70"><a href="#cb3-70"></a><span class="kw">#declare v19 </span>= &lt; -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-71"><a href="#cb3-71"></a><span class="kw">#declare v20 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-72"><a href="#cb3-72"></a><span class="kw">#declare v21 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-73"><a href="#cb3-73"></a><span class="kw">#declare v22 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-74"><a href="#cb3-74"></a><span class="kw">#declare v23 </span>= &lt; -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-75"><a href="#cb3-75"></a><span class="kw">#declare v24 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-76"><a href="#cb3-76"></a><span class="kw">#declare v25 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-77"><a href="#cb3-77"></a><span class="kw">#declare v26 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-78"><a href="#cb3-78"></a><span class="kw">#declare v27 </span>= &lt; sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-79"><a href="#cb3-79"></a><span class="kw">#declare v28 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-80"><a href="#cb3-80"></a><span class="kw">#declare v29 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-81"><a href="#cb3-81"></a><span class="kw">#declare v30 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , -sqr2p1 &gt;;</span>
<span id="cb3-82"><a href="#cb3-82"></a><span class="kw">#declare v31 </span>= &lt; sqr2p1 , <span class="fl">1.0</span> , sqr2p1 , sqr2p1 &gt;;</span>
<span id="cb3-83"><a href="#cb3-83"></a><span class="kw">#declare v32 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-84"><a href="#cb3-84"></a><span class="kw">#declare v33 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-85"><a href="#cb3-85"></a><span class="kw">#declare v34 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-86"><a href="#cb3-86"></a><span class="kw">#declare v35 </span>= &lt; -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-87"><a href="#cb3-87"></a><span class="kw">#declare v36 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-88"><a href="#cb3-88"></a><span class="kw">#declare v37 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-89"><a href="#cb3-89"></a><span class="kw">#declare v38 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-90"><a href="#cb3-90"></a><span class="kw">#declare v39 </span>= &lt; -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-91"><a href="#cb3-91"></a><span class="kw">#declare v40 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-92"><a href="#cb3-92"></a><span class="kw">#declare v41 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-93"><a href="#cb3-93"></a><span class="kw">#declare v42 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-94"><a href="#cb3-94"></a><span class="kw">#declare v43 </span>= &lt; sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-95"><a href="#cb3-95"></a><span class="kw">#declare v44 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-96"><a href="#cb3-96"></a><span class="kw">#declare v45 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-97"><a href="#cb3-97"></a><span class="kw">#declare v46 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , -sqr2p1 &gt;;</span>
<span id="cb3-98"><a href="#cb3-98"></a><span class="kw">#declare v47 </span>= &lt; sqr2p1 , sqr2p1 , <span class="fl">1.0</span> , sqr2p1 &gt;;</span>
<span id="cb3-99"><a href="#cb3-99"></a><span class="kw">#declare v48 </span>= &lt; -sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-100"><a href="#cb3-100"></a><span class="kw">#declare v49 </span>= &lt; -sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-101"><a href="#cb3-101"></a><span class="kw">#declare v50 </span>= &lt; -sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-102"><a href="#cb3-102"></a><span class="kw">#declare v51 </span>= &lt; -sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-103"><a href="#cb3-103"></a><span class="kw">#declare v52 </span>= &lt; -sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-104"><a href="#cb3-104"></a><span class="kw">#declare v53 </span>= &lt; -sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-105"><a href="#cb3-105"></a><span class="kw">#declare v54 </span>= &lt; -sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-106"><a href="#cb3-106"></a><span class="kw">#declare v55 </span>= &lt; -sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-107"><a href="#cb3-107"></a><span class="kw">#declare v56 </span>= &lt; sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-108"><a href="#cb3-108"></a><span class="kw">#declare v57 </span>= &lt; sqr2p1 , -sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-109"><a href="#cb3-109"></a><span class="kw">#declare v58 </span>= &lt; sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-110"><a href="#cb3-110"></a><span class="kw">#declare v59 </span>= &lt; sqr2p1 , -sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-111"><a href="#cb3-111"></a><span class="kw">#declare v60 </span>= &lt; sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-112"><a href="#cb3-112"></a><span class="kw">#declare v61 </span>= &lt; sqr2p1 , sqr2p1 , -sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-113"><a href="#cb3-113"></a><span class="kw">#declare v62 </span>= &lt; sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">-1.0</span> &gt;;</span>
<span id="cb3-114"><a href="#cb3-114"></a><span class="kw">#declare v63 </span>= &lt; sqr2p1 , sqr2p1 , sqr2p1 , <span class="fl">1.0</span> &gt;;</span>
<span id="cb3-115"><a href="#cb3-115"></a><span class="kw">#declare vertices </span>= <span class="kw">array</span>[<span class="fl">64</span>] </span>
<span id="cb3-116"><a href="#cb3-116"></a>    {v0,v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,</span>
<span id="cb3-117"><a href="#cb3-117"></a>    v16,v17,v18,v19,v20,v21,v22,v23,v24,v25,v26,v27,v28,v29,v30,v31,</span>
<span id="cb3-118"><a href="#cb3-118"></a>    v32,v33,v34,v35,v36,v37,v38,v39,v40,v41,v42,v43,v44,v45,v46,v47,</span>
<span id="cb3-119"><a href="#cb3-119"></a>    v48,v49,v50,v51,v52,v53,v54,v55,v56,v57,v58,v59,v60,v61,v62,v63};</span>
<span id="cb3-120"><a href="#cb3-120"></a></span>
<span id="cb3-121"><a href="#cb3-121"></a><span class="co">/* edges */</span></span>
<span id="cb3-122"><a href="#cb3-122"></a><span class="kw">#declare edges </span>= <span class="kw">array</span>[<span class="fl">128</span>][<span class="fl">2</span>] </span>
<span id="cb3-123"><a href="#cb3-123"></a>{ { <span class="fl">0</span> , <span class="fl">8</span> }</span>
<span id="cb3-124"><a href="#cb3-124"></a>, { <span class="fl">0</span> , <span class="fl">16</span> }</span>
<span id="cb3-125"><a href="#cb3-125"></a>, { <span class="fl">0</span> , <span class="fl">32</span> }</span>
<span id="cb3-126"><a href="#cb3-126"></a>, { <span class="fl">0</span> , <span class="fl">48</span> }</span>
<span id="cb3-127"><a href="#cb3-127"></a>, { <span class="fl">1</span> , <span class="fl">9</span> }</span>
<span id="cb3-128"><a href="#cb3-128"></a>, { <span class="fl">1</span> , <span class="fl">17</span> }</span>
<span id="cb3-129"><a href="#cb3-129"></a>, { <span class="fl">1</span> , <span class="fl">33</span> }</span>
<span id="cb3-130"><a href="#cb3-130"></a>, { <span class="fl">1</span> , <span class="fl">49</span> }</span>
<span id="cb3-131"><a href="#cb3-131"></a>, { <span class="fl">2</span> , <span class="fl">10</span> }</span>
<span id="cb3-132"><a href="#cb3-132"></a>, { <span class="fl">2</span> , <span class="fl">18</span> }</span>
<span id="cb3-133"><a href="#cb3-133"></a>, { <span class="fl">2</span> , <span class="fl">34</span> }</span>
<span id="cb3-134"><a href="#cb3-134"></a>, { <span class="fl">2</span> , <span class="fl">50</span> }</span>
<span id="cb3-135"><a href="#cb3-135"></a>, { <span class="fl">3</span> , <span class="fl">11</span> }</span>
<span id="cb3-136"><a href="#cb3-136"></a>, { <span class="fl">3</span> , <span class="fl">19</span> }</span>
<span id="cb3-137"><a href="#cb3-137"></a>, { <span class="fl">3</span> , <span class="fl">35</span> }</span>
<span id="cb3-138"><a href="#cb3-138"></a>, { <span class="fl">3</span> , <span class="fl">51</span> }</span>
<span id="cb3-139"><a href="#cb3-139"></a>, { <span class="fl">4</span> , <span class="fl">12</span> }</span>
<span id="cb3-140"><a href="#cb3-140"></a>, { <span class="fl">4</span> , <span class="fl">20</span> }</span>
<span id="cb3-141"><a href="#cb3-141"></a>, { <span class="fl">4</span> , <span class="fl">36</span> }</span>
<span id="cb3-142"><a href="#cb3-142"></a>, { <span class="fl">4</span> , <span class="fl">52</span> }</span>
<span id="cb3-143"><a href="#cb3-143"></a>, { <span class="fl">5</span> , <span class="fl">13</span> }</span>
<span id="cb3-144"><a href="#cb3-144"></a>, { <span class="fl">5</span> , <span class="fl">21</span> }</span>
<span id="cb3-145"><a href="#cb3-145"></a>, { <span class="fl">5</span> , <span class="fl">37</span> }</span>
<span id="cb3-146"><a href="#cb3-146"></a>, { <span class="fl">5</span> , <span class="fl">53</span> }</span>
<span id="cb3-147"><a href="#cb3-147"></a>, { <span class="fl">6</span> , <span class="fl">14</span> }</span>
<span id="cb3-148"><a href="#cb3-148"></a>, { <span class="fl">6</span> , <span class="fl">22</span> }</span>
<span id="cb3-149"><a href="#cb3-149"></a>, { <span class="fl">6</span> , <span class="fl">38</span> }</span>
<span id="cb3-150"><a href="#cb3-150"></a>, { <span class="fl">6</span> , <span class="fl">54</span> }</span>
<span id="cb3-151"><a href="#cb3-151"></a>, { <span class="fl">7</span> , <span class="fl">15</span> }</span>
<span id="cb3-152"><a href="#cb3-152"></a>, { <span class="fl">7</span> , <span class="fl">23</span> }</span>
<span id="cb3-153"><a href="#cb3-153"></a>, { <span class="fl">7</span> , <span class="fl">39</span> }</span>
<span id="cb3-154"><a href="#cb3-154"></a>, { <span class="fl">7</span> , <span class="fl">55</span> }</span>
<span id="cb3-155"><a href="#cb3-155"></a>, { <span class="fl">8</span> , <span class="fl">24</span> }</span>
<span id="cb3-156"><a href="#cb3-156"></a>, { <span class="fl">8</span> , <span class="fl">40</span> }</span>
<span id="cb3-157"><a href="#cb3-157"></a>, { <span class="fl">8</span> , <span class="fl">56</span> }</span>
<span id="cb3-158"><a href="#cb3-158"></a>, { <span class="fl">9</span> , <span class="fl">25</span> }</span>
<span id="cb3-159"><a href="#cb3-159"></a>, { <span class="fl">9</span> , <span class="fl">41</span> }</span>
<span id="cb3-160"><a href="#cb3-160"></a>, { <span class="fl">9</span> , <span class="fl">57</span> }</span>
<span id="cb3-161"><a href="#cb3-161"></a>, { <span class="fl">10</span> , <span class="fl">26</span> }</span>
<span id="cb3-162"><a href="#cb3-162"></a>, { <span class="fl">10</span> , <span class="fl">42</span> }</span>
<span id="cb3-163"><a href="#cb3-163"></a>, { <span class="fl">10</span> , <span class="fl">58</span> }</span>
<span id="cb3-164"><a href="#cb3-164"></a>, { <span class="fl">11</span> , <span class="fl">27</span> }</span>
<span id="cb3-165"><a href="#cb3-165"></a>, { <span class="fl">11</span> , <span class="fl">43</span> }</span>
<span id="cb3-166"><a href="#cb3-166"></a>, { <span class="fl">11</span> , <span class="fl">59</span> }</span>
<span id="cb3-167"><a href="#cb3-167"></a>, { <span class="fl">12</span> , <span class="fl">28</span> }</span>
<span id="cb3-168"><a href="#cb3-168"></a>, { <span class="fl">12</span> , <span class="fl">44</span> }</span>
<span id="cb3-169"><a href="#cb3-169"></a>, { <span class="fl">12</span> , <span class="fl">60</span> }</span>
<span id="cb3-170"><a href="#cb3-170"></a>, { <span class="fl">13</span> , <span class="fl">29</span> }</span>
<span id="cb3-171"><a href="#cb3-171"></a>, { <span class="fl">13</span> , <span class="fl">45</span> }</span>
<span id="cb3-172"><a href="#cb3-172"></a>, { <span class="fl">13</span> , <span class="fl">61</span> }</span>
<span id="cb3-173"><a href="#cb3-173"></a>, { <span class="fl">14</span> , <span class="fl">30</span> }</span>
<span id="cb3-174"><a href="#cb3-174"></a>, { <span class="fl">14</span> , <span class="fl">46</span> }</span>
<span id="cb3-175"><a href="#cb3-175"></a>, { <span class="fl">14</span> , <span class="fl">62</span> }</span>
<span id="cb3-176"><a href="#cb3-176"></a>, { <span class="fl">15</span> , <span class="fl">31</span> }</span>
<span id="cb3-177"><a href="#cb3-177"></a>, { <span class="fl">15</span> , <span class="fl">47</span> }</span>
<span id="cb3-178"><a href="#cb3-178"></a>, { <span class="fl">15</span> , <span class="fl">63</span> }</span>
<span id="cb3-179"><a href="#cb3-179"></a>, { <span class="fl">16</span> , <span class="fl">20</span> }</span>
<span id="cb3-180"><a href="#cb3-180"></a>, { <span class="fl">16</span> , <span class="fl">32</span> }</span>
<span id="cb3-181"><a href="#cb3-181"></a>, { <span class="fl">16</span> , <span class="fl">48</span> }</span>
<span id="cb3-182"><a href="#cb3-182"></a>, { <span class="fl">17</span> , <span class="fl">21</span> }</span>
<span id="cb3-183"><a href="#cb3-183"></a>, { <span class="fl">17</span> , <span class="fl">33</span> }</span>
<span id="cb3-184"><a href="#cb3-184"></a>, { <span class="fl">17</span> , <span class="fl">49</span> }</span>
<span id="cb3-185"><a href="#cb3-185"></a>, { <span class="fl">18</span> , <span class="fl">22</span> }</span>
<span id="cb3-186"><a href="#cb3-186"></a>, { <span class="fl">18</span> , <span class="fl">34</span> }</span>
<span id="cb3-187"><a href="#cb3-187"></a>, { <span class="fl">18</span> , <span class="fl">50</span> }</span>
<span id="cb3-188"><a href="#cb3-188"></a>, { <span class="fl">19</span> , <span class="fl">23</span> }</span>
<span id="cb3-189"><a href="#cb3-189"></a>, { <span class="fl">19</span> , <span class="fl">35</span> }</span>
<span id="cb3-190"><a href="#cb3-190"></a>, { <span class="fl">19</span> , <span class="fl">51</span> }</span>
<span id="cb3-191"><a href="#cb3-191"></a>, { <span class="fl">20</span> , <span class="fl">36</span> }</span>
<span id="cb3-192"><a href="#cb3-192"></a>, { <span class="fl">20</span> , <span class="fl">52</span> }</span>
<span id="cb3-193"><a href="#cb3-193"></a>, { <span class="fl">21</span> , <span class="fl">37</span> }</span>
<span id="cb3-194"><a href="#cb3-194"></a>, { <span class="fl">21</span> , <span class="fl">53</span> }</span>
<span id="cb3-195"><a href="#cb3-195"></a>, { <span class="fl">22</span> , <span class="fl">38</span> }</span>
<span id="cb3-196"><a href="#cb3-196"></a>, { <span class="fl">22</span> , <span class="fl">54</span> }</span>
<span id="cb3-197"><a href="#cb3-197"></a>, { <span class="fl">23</span> , <span class="fl">39</span> }</span>
<span id="cb3-198"><a href="#cb3-198"></a>, { <span class="fl">23</span> , <span class="fl">55</span> }</span>
<span id="cb3-199"><a href="#cb3-199"></a>, { <span class="fl">24</span> , <span class="fl">28</span> }</span>
<span id="cb3-200"><a href="#cb3-200"></a>, { <span class="fl">24</span> , <span class="fl">40</span> }</span>
<span id="cb3-201"><a href="#cb3-201"></a>, { <span class="fl">24</span> , <span class="fl">56</span> }</span>
<span id="cb3-202"><a href="#cb3-202"></a>, { <span class="fl">25</span> , <span class="fl">29</span> }</span>
<span id="cb3-203"><a href="#cb3-203"></a>, { <span class="fl">25</span> , <span class="fl">41</span> }</span>
<span id="cb3-204"><a href="#cb3-204"></a>, { <span class="fl">25</span> , <span class="fl">57</span> }</span>
<span id="cb3-205"><a href="#cb3-205"></a>, { <span class="fl">26</span> , <span class="fl">30</span> }</span>
<span id="cb3-206"><a href="#cb3-206"></a>, { <span class="fl">26</span> , <span class="fl">42</span> }</span>
<span id="cb3-207"><a href="#cb3-207"></a>, { <span class="fl">26</span> , <span class="fl">58</span> }</span>
<span id="cb3-208"><a href="#cb3-208"></a>, { <span class="fl">27</span> , <span class="fl">31</span> }</span>
<span id="cb3-209"><a href="#cb3-209"></a>, { <span class="fl">27</span> , <span class="fl">43</span> }</span>
<span id="cb3-210"><a href="#cb3-210"></a>, { <span class="fl">27</span> , <span class="fl">59</span> }</span>
<span id="cb3-211"><a href="#cb3-211"></a>, { <span class="fl">28</span> , <span class="fl">44</span> }</span>
<span id="cb3-212"><a href="#cb3-212"></a>, { <span class="fl">28</span> , <span class="fl">60</span> }</span>
<span id="cb3-213"><a href="#cb3-213"></a>, { <span class="fl">29</span> , <span class="fl">45</span> }</span>
<span id="cb3-214"><a href="#cb3-214"></a>, { <span class="fl">29</span> , <span class="fl">61</span> }</span>
<span id="cb3-215"><a href="#cb3-215"></a>, { <span class="fl">30</span> , <span class="fl">46</span> }</span>
<span id="cb3-216"><a href="#cb3-216"></a>, { <span class="fl">30</span> , <span class="fl">62</span> }</span>
<span id="cb3-217"><a href="#cb3-217"></a>, { <span class="fl">31</span> , <span class="fl">47</span> }</span>
<span id="cb3-218"><a href="#cb3-218"></a>, { <span class="fl">31</span> , <span class="fl">63</span> }</span>
<span id="cb3-219"><a href="#cb3-219"></a>, { <span class="fl">32</span> , <span class="fl">34</span> }</span>
<span id="cb3-220"><a href="#cb3-220"></a>, { <span class="fl">32</span> , <span class="fl">48</span> }</span>
<span id="cb3-221"><a href="#cb3-221"></a>, { <span class="fl">33</span> , <span class="fl">35</span> }</span>
<span id="cb3-222"><a href="#cb3-222"></a>, { <span class="fl">33</span> , <span class="fl">49</span> }</span>
<span id="cb3-223"><a href="#cb3-223"></a>, { <span class="fl">34</span> , <span class="fl">50</span> }</span>
<span id="cb3-224"><a href="#cb3-224"></a>, { <span class="fl">35</span> , <span class="fl">51</span> }</span>
<span id="cb3-225"><a href="#cb3-225"></a>, { <span class="fl">36</span> , <span class="fl">38</span> }</span>
<span id="cb3-226"><a href="#cb3-226"></a>, { <span class="fl">36</span> , <span class="fl">52</span> }</span>
<span id="cb3-227"><a href="#cb3-227"></a>, { <span class="fl">37</span> , <span class="fl">39</span> }</span>
<span id="cb3-228"><a href="#cb3-228"></a>, { <span class="fl">37</span> , <span class="fl">53</span> }</span>
<span id="cb3-229"><a href="#cb3-229"></a>, { <span class="fl">38</span> , <span class="fl">54</span> }</span>
<span id="cb3-230"><a href="#cb3-230"></a>, { <span class="fl">39</span> , <span class="fl">55</span> }</span>
<span id="cb3-231"><a href="#cb3-231"></a>, { <span class="fl">40</span> , <span class="fl">42</span> }</span>
<span id="cb3-232"><a href="#cb3-232"></a>, { <span class="fl">40</span> , <span class="fl">56</span> }</span>
<span id="cb3-233"><a href="#cb3-233"></a>, { <span class="fl">41</span> , <span class="fl">43</span> }</span>
<span id="cb3-234"><a href="#cb3-234"></a>, { <span class="fl">41</span> , <span class="fl">57</span> }</span>
<span id="cb3-235"><a href="#cb3-235"></a>, { <span class="fl">42</span> , <span class="fl">58</span> }</span>
<span id="cb3-236"><a href="#cb3-236"></a>, { <span class="fl">43</span> , <span class="fl">59</span> }</span>
<span id="cb3-237"><a href="#cb3-237"></a>, { <span class="fl">44</span> , <span class="fl">46</span> }</span>
<span id="cb3-238"><a href="#cb3-238"></a>, { <span class="fl">44</span> , <span class="fl">60</span> }</span>
<span id="cb3-239"><a href="#cb3-239"></a>, { <span class="fl">45</span> , <span class="fl">47</span> }</span>
<span id="cb3-240"><a href="#cb3-240"></a>, { <span class="fl">45</span> , <span class="fl">61</span> }</span>
<span id="cb3-241"><a href="#cb3-241"></a>, { <span class="fl">46</span> , <span class="fl">62</span> }</span>
<span id="cb3-242"><a href="#cb3-242"></a>, { <span class="fl">47</span> , <span class="fl">63</span> }</span>
<span id="cb3-243"><a href="#cb3-243"></a>, { <span class="fl">48</span> , <span class="fl">49</span> }</span>
<span id="cb3-244"><a href="#cb3-244"></a>, { <span class="fl">50</span> , <span class="fl">51</span> }</span>
<span id="cb3-245"><a href="#cb3-245"></a>, { <span class="fl">52</span> , <span class="fl">53</span> }</span>
<span id="cb3-246"><a href="#cb3-246"></a>, { <span class="fl">54</span> , <span class="fl">55</span> }</span>
<span id="cb3-247"><a href="#cb3-247"></a>, { <span class="fl">56</span> , <span class="fl">57</span> }</span>
<span id="cb3-248"><a href="#cb3-248"></a>, { <span class="fl">58</span> , <span class="fl">59</span> }</span>
<span id="cb3-249"><a href="#cb3-249"></a>, { <span class="fl">60</span> , <span class="fl">61</span> }</span>
<span id="cb3-250"><a href="#cb3-250"></a>, { <span class="fl">62</span> , <span class="fl">63</span> } };</span>
<span id="cb3-251"><a href="#cb3-251"></a></span>
<span id="cb3-252"><a href="#cb3-252"></a><span class="co">/* tetrahedra */</span></span>
<span id="cb3-253"><a href="#cb3-253"></a><span class="kw">#declare tetrahedra </span>= <span class="kw">array</span>[<span class="fl">16</span>][<span class="fl">4</span>]</span>
<span id="cb3-254"><a href="#cb3-254"></a>{ { <span class="fl">0</span> , <span class="fl">16</span> , <span class="fl">32</span> , <span class="fl">48</span> }</span>
<span id="cb3-255"><a href="#cb3-255"></a>, { <span class="fl">11</span> , <span class="fl">27</span> , <span class="fl">43</span> , <span class="fl">59</span> }</span>
<span id="cb3-256"><a href="#cb3-256"></a>, { <span class="fl">12</span> , <span class="fl">28</span> , <span class="fl">44</span> , <span class="fl">60</span> }</span>
<span id="cb3-257"><a href="#cb3-257"></a>, { <span class="fl">8</span> , <span class="fl">24</span> , <span class="fl">40</span> , <span class="fl">56</span> }</span>
<span id="cb3-258"><a href="#cb3-258"></a>, { <span class="fl">9</span> , <span class="fl">25</span> , <span class="fl">41</span> , <span class="fl">57</span> }</span>
<span id="cb3-259"><a href="#cb3-259"></a>, { <span class="fl">15</span> , <span class="fl">31</span> , <span class="fl">47</span> , <span class="fl">63</span> }</span>
<span id="cb3-260"><a href="#cb3-260"></a>, { <span class="fl">13</span> , <span class="fl">29</span> , <span class="fl">45</span> , <span class="fl">61</span> }</span>
<span id="cb3-261"><a href="#cb3-261"></a>, { <span class="fl">14</span> , <span class="fl">30</span> , <span class="fl">46</span> , <span class="fl">62</span> }</span>
<span id="cb3-262"><a href="#cb3-262"></a>, { <span class="fl">10</span> , <span class="fl">26</span> , <span class="fl">42</span> , <span class="fl">58</span> }</span>
<span id="cb3-263"><a href="#cb3-263"></a>, { <span class="fl">3</span> , <span class="fl">19</span> , <span class="fl">35</span> , <span class="fl">51</span> }</span>
<span id="cb3-264"><a href="#cb3-264"></a>, { <span class="fl">2</span> , <span class="fl">18</span> , <span class="fl">34</span> , <span class="fl">50</span> }</span>
<span id="cb3-265"><a href="#cb3-265"></a>, { <span class="fl">1</span> , <span class="fl">17</span> , <span class="fl">33</span> , <span class="fl">49</span> }</span>
<span id="cb3-266"><a href="#cb3-266"></a>, { <span class="fl">4</span> , <span class="fl">20</span> , <span class="fl">36</span> , <span class="fl">52</span> }</span>
<span id="cb3-267"><a href="#cb3-267"></a>, { <span class="fl">5</span> , <span class="fl">21</span> , <span class="fl">37</span> , <span class="fl">53</span> }</span>
<span id="cb3-268"><a href="#cb3-268"></a>, { <span class="fl">6</span> , <span class="fl">22</span> , <span class="fl">38</span> , <span class="fl">54</span> }</span>
<span id="cb3-269"><a href="#cb3-269"></a>, { <span class="fl">7</span> , <span class="fl">23</span> , <span class="fl">39</span> , <span class="fl">55</span> } };</span>
<span id="cb3-270"><a href="#cb3-270"></a></span>
<span id="cb3-271"><a href="#cb3-271"></a><span class="kw">#declare faces </span>= <span class="kw">array</span>[<span class="fl">64</span>][<span class="fl">3</span>];</span>
<span id="cb3-272"><a href="#cb3-272"></a>#for(i, <span class="fl">0</span>, <span class="fl">15</span>)</span>
<span id="cb3-273"><a href="#cb3-273"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">0</span>];</span>
<span id="cb3-274"><a href="#cb3-274"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">1</span>];</span>
<span id="cb3-275"><a href="#cb3-275"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">2</span>];</span>
<span id="cb3-276"><a href="#cb3-276"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">1</span>][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">0</span>];</span>
<span id="cb3-277"><a href="#cb3-277"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">1</span>][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">1</span>];</span>
<span id="cb3-278"><a href="#cb3-278"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">1</span>][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">3</span>];</span>
<span id="cb3-279"><a href="#cb3-279"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">2</span>][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">0</span>];</span>
<span id="cb3-280"><a href="#cb3-280"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">2</span>][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">2</span>];</span>
<span id="cb3-281"><a href="#cb3-281"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">2</span>][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">3</span>];</span>
<span id="cb3-282"><a href="#cb3-282"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">3</span>][<span class="fl">0</span>] = tetrahedra[i][<span class="fl">1</span>];</span>
<span id="cb3-283"><a href="#cb3-283"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">3</span>][<span class="fl">1</span>] = tetrahedra[i][<span class="fl">2</span>];</span>
<span id="cb3-284"><a href="#cb3-284"></a>    <span class="kw">#declare faces</span>[<span class="fl">4</span>*i+<span class="fl">3</span>][<span class="fl">2</span>] = tetrahedra[i][<span class="fl">3</span>];</span>
<span id="cb3-285"><a href="#cb3-285"></a><span class="ot">#end</span></span>
<span id="cb3-286"><a href="#cb3-286"></a></span>
<span id="cb3-287"><a href="#cb3-287"></a></span>
<span id="cb3-288"><a href="#cb3-288"></a><span class="co">/* rotation in 4D space */</span></span>
<span id="cb3-289"><a href="#cb3-289"></a><span class="kw">#macro rotate4d</span>(theta, phi, xi, vec)</span>
<span id="cb3-290"><a href="#cb3-290"></a>    <span class="kw">#local a </span>= <span class="kw">cos</span>(xi);</span>
<span id="cb3-291"><a href="#cb3-291"></a>    <span class="kw">#local b </span>= <span class="kw">sin</span>(theta)*<span class="kw">cos</span>(phi)*<span class="kw">sin</span>(xi);</span>
<span id="cb3-292"><a href="#cb3-292"></a>    <span class="kw">#local c </span>= <span class="kw">sin</span>(theta)*<span class="kw">sin</span>(phi)*<span class="kw">sin</span>(xi);</span>
<span id="cb3-293"><a href="#cb3-293"></a>    <span class="kw">#local d </span>= <span class="kw">cos</span>(theta)*<span class="kw">sin</span>(xi);</span>
<span id="cb3-294"><a href="#cb3-294"></a>    <span class="kw">#local p </span>= vec.<span class="kw">x</span>;</span>
<span id="cb3-295"><a href="#cb3-295"></a>    <span class="kw">#local q </span>= vec.<span class="kw">y</span>;</span>
<span id="cb3-296"><a href="#cb3-296"></a>    <span class="kw">#local r </span>= vec.<span class="kw">z</span>;</span>
<span id="cb3-297"><a href="#cb3-297"></a>    <span class="kw">#local s </span>= vec.<span class="kw">t</span>;</span>
<span id="cb3-298"><a href="#cb3-298"></a>    &lt; a*p - b*q - c*r - d*s</span>
<span id="cb3-299"><a href="#cb3-299"></a>    , a*q + b*p + c*s - d*r</span>
<span id="cb3-300"><a href="#cb3-300"></a>    , a*r - b*s + c*p + d*q</span>
<span id="cb3-301"><a href="#cb3-301"></a>    , a*s + b*r - c*q + d*p &gt;</span>
<span id="cb3-302"><a href="#cb3-302"></a><span class="ot">#end</span></span>
<span id="cb3-303"><a href="#cb3-303"></a></span>
<span id="cb3-304"><a href="#cb3-304"></a><span class="co">/* stereographic projection */</span></span>
<span id="cb3-305"><a href="#cb3-305"></a><span class="kw">#macro StereographicProjection</span>(q, r)</span>
<span id="cb3-306"><a href="#cb3-306"></a>    &lt;q.<span class="kw">x</span>,q.<span class="kw">y</span>,q.<span class="kw">z</span>&gt;/(r-q.<span class="kw">t</span>)</span>
<span id="cb3-307"><a href="#cb3-307"></a><span class="ot">#end</span></span>
<span id="cb3-308"><a href="#cb3-308"></a></span>
<span id="cb3-309"><a href="#cb3-309"></a><span class="co">/* rotated and projected vertices */</span></span>
<span id="cb3-310"><a href="#cb3-310"></a><span class="kw">#macro ProjectedVertices</span>(theta, phi, xi, r)</span>
<span id="cb3-311"><a href="#cb3-311"></a>    <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="fl">64</span>];</span>
<span id="cb3-312"><a href="#cb3-312"></a>    #for(i, <span class="fl">0</span>, <span class="fl">63</span>)</span>
<span id="cb3-313"><a href="#cb3-313"></a>        <span class="kw">#local out</span>[i] = StereographicProjection(</span>
<span id="cb3-314"><a href="#cb3-314"></a>                            rotate4d(theta,phi,xi,vertices[i]), r</span>
<span id="cb3-315"><a href="#cb3-315"></a>                        );</span>
<span id="cb3-316"><a href="#cb3-316"></a>    <span class="ot">#end</span></span>
<span id="cb3-317"><a href="#cb3-317"></a>    out</span>
<span id="cb3-318"><a href="#cb3-318"></a><span class="ot">#end</span></span>
<span id="cb3-319"><a href="#cb3-319"></a></span>
<span id="cb3-320"><a href="#cb3-320"></a><span class="co">/* macro spherical segment */</span></span>
<span id="cb3-321"><a href="#cb3-321"></a><span class="kw">#macro vlength4</span>(P)</span>
<span id="cb3-322"><a href="#cb3-322"></a>    <span class="kw">sqrt</span>(P.<span class="kw">x</span>*P.<span class="kw">x</span> + P.<span class="kw">y</span>*P.<span class="kw">y</span> + P.<span class="kw">z</span>*P.<span class="kw">z</span> + P.<span class="kw">t</span>*P.<span class="kw">t</span>)</span>
<span id="cb3-323"><a href="#cb3-323"></a><span class="ot">#end</span></span>
<span id="cb3-324"><a href="#cb3-324"></a></span>
<span id="cb3-325"><a href="#cb3-325"></a><span class="kw">#macro sphericalSegment</span>(P, Q, r, n)</span>
<span id="cb3-326"><a href="#cb3-326"></a>    <span class="kw">#local out </span>= <span class="kw">array</span>[n+<span class="fl">1</span>];</span>
<span id="cb3-327"><a href="#cb3-327"></a>    #for(i, <span class="fl">0</span>, n)</span>
<span id="cb3-328"><a href="#cb3-328"></a>        <span class="kw">#local pt </span>= P + (i/n)*(Q-P);</span>
<span id="cb3-329"><a href="#cb3-329"></a>        <span class="kw">#local out</span>[i] = r/vlength4(pt) * pt;</span>
<span id="cb3-330"><a href="#cb3-330"></a>    <span class="ot">#end</span></span>
<span id="cb3-331"><a href="#cb3-331"></a>    out</span>
<span id="cb3-332"><a href="#cb3-332"></a><span class="ot">#end</span></span>
<span id="cb3-333"><a href="#cb3-333"></a></span>
<span id="cb3-334"><a href="#cb3-334"></a><span class="co">/* macro to draw an edge */</span></span>
<span id="cb3-335"><a href="#cb3-335"></a><span class="kw">#macro Edge</span>(verts, v1, v2, theta, phi, xi, r, Tex)</span>
<span id="cb3-336"><a href="#cb3-336"></a>    <span class="kw">#local P </span>= verts[v1];</span>
<span id="cb3-337"><a href="#cb3-337"></a>    <span class="kw">#local Q </span>= verts[v2];</span>
<span id="cb3-338"><a href="#cb3-338"></a>    <span class="kw">#local PQ </span>= sphericalSegment(P, Q, r, <span class="fl">100</span>);</span>
<span id="cb3-339"><a href="#cb3-339"></a>    <span class="kw">sphere_sweep</span> {</span>
<span id="cb3-340"><a href="#cb3-340"></a>        <span class="kw">b_spline</span> <span class="fl">101</span></span>
<span id="cb3-341"><a href="#cb3-341"></a>        #for(k,<span class="fl">0</span>,<span class="fl">100</span>)</span>
<span id="cb3-342"><a href="#cb3-342"></a>            <span class="kw">#local O </span>= </span>
<span id="cb3-343"><a href="#cb3-343"></a>                StereographicProjection(rotate4d(theta,phi,xi,PQ[k]), r);</span>
<span id="cb3-344"><a href="#cb3-344"></a>            O <span class="kw">log</span>(<span class="fl">1</span>+<span class="kw">vlength</span>(O)/<span class="fl">4</span>)/<span class="fl">2</span></span>
<span id="cb3-345"><a href="#cb3-345"></a>        <span class="ot">#end</span></span>
<span id="cb3-346"><a href="#cb3-346"></a>        <span class="kw">texture</span> { </span>
<span id="cb3-347"><a href="#cb3-347"></a>            Tex</span>
<span id="cb3-348"><a href="#cb3-348"></a>        }</span>
<span id="cb3-349"><a href="#cb3-349"></a>    }</span>
<span id="cb3-350"><a href="#cb3-350"></a><span class="ot">#end</span></span>
<span id="cb3-351"><a href="#cb3-351"></a></span>
<span id="cb3-352"><a href="#cb3-352"></a><span class="co">/* stereographic subdivision (to fill the triangular faces) */</span></span>
<span id="cb3-353"><a href="#cb3-353"></a><span class="kw">#macro midpoint4</span>(A, B, r)</span>
<span id="cb3-354"><a href="#cb3-354"></a>    <span class="kw">#local xmid </span>= (A.<span class="kw">x</span> + B.<span class="kw">x</span>)/<span class="fl">2</span>;</span>
<span id="cb3-355"><a href="#cb3-355"></a>    <span class="kw">#local ymid </span>= (A.<span class="kw">y</span> + B.<span class="kw">y</span>)/<span class="fl">2</span>;</span>
<span id="cb3-356"><a href="#cb3-356"></a>    <span class="kw">#local zmid </span>= (A.<span class="kw">z</span> + B.<span class="kw">z</span>)/<span class="fl">2</span>;</span>
<span id="cb3-357"><a href="#cb3-357"></a>    <span class="kw">#local tmid </span>= (A.<span class="kw">t</span> + B.<span class="kw">t</span>)/<span class="fl">2</span>;</span>
<span id="cb3-358"><a href="#cb3-358"></a>    <span class="kw">#local lg </span>= <span class="kw">sqrt</span>(xmid*xmid + ymid*ymid + zmid*zmid + tmid*tmid) / r;</span>
<span id="cb3-359"><a href="#cb3-359"></a>    &lt; xmid / lg, ymid / lg, zmid / lg, tmid / lg &gt;</span>
<span id="cb3-360"><a href="#cb3-360"></a><span class="ot">#end</span></span>
<span id="cb3-361"><a href="#cb3-361"></a></span>
<span id="cb3-362"><a href="#cb3-362"></a><span class="kw">#macro subdiv0</span>(A, B, C, r)</span>
<span id="cb3-363"><a href="#cb3-363"></a>    <span class="kw">#local mAB </span>= midpoint4(A, B, r);</span>
<span id="cb3-364"><a href="#cb3-364"></a>    <span class="kw">#local mAC </span>= midpoint4(A, C, r);</span>
<span id="cb3-365"><a href="#cb3-365"></a>    <span class="kw">#local mBC </span>= midpoint4(B, C, r);</span>
<span id="cb3-366"><a href="#cb3-366"></a>    <span class="kw">#local trgl1 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {A, mAB, mAC};</span>
<span id="cb3-367"><a href="#cb3-367"></a>    <span class="kw">#local trgl2 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {B, mAB, mBC};</span>
<span id="cb3-368"><a href="#cb3-368"></a>    <span class="kw">#local trgl3 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {C, mBC, mAC};</span>
<span id="cb3-369"><a href="#cb3-369"></a>    <span class="kw">#local trgl4 </span>= <span class="kw">array</span>[<span class="fl">3</span>] {mAB, mAC, mBC};</span>
<span id="cb3-370"><a href="#cb3-370"></a>    <span class="kw">array</span>[<span class="fl">4</span>] {trgl1, trgl2, trgl3, trgl4}</span>
<span id="cb3-371"><a href="#cb3-371"></a><span class="ot">#end</span></span>
<span id="cb3-372"><a href="#cb3-372"></a></span>
<span id="cb3-373"><a href="#cb3-373"></a><span class="kw">#macro subdiv</span>(A, B, C, r, depth)</span>
<span id="cb3-374"><a href="#cb3-374"></a>    <span class="ot">#if</span>(depth=<span class="fl">1</span>)</span>
<span id="cb3-375"><a href="#cb3-375"></a>        <span class="kw">#local out </span>= subdiv0(A, B, C, r);</span>
<span id="cb3-376"><a href="#cb3-376"></a>    <span class="ot">#else</span></span>
<span id="cb3-377"><a href="#cb3-377"></a>        <span class="kw">#local triangles </span>= subdiv(A, B, C, r, depth<span class="fl">-1</span>);</span>
<span id="cb3-378"><a href="#cb3-378"></a>        <span class="kw">#local out </span>= <span class="kw">array</span>[<span class="kw">pow</span>(<span class="fl">4</span>,depth)];</span>
<span id="cb3-379"><a href="#cb3-379"></a>        #for(i, <span class="fl">0</span>, <span class="kw">pow</span>(<span class="fl">4</span>,depth<span class="fl">-1</span>)-<span class="fl">1</span>)</span>
<span id="cb3-380"><a href="#cb3-380"></a>            <span class="kw">#local trgl </span>= triangles[i];</span>
<span id="cb3-381"><a href="#cb3-381"></a>            <span class="kw">#local trgls </span>= subdiv0(trgl[<span class="fl">0</span>], trgl[<span class="fl">1</span>], trgl[<span class="fl">2</span>], r);</span>
<span id="cb3-382"><a href="#cb3-382"></a>            <span class="kw">#local out</span>[<span class="fl">4</span>*i] = trgls[<span class="fl">0</span>];</span>
<span id="cb3-383"><a href="#cb3-383"></a>            <span class="kw">#local out</span>[<span class="fl">4</span>*i+<span class="fl">1</span>] = trgls[<span class="fl">1</span>];</span>
<span id="cb3-384"><a href="#cb3-384"></a>            <span class="kw">#local out</span>[<span class="fl">4</span>*i+<span class="fl">2</span>] = trgls[<span class="fl">2</span>];</span>
<span id="cb3-385"><a href="#cb3-385"></a>            <span class="kw">#local out</span>[<span class="fl">4</span>*i+<span class="fl">3</span>] = trgls[<span class="fl">3</span>];</span>
<span id="cb3-386"><a href="#cb3-386"></a>        <span class="ot">#end</span></span>
<span id="cb3-387"><a href="#cb3-387"></a>    <span class="ot">#end</span></span>
<span id="cb3-388"><a href="#cb3-388"></a>    out</span>
<span id="cb3-389"><a href="#cb3-389"></a><span class="ot">#end</span></span>
<span id="cb3-390"><a href="#cb3-390"></a></span>
<span id="cb3-391"><a href="#cb3-391"></a><span class="co">/*-------------------------------------------*/</span></span>
<span id="cb3-392"><a href="#cb3-392"></a><span class="co">/*-----      draw the polychoron       ------*/</span></span>
<span id="cb3-393"><a href="#cb3-393"></a><span class="co">/*-------------------------------------------*/</span></span>
<span id="cb3-394"><a href="#cb3-394"></a><span class="kw">#declare theta </span>= <span class="fl">pi</span>/<span class="fl">2</span>;</span>
<span id="cb3-395"><a href="#cb3-395"></a><span class="kw">#declare phi </span>= <span class="fl">0</span>;</span>
<span id="cb3-396"><a href="#cb3-396"></a><span class="kw">#declare xi </span>= <span class="fl">2</span>*<span class="kw">frame_number</span>*<span class="fl">pi</span>/<span class="fl">180</span>;</span>
<span id="cb3-397"><a href="#cb3-397"></a><span class="kw">#declare r </span>= <span class="kw">sqrt</span>(<span class="fl">1</span>+<span class="fl">3</span>*sqr2p1*sqr2p1); </span>
<span id="cb3-398"><a href="#cb3-398"></a><span class="kw">#declare depth </span>= <span class="fl">5</span>;</span>
<span id="cb3-399"><a href="#cb3-399"></a></span>
<span id="cb3-400"><a href="#cb3-400"></a><span class="kw">#declare vs </span>= ProjectedVertices(theta, phi, xi, r);</span>
<span id="cb3-401"><a href="#cb3-401"></a></span>
<span id="cb3-402"><a href="#cb3-402"></a><span class="kw">#declare stereoTriangles </span>= <span class="kw">array</span>[<span class="fl">64</span>];</span>
<span id="cb3-403"><a href="#cb3-403"></a>#for(i, <span class="fl">0</span>, <span class="fl">63</span>)</span>
<span id="cb3-404"><a href="#cb3-404"></a>    <span class="kw">#local triangles4 </span>= </span>
<span id="cb3-405"><a href="#cb3-405"></a>        subdiv(</span>
<span id="cb3-406"><a href="#cb3-406"></a>            vertices[faces[i][<span class="fl">0</span>]], </span>
<span id="cb3-407"><a href="#cb3-407"></a>            vertices[faces[i][<span class="fl">1</span>]], </span>
<span id="cb3-408"><a href="#cb3-408"></a>            vertices[faces[i][<span class="fl">2</span>]], r, depth);</span>
<span id="cb3-409"><a href="#cb3-409"></a>    <span class="kw">#declare stereoTriangles</span>[i] = <span class="kw">array</span>[<span class="kw">dimension_size</span>(triangles4,<span class="fl">1</span>)][<span class="fl">3</span>];</span>
<span id="cb3-410"><a href="#cb3-410"></a>    #for(j, <span class="fl">0</span>, <span class="kw">dimension_size</span>(triangles4,<span class="fl">1</span>)-<span class="fl">1</span>)</span>
<span id="cb3-411"><a href="#cb3-411"></a>        <span class="kw">#local trgl4 </span>= triangles4[j];</span>
<span id="cb3-412"><a href="#cb3-412"></a>        <span class="kw">#declare stereoTriangles</span>[i][j][<span class="fl">0</span>] = </span>
<span id="cb3-413"><a href="#cb3-413"></a>            StereographicProjection(rotate4d(theta, phi, xi, trgl4[<span class="fl">0</span>]), r);</span>
<span id="cb3-414"><a href="#cb3-414"></a>        <span class="kw">#declare stereoTriangles</span>[i][j][<span class="fl">1</span>] = </span>
<span id="cb3-415"><a href="#cb3-415"></a>            StereographicProjection(rotate4d(theta, phi, xi, trgl4[<span class="fl">1</span>]), r);</span>
<span id="cb3-416"><a href="#cb3-416"></a>        <span class="kw">#declare stereoTriangles</span>[i][j][<span class="fl">2</span>] = </span>
<span id="cb3-417"><a href="#cb3-417"></a>            StereographicProjection(rotate4d(theta, phi, xi, trgl4[<span class="fl">2</span>]), r);</span>
<span id="cb3-418"><a href="#cb3-418"></a>    <span class="ot">#end</span></span>
<span id="cb3-419"><a href="#cb3-419"></a><span class="ot">#end</span></span>
<span id="cb3-420"><a href="#cb3-420"></a></span>
<span id="cb3-421"><a href="#cb3-421"></a><span class="kw">#declare edgeTexture </span>= <span class="kw">texture</span> {</span>
<span id="cb3-422"><a href="#cb3-422"></a>    <span class="kw">pigment</span> { <span class="kw">color</span> DarkPurple }</span>
<span id="cb3-423"><a href="#cb3-423"></a>    <span class="kw">finish</span> {</span>
<span id="cb3-424"><a href="#cb3-424"></a>      <span class="kw">ambient</span> <span class="fl">.1</span></span>
<span id="cb3-425"><a href="#cb3-425"></a>      <span class="kw">diffuse</span> <span class="fl">.9</span></span>
<span id="cb3-426"><a href="#cb3-426"></a>      <span class="kw">reflection</span> <span class="fl">0</span></span>
<span id="cb3-427"><a href="#cb3-427"></a>      <span class="kw">specular</span> <span class="fl">1</span></span>
<span id="cb3-428"><a href="#cb3-428"></a>      <span class="kw">metallic</span></span>
<span id="cb3-429"><a href="#cb3-429"></a>    }</span>
<span id="cb3-430"><a href="#cb3-430"></a>};</span>
<span id="cb3-431"><a href="#cb3-431"></a></span>
<span id="cb3-432"><a href="#cb3-432"></a><span class="kw">object</span> {</span>
<span id="cb3-433"><a href="#cb3-433"></a>    <span class="kw">union</span> {</span>
<span id="cb3-434"><a href="#cb3-434"></a>        <span class="co">/* draw edges */</span></span>
<span id="cb3-435"><a href="#cb3-435"></a>        #for(i, <span class="fl">0</span>, <span class="fl">127</span>)</span>
<span id="cb3-436"><a href="#cb3-436"></a>            Edge(vertices, edges[i][<span class="fl">0</span>], edges[i][<span class="fl">1</span>], </span>
<span id="cb3-437"><a href="#cb3-437"></a>                    theta, phi, xi, r, edgeTexture)</span>
<span id="cb3-438"><a href="#cb3-438"></a>        <span class="ot">#end</span></span>
<span id="cb3-439"><a href="#cb3-439"></a>        <span class="co">/* draw vertices */</span> </span>
<span id="cb3-440"><a href="#cb3-440"></a>        #for(i,<span class="fl">0</span>,<span class="fl">63</span>)</span>
<span id="cb3-441"><a href="#cb3-441"></a>            <span class="kw">sphere</span> {</span>
<span id="cb3-442"><a href="#cb3-442"></a>                vs[i], <span class="kw">vlength</span>(vs[i])/<span class="fl">15</span></span>
<span id="cb3-443"><a href="#cb3-443"></a>                <span class="kw">texture</span> { edgeTexture }</span>
<span id="cb3-444"><a href="#cb3-444"></a>            }</span>
<span id="cb3-445"><a href="#cb3-445"></a>        <span class="ot">#end</span>  </span>
<span id="cb3-446"><a href="#cb3-446"></a>        <span class="co">/* fill triangles */</span></span>
<span id="cb3-447"><a href="#cb3-447"></a>        <span class="kw">mesh</span> {</span>
<span id="cb3-448"><a href="#cb3-448"></a>            #for(i, <span class="fl">0</span>, <span class="fl">63</span>)</span>
<span id="cb3-449"><a href="#cb3-449"></a>                <span class="kw">#local trgl </span>= stereoTriangles[i];</span>
<span id="cb3-450"><a href="#cb3-450"></a>                #for(j, <span class="fl">0</span>, <span class="kw">dimension_size</span>(trgl,<span class="fl">1</span>)-<span class="fl">1</span>)</span>
<span id="cb3-451"><a href="#cb3-451"></a>                    <span class="kw">triangle</span> {</span>
<span id="cb3-452"><a href="#cb3-452"></a>                        trgl[j][<span class="fl">0</span>], trgl[j][<span class="fl">1</span>], trgl[j][<span class="fl">2</span>]</span>
<span id="cb3-453"><a href="#cb3-453"></a>                    }</span>
<span id="cb3-454"><a href="#cb3-454"></a>                <span class="ot">#end</span></span>
<span id="cb3-455"><a href="#cb3-455"></a>            <span class="ot">#end</span></span>
<span id="cb3-456"><a href="#cb3-456"></a>            <span class="kw">texture</span> {</span>
<span id="cb3-457"><a href="#cb3-457"></a>                <span class="kw">pigment</span> { Red }</span>
<span id="cb3-458"><a href="#cb3-458"></a>                <span class="kw">finish</span> {</span>
<span id="cb3-459"><a href="#cb3-459"></a>                    <span class="kw">ambient</span> <span class="fl">0.5</span></span>
<span id="cb3-460"><a href="#cb3-460"></a>                    <span class="kw">reflection</span> <span class="fl">0</span></span>
<span id="cb3-461"><a href="#cb3-461"></a>                    <span class="kw">brilliance</span> <span class="fl">4</span></span>
<span id="cb3-462"><a href="#cb3-462"></a>                }</span>
<span id="cb3-463"><a href="#cb3-463"></a>            }</span>
<span id="cb3-464"><a href="#cb3-464"></a>        }</span>
<span id="cb3-465"><a href="#cb3-465"></a>     }</span>
<span id="cb3-466"><a href="#cb3-466"></a>     <span class="kw">scale</span> <span class="fl">0.5</span></span>
<span id="cb3-467"><a href="#cb3-467"></a>     <span class="kw">translate</span> &lt;-<span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">-25</span>&gt;</span>
<span id="cb3-468"><a href="#cb3-468"></a>}</span></code></pre></div>
<p><img src="figures/truncatedTesseract_stereographic_povray.gif" /></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">¬´ Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->


</html>