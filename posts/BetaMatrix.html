<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Matrix variate Beta distributions</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/kate.css" /> 
   
  
    <link href="../libraries/highlighters/prettify/css/twitter-bootstrap.css" rel="stylesheet"> 
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:25px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:21px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo" style="position:absolute;">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Matrix variate Beta distributions</h1> 
          <div class="info">
    Posted on December 12, 2017
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a href="../tags/R.html">R</a>, <a href="../tags/maths.html">maths</a>, <a href="../tags/statistics.html">statistics</a>
    
</div>

<ul>
<li><a href="#definitions">Definitions</a></li>
<li><a href="#hypergeometric-matrix-function">Hypergeometric matrix function</a></li>
<li><a href="#densities-and-identities">Densities and identities</a>
<ul>
<li><a href="#boxedmathcalbi_p1a-b-theta_1-theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(1)}(a, b, \Theta_1, \Theta_2)}\)</span></a></li>
<li><a href="#boxedmathcalbi_p2a-b-theta_1-theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(2)}(a, b, \Theta_1, \Theta_2)}\)</span></a></li>
<li><a href="#boxedmathcalbii_p1abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)}\)</span></a></li>
<li><a href="#boxedmathcalbii_p2abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(2)}(a,b,\Theta_1,\Theta_2)}\)</span></a></li>
</ul></li>
<li><a href="#proofs">Proofs</a>
<ul>
<li><a href="#boxedmathcalbi_p1abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(1)}(a,b,\Theta_1,\Theta_2)}\)</span></a></li>
<li><a href="#boxedmathcalbi_p2abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(2)}(a,b,\Theta_1,\Theta_2)}\)</span></a></li>
<li><a href="#boxedmathcalbii_p1abtheta_1theta_2-1"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)}\)</span></a></li>
<li><a href="#boxedmathcalbii_p2abtheta_1theta_2-1"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(2)}(a,b,\Theta_1,\Theta_2)}\)</span></a></li>
<li><a href="#simplifications-in-the-singly-noncentral-case">Simplifications in the singly noncentral case</a></li>
</ul></li>
</ul>
<p><span class="math inline">\(\newcommand{\etr}{\textrm{etr}}\)</span></p>
<p>One asked me what are the densities of the matrix variate Beta distributions in the <a href="https://github.com/stla/matrixsampling"><code>matrixsampling</code> package</a>. I’m going to give them here.</p>
<h1 id="definitions">Definitions</h1>
<p>Two definitions of the matrix variate Beta type I distribution were proposed. We will denote them by <span class="math inline">\(\mathcal{B}I_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span> and <span class="math inline">\(\mathcal{B}I_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span>, where <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\Theta_2\)</span> are the noncentrality parameters. Take two independent Wishart random matrices <span class="math inline">\(W_1 \sim \mathcal{W}_p(2a, I_p, \Theta_1)\)</span> and <span class="math inline">\(W_2 \sim \mathcal{W}_p(2b, I_p, \Theta_2)\)</span>. Then <span class="math inline">\(\mathcal{B}I_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span> is the distribution of <span class="math display">\[
U_1 = {(W_1+W_2)}^{-\frac12}W_1{(W_1+W_2)}^{-\frac12},
\]</span> while <span class="math inline">\(\mathcal{B}I_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span> is the distribution of <span class="math display">\[
U_2 = W_1^\frac12{(W_1+W_2)}^{-1}W_1^\frac12.
\]</span> The condition <span class="math inline">\(a+b &gt; \frac12(p-1)\)</span> is required in order for <span class="math inline">\(W_1+W_2\)</span> to be invertible.</p>
<p>In the central case, i.e. when both <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\Theta_2\)</span> are the null matrices, these two distributions are the same. More generally, as we will see, they are the same when <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\Theta_2\)</span> are scalar.</p>
<p>Similarly, two definitions of the matrix variate Beta type II distribution were proposed. We will denote them by <span class="math inline">\(\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span> and <span class="math inline">\(\mathcal{B}II_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span>. The first one is the distribution of <span class="math display">\[
V_1 = W_2^{-\frac12} W_1 W_2^{-\frac12},
\]</span> while the second one is the distribution of <span class="math display">\[
V_2 = W_1^\frac12 {W_2}^{-1} W_1^\frac12.
\]</span> The condition <span class="math inline">\(b &gt; \frac12(p-1)\)</span> is required in order for <span class="math inline">\(W_2\)</span> to be invertible.</p>
<p>Similarly to the type I, these two distributions are the same in the central case, and more generally when <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\Theta_2\)</span> are scalar.</p>
<p>Under the second definition, the Beta type I distribution is related to the Beta type II distribution by <span class="math inline">\(U_2 \sim V_2{(I_p+V_2)}^{-1}\)</span>.</p>
<h1 id="hypergeometric-matrix-function">Hypergeometric matrix function</h1>
<p>The densities of the matrix Beta distributions involve the hypergeometric function of matrix argument <span class="math inline">\({}_0\!F_1\)</span>. We will use the property <span class="math inline">\({}_0\!F_1(\alpha, AB)={}_0\!F_1(\alpha, BA)\)</span> (to simplify the densities when <span class="math inline">\(\Theta_1\)</span> or <span class="math inline">\(\Theta_2\)</span> are scalar).</p>
<h1 id="densities-and-identities">Densities and identities</h1>
<p>We provide the densities here. We will prove these results in the next section. Note that <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> must satisfy <span class="math inline">\(a,b &gt; \frac12(p+1)\)</span> in order for each distribution to have a density.</p>
<p>We denote by <span class="math inline">\(\etr\)</span> the function taking the exponential of the trace of a matrix.</p>
<h3 id="boxedmathcalbi_p1a-b-theta_1-theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(1)}(a, b, \Theta_1, \Theta_2)}\)</span></h3>
<p>Recall that <span class="math display">\[
U_1 = {(W_1+W_2)}^{-\frac12} W_1 {(W_1+W_2)}^{-\frac12}.
\]</span> It is clear from this definition that <span class="math display">\[
I_p - U_1 \sim \mathcal{B}I_p^{(1)}(b, a, \Theta_2, \Theta_1).
\]</span> The density of <span class="math inline">\(U_1\)</span> is <span class="math display">\[
\begin{split}
&amp; \mathcal{B}I_p^{(1)}(U \mid a, b, \Theta_1, \Theta_2) \propto 
{\det(U)}^{a-\frac12(p+1)} {\det(I_p-U)}^{b-\frac12(p+1)} \\
&amp; \quad \int_{S&gt;0} \etr(-S)
{\det(S)}^{a+b-\frac12(p+1)}
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1S^{\frac12} U S^\frac12\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2S^{\frac12}(I_p-U)S^\frac12\right)
\mathrm{d}S
\end{split}
\]</span> for <span class="math inline">\(0 &lt; U &lt; I_p\)</span>.</p>
<p>If <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\Theta_2\)</span> are scalar, <span class="math display">\[
\begin{split}
&amp; \mathcal{B}I_p^{(1)}(U \mid a, b, \Theta_1, \Theta_2) \propto
{\det(U)}^{a-\frac12(p+1)} {\det(I_p-U)}^{b-\frac12(p+1)} \\
&amp; \quad \int_{S&gt;0} \etr(-S)
{\det(S)}^{a+b-\frac12(p+1)}
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1SU\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2S(I_p-U)\right)
\mathrm{d}S.
\end{split}
\]</span></p>
<h3 id="boxedmathcalbi_p2a-b-theta_1-theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(2)}(a, b, \Theta_1, \Theta_2)}\)</span></h3>
<p>Recall that <span class="math display">\[
U_2 = W_1^\frac12{(W_1+W_2)}^{-1}W_1^\frac12.
\]</span></p>
<p>The density of <span class="math inline">\(U_2\)</span> is <span class="math display">\[
\begin{split}
&amp; \mathcal{B}I_p^{(2)}(U \mid a, b, \Theta_1, \Theta_2) \propto  
 {\det(U)}^{-b-\frac12(p+1)}
{\det(I_p-U)}^{b-\frac12(p+1)} \\
&amp; \quad \int_{S&gt;0}
\etr(-U^{-1}S)
{\det(S)}^{a+b-\frac12(p+1)} 
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1S\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2 S^\frac12 U^{-1}(I_p-U)S^{\frac12}\right)\mathrm{d}S
\end{split}
\]</span> for <span class="math inline">\(0 &lt; U &lt; I_p\)</span>.</p>
<p>If <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\Theta_2\)</span> are scalar, it is equal to the density of <span class="math inline">\(\mathcal{B}I_p^{(1)}(a, b, \Theta_1, \Theta_2)\)</span>.</p>
<h3 id="boxedmathcalbii_p1abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)}\)</span></h3>
<p>More generally, we give the density of <span class="math display">\[
V_1 = {(W_2^{-\frac12})}' W_1 W_2^{-\frac12}
\]</span> where <span class="math inline">\(W_2^{\frac12}{(W_2^{\frac12})}' = W_2\)</span>.</p>
<p>This density of <span class="math inline">\(V_1\)</span> is <span class="math display">\[
\begin{split}
&amp; \mathcal{B}II_p^{(1)}(V \mid a, b, \Theta_1, \Theta_2) \propto 
 {\det(V)}^{a-\frac12(p+1)} \\
&amp; \quad
\int_{S&gt;0}
\etr\bigl(-(I_p+V)S\bigr)
{\det(S)}^{a+b-\frac12(p+1)} 
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1{(S^{\frac12})}' V S^{\frac12}\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2S\right) \mathrm{d}S
\end{split}
\]</span> for <span class="math inline">\(V&gt;0\)</span>.</p>
<p>If <span class="math inline">\(\Theta_1\)</span> is scalar, the distribution does not depend on the choice of <span class="math inline">\(W_2^\frac12\)</span>.</p>
<h3 id="boxedmathcalbii_p2abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(2)}(a,b,\Theta_1,\Theta_2)}\)</span></h3>
<p>More generally, we give the density of <span class="math display">\[
V_2 = W_1^{\frac12} W_2^{-1} {(W_1^{\frac12})}'
\]</span> where <span class="math inline">\(W_1^{\frac12}{(W_1^{\frac12})}' = W_1\)</span>.</p>
<p>Assuming <span class="math inline">\(a &gt; \frac12(p-1)\)</span>, it is clear from the definitions that <span class="math display">\[
V_2^{-1} \sim \mathcal{B}II_p^{(1)}(b,a,\Theta_2,\Theta_1).
\]</span></p>
<p>The density of <span class="math inline">\(V_2\)</span> is <span class="math display">\[
\begin{split}
&amp; \mathcal{B}II_p^{(2)}(V \mid a, b, \Theta_1, \Theta_2) \propto  
 {\det(V)}^{-b-\frac12(p+1)} \\ 
&amp; \quad \int_{S &gt;0}
\etr\bigl(-(I_p+V^{-1})S\bigr)
{\det(S)}^{a+b-\frac12(p+1)}  
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1S\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2{(S^\frac12)}' V^{-1} S^\frac12\right)
\mathrm{d}S.
\end{split}
\]</span> for <span class="math inline">\(V &gt;0\)</span>.</p>
<p>If <span class="math inline">\(\Theta_2\)</span> is scalar, the distribution does not depend on the choice of <span class="math inline">\(W_1^\frac12\)</span>.</p>
<p>If <span class="math inline">\(\Theta_1\)</span> and <span class="math inline">\(\Theta_2\)</span> are scalar, this is the same distribution as <span class="math inline">\(\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span>.</p>
<p>If we take <span class="math inline">\(W_1^{\frac12}\)</span> the symmetric square root of <span class="math inline">\(W_1\)</span>, then <span class="math inline">\(V_2{(I_p+V_2)}^{-1} \sim \mathcal{B}I_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span>.</p>
<h1 id="proofs">Proofs</h1>
<p>To derive the densities, we start with the joint density of <span class="math inline">\(W_1\)</span> and <span class="math inline">\(W_2\)</span> which is <span class="math display">\[
C \, \etr\left(-\frac12 W_1\right)\etr\left(-\frac12 W_2\right)
{\det(W_1)}^{a-\frac12(p+1)} {\det(W_2)}^{b-\frac12(p+1)}
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1W_1\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2W_2\right)
\]</span> where <span class="math inline">\(C\)</span> is a constant.</p>
<p>In our following calculations, we always denote by <span class="math inline">\(C\)</span> a constant not depending of the variables. The value of <span class="math inline">\(C\)</span> is relative to each expression in which it is contained: two <span class="math inline">\(C\)</span>’s written at two different places have not the same value.</p>
<h3 id="boxedmathcalbi_p1abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(1)}(a,b,\Theta_1,\Theta_2)}\)</span></h3>
<p>Recall that <span class="math inline">\(\mathcal{B}I_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span> is the distribution of <span class="math display">\[
U = {(W_1+W_2)}^{-\frac12}W_1{(W_1+W_2)}^{-\frac12}.
\]</span> By applying the transformation <span class="math inline">\(W_1+W_2=S\)</span> and <span class="math inline">\(W_1 = S^{\frac12} U S^\frac12\)</span>, whose Jacobian is <span class="math inline">\(J(W_1, W_2 \rightarrow U, S) = {\det(S)}^{\frac12(p+1)}\)</span>, we get the pdf of <span class="math inline">\((U,S)\)</span> as <span class="math display">\[
\begin{aligned}
C\, &amp;
{\det(U)}^{a-\frac12(p+1)} {\det(I_p-U)}^{b-\frac12(p+1)} \\ 
&amp; 
\etr\left(-\frac12 S\right)
 {\det(S)}^{a+b-\frac12(p+1)}
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1S^{\frac12} U S^\frac12\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2S^{\frac12}(I_p-U) S^\frac12\right).
\end{aligned}
\]</span> Thus the density of <span class="math inline">\(U\)</span> is <span class="math display">\[
\begin{aligned}
C\, &amp;
{\det(U)}^{a-\frac12(p+1)} {\det(I_p-U)}^{b-\frac12(p+1)} \\
&amp; \int_{S&gt;0} \etr\left(-\frac12 S\right)
 {\det(S)}^{a+b-\frac12(p+1)}
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1S^{\frac12}U{(S^\frac12)}'\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2S^{\frac12}(I_p-U)S^\frac12\right) 
\mathrm{d}S
\\ 
= C\,&amp; 
{\det(U)}^{a-\frac12(p+1)} {\det(I_p-U)}^{b-\frac12(p+1)} \\
&amp; \int_{S&gt;0} \etr(-S)
{\det(S)}^{a+b-\frac12(p+1)}
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1S^{\frac12} U S^\frac12\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2S^{\frac12}(I_p-U)S^\frac12\right)
\mathrm{d}S. 
\end{aligned}
\]</span></p>
<h3 id="boxedmathcalbi_p2abtheta_1theta_2"><span class="math inline">\(\boxed{\mathcal{B}I_p^{(2)}(a,b,\Theta_1,\Theta_2)}\)</span></h3>
<p>Recall that <span class="math inline">\(\mathcal{B}I_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span> is the distribution of <span class="math display">\[
U = W_1^\frac12{(W_1+W_2)}^{-1}W_1^\frac12.
\]</span></p>
<p>We use the transformation <span class="math inline">\(W_1+W_2 = W_1^{\frac12}U^{-1}W_1^{\frac12}\)</span>. The Jacobian of this transformation is <span class="math inline">\(J(W_1, W_2 \rightarrow U, W_1) = {\det(W_1)}^{\frac12(p+1)} {\det(U)}^{-(p+1)}\)</span>, and we get the pdf of <span class="math inline">\((U,W_1)\)</span> as <span class="math display">\[
\begin{aligned}
C \, &amp;
{\det(W_1)}^{a+b-\frac12(p+1)} 
{\det(U)}^{-(p+1)}
{\det(U^{-1}-I_p)}^{b-\frac12(p+1)} \\
&amp; \etr\left(-\frac12 W_1U^{-1}\right)
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1W_1\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2W_1^{\frac12}(U^{-1}-I_p)W_1^\frac12\right) 
\\ = 
C \, &amp; 
{\det(W_1)}^{a+b-\frac12(p+1)} 
{\det(U)}^{-b-\frac12(p+1)}
{\det(I_p-U)}^{b-\frac12(p+1)} \\ 
&amp; \etr\left(-\frac12 W_1U^{-1}\right)
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1W_1\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2W_1^{\frac12}U^{-1}(I_p-U)W_1^\frac12\right).
\end{aligned}
\]</span> Thus the density of <span class="math inline">\(U\)</span> is <span class="math display">\[
\begin{aligned}
C\, &amp;
{\det(U)}^{-b-\frac12(p+1)}
{\det(I_p-U)}^{b-\frac12(p+1)} \\ 
&amp; \int_{W_1&gt;0}
\etr\left(-\frac12 W_1U^{-1}\right)
{\det(W_1)}^{a+b-\frac12(p+1)} \\
&amp; \qquad
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1W_1\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2W_1^{\frac12}U^{-1}(I_p-U)W_1^\frac12\right)
\mathrm{d}W_1\\
= C\, &amp;  
{\det\bigl(U{(I_p-U)}^{-1}\bigr)}^{-b-\frac12(p+1)}
{\det(I_p-U)}^{-(p+1)} \\
&amp; \int_{S&gt;0}
\etr(- U^{-1}S)
{\det(S)}^{a+b-\frac12(p+1)} 
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1S\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2S^{\frac12}U^{-1}(I_p-U)S^\frac12\right)
\mathrm{d}S.
\end{aligned}
\]</span> Let’s derive the density of <span class="math inline">\(U{(I_p-U)}^{-1}\)</span>. Using the transformation <span class="math inline">\(U = V{(I_p+V)}^{-1}\)</span> with Jacobian <span class="math inline">\(J(U \rightarrow V) = {\det(I_p+V)}^{-(p+1)}\)</span>, we get the density of <span class="math inline">\(V\)</span> as <span class="math display">\[
\begin{aligned}
C\, &amp;
{\det(V)}^{-b-\frac12(p+1)} \\
&amp; \int_{S&gt;0}
\etr\bigl(-(I_p+V^{-1})S\bigr)
{\det(S)}^{a+b-\frac12(p+1)} 
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1S\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2S^{\frac12}V^{-1}S^\frac12\right)
\mathrm{d}S.
\end{aligned}
\]</span> This is the density of <span class="math inline">\(\mathcal{B}II_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span>.</p>
<h3 id="boxedmathcalbii_p1abtheta_1theta_2-1"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)}\)</span></h3>
<p>Recall that <span class="math inline">\(\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span> is the distribution of <span class="math display">\[
V = {(W_2^{-\frac12})}' W_1 W_2^{-\frac12}.
\]</span></p>
<p>Transforming <span class="math inline">\(W_1 = {(W_2^{\frac12})}' V W_2^{\frac12}\)</span> with Jacobian <span class="math inline">\(J(W_1, W_2 \rightarrow V, W_2) = {\det(W_2)}^{\frac12(p+1)}\)</span>, we get the density of <span class="math inline">\((V,W_2)\)</span> as <span class="math display">\[
\begin{aligned}
C\, &amp; 
{\det(V)}^{a-\frac12(p+1)} {\det(W_2)}^{a+b-\frac12(p+1)} \\
&amp; 
\etr\left(-\frac12 (I_p+V)W_2\right)
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1 {(W_2^{\frac12})}' V W_2^{\frac12}\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2W_2\right).
\end{aligned}
\]</span> Thus, the density of <span class="math inline">\(V\)</span> is <span class="math display">\[
\begin{aligned}
C\, &amp; 
{\det(V)}^{a-\frac12(p+1)} \\ 
&amp; \int_{S&gt;0}
\etr\bigl(-(I_p+V)S\bigr)
{\det(S)}^{a+b-\frac12(p+1)} 
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1{(S^{\frac12})}' V S^{\frac12}\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2S\right)
\mathrm{d}S.
\end{aligned}
\]</span></p>
<h3 id="boxedmathcalbii_p2abtheta_1theta_2-1"><span class="math inline">\(\boxed{\mathcal{B}II_p^{(2)}(a,b,\Theta_1,\Theta_2)}\)</span></h3>
<p>Recall that <span class="math inline">\(\mathcal{B}II_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span> is the distribution of <span class="math display">\[
V = W_1^{\frac12} W_2^{-1} {(W_1^{\frac12})}'.
\]</span></p>
<p>We apply the transformation <span class="math inline">\(W_2 = {(W_1^\frac12)}' V^{-1} W_1^\frac12\)</span>. The Jacobian of this transformation is <span class="math inline">\(J(W_1, W_2 \rightarrow V, W_1) = {\det(W_1)}^{\frac12(p+1)}{\det(V)}^{-(p+1)}\)</span>. We get the density of <span class="math inline">\((V,W_1)\)</span> as <span class="math display">\[
\begin{aligned}
C\, &amp;
{\det(W_1)}^{a+b-\frac12(p+1)} {\det(V)}^{-b-\frac12(p+1)} \\
&amp;
\etr\left(-\frac12 W_1\right)\etr\left(-\frac12 W_1V^{-1}\right)
{}_0\!F_1\left(a, \frac{1}{4}\Theta_1W_1\right)
{}_0\!F_1\left(b, \frac{1}{4}\Theta_2{(W_1^\frac12)}' V^{-1} W_1^\frac12\right).
\end{aligned}
\]</span> Thus the density of <span class="math inline">\(V\)</span> is <span class="math display">\[
\begin{aligned}
C\, &amp;
{\det(V)}^{-b-\frac12(p+1)} \\ 
&amp; \int_{S &gt;0}
\etr\bigl(-(I_p+V^{-1})S\bigr)
{\det(S)}^{a+b-\frac12(p+1)}  
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1S\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2{(S^\frac12)}' V^{-1} S^\frac12\right)
\mathrm{d}S.
\end{aligned}
\]</span> Now assume <span class="math inline">\(\Theta_2\)</span> is scalar. Then one has <span class="math display">\[
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2{(S^\frac12)}' V^{-1} S^\frac12\right) 
= {}_0\!F_1\left(b, \frac{1}{2}\Theta_2 S V^{-1}\right).
\]</span> Doing the change of variables <span class="math inline">\(R = S V^{-1}\)</span> in the integral, we get the density of <span class="math inline">\(V\)</span> as <span class="math display">\[
\begin{aligned}
C\, &amp;
{\det(V)}^{a-\frac12(p+1)} \\ 
&amp; \int_{R &gt;0}
\etr\bigl(-(I_p+V)R\bigr)
{\det(R)}^{a+b-\frac12(p+1)}  
{}_0\!F_1\left(a, \frac{1}{2}\Theta_1 R V\right)
{}_0\!F_1\left(b, \frac{1}{2}\Theta_2 R\right)
\mathrm{d}R.
\end{aligned}
\]</span> If in addition, <span class="math inline">\(\Theta_1\)</span> is scalar, this is the density of <span class="math inline">\(\mathcal{B}II_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span>.</p>
<h2 id="simplifications-in-the-singly-noncentral-case">Simplifications in the singly noncentral case</h2>
<p>One has <span class="math inline">\({}_0\!F_1(\alpha, \mathbf{0}) = 1\)</span>. Thus, when <span class="math inline">\(\Theta_1\)</span> or <span class="math inline">\(\Theta_2\)</span> is the null matrix, we get integrals like <span class="math display">\[
\int_{S&gt;0}
\etr(-ZS)
{\det(S)}^{\alpha-\frac12(p+1)} 
{}_0\!F_1\left(\beta, \frac{1}{2}\Theta S T \right)
\mathrm{d}S,
\]</span> for example in the density of <span class="math inline">\(\mathcal{B}I_p^{(2)}(a,b,\Theta_1,\Theta_2)\)</span> when <span class="math inline">\(\Theta_2\)</span> is the null matrix, or in the density of <span class="math inline">\(\mathcal{B}I_p^{(1)}(a,b,\Theta_1,\Theta_2)\)</span> when <span class="math inline">\(\Theta_1\)</span> is the null matrix and <span class="math inline">\(\Theta_2\)</span> is scalar.</p>
<p>This integral is equal to <span class="math display">\[
\Gamma_p(\alpha){\det(Z)}^{-\alpha} 
{}_1\!F_1\left(\alpha, \beta, \frac{1}{2}\Theta Z^{-1} T \right).
\]</span></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->

  <!-- Google Prettify -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script> -->
  <script src="../libraries/highlighters/prettify/js/lang-r.js"></script>
  <script>
    var pres = document.getElementsByTagName("pre");
    for (var i = 0; i < pres.length; ++i) {
      
        pres[i].className = pres[i].className + " prettyprint linenums";
      
    }
    prettyPrint();
  </script> 


</html>