<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Back to the parametric Hopf torus</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:25px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:21px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Back to the parametric Hopf torus</h1> 
          <div class="info">
    Posted on April 12, 2020
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a title="All pages tagged 'R'." href="../tags/R.html">R</a>, <a title="All pages tagged 'graphics'." href="../tags/graphics.html">graphics</a>, <a title="All pages tagged 'rgl'." href="../tags/rgl.html">rgl</a>, <a title="All pages tagged 'geometry'." href="../tags/geometry.html">geometry</a>, <a title="All pages tagged 'maths'." href="../tags/maths.html">maths</a>
    
</div>

<p>In a <a href="./HopfTorusParametric.html">previous post</a>, I explained how to get a parameterization of a Hopf cylinder or torus. There is a clearer way, which I present here.</p>
<p>For the Hopf map, the preimage of a point <span class="math inline">\(p=(p_x,p_y,p_z)\)</span> on the unit sphere <span class="math inline">\(S^2\)</span> is the circle on <span class="math inline">\(S^3\)</span> with parametrization: <span class="math display">\[
\begin{array}{ccc}
\mathcal{C}_p \colon &amp; (0,2\pi[ &amp; \longrightarrow &amp; S^3 \\
 &amp; \phi &amp; \longmapsto &amp; \mathcal{C}_p(\phi) 
\end{array}
\]</span> where <span class="math display">\[
\mathcal{C}_p(\phi) = 
\frac{1}{\sqrt{2(1+p_z)}}
\begin{pmatrix}
(1+p_z) \cos(\phi) \\
p_x \sin(\phi) - p_y \cos(\phi) \\
p_x \cos(\phi) + p_y \sin(\phi) \\
(1+p_z) \sin(\phi)
\end{pmatrix}.
\]</span></p>
<p>Now consider a spherical curve. That is, let <span class="math inline">\(\Gamma\)</span> be a function mapping an interval <span class="math inline">\(I \subset \mathbb{R}\)</span> to the unit sphere <span class="math inline">\(S^2\)</span>. Then the Hopf cylinder corresponding to <span class="math inline">\(\Gamma\)</span> has parameterization <span class="math display">\[
\begin{array}{ccc}
H_\Gamma \colon &amp; I \times (0,2\pi[ &amp; \longrightarrow &amp; S^3 \\
 &amp; (t, \phi) &amp; \longmapsto &amp; \mathcal{C}_{\Gamma(t)}(\phi) 
\end{array}.
\]</span> Recall the <a href="./HopfTorusTennisBall.html">tennis ball curve</a> example, given for a real constant <span class="math inline">\(A\)</span> and an integer constant <span class="math inline">\(n\)</span> by: <span class="math display">\[
\Gamma(t) = 
\begin{pmatrix}
\sin\bigl(\pi/2 - (\pi/2 - A) \cos(nt)\bigr) 
\cos\bigl(t + A \sin(2nt)\bigr) \\ 
\sin\bigl(\pi/2 - (\pi/2 - A) \cos(nt)\bigr) 
\sin\bigl(t + A \sin(2nt)\bigr) \\ 
\cos\bigl(\pi/2 - (\pi/2 - A) \cos(nt)\bigr)
\end{pmatrix}, \quad t \in (0,2\pi[.
\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>A &lt;-<span class="st"> </span><span class="fl">0.44</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>n &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>Gamma &lt;-<span class="st"> </span><span class="cf">function</span>(t){</span>
<span id="cb1-4"><a href="#cb1-4"></a>  alpha &lt;-<span class="st"> </span>pi<span class="op">/</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(pi<span class="op">/</span><span class="dv">2</span><span class="op">-</span>A)<span class="op">*</span><span class="kw">cos</span>(n<span class="op">*</span>t)</span>
<span id="cb1-5"><a href="#cb1-5"></a>  beta &lt;-<span class="st"> </span>t <span class="op">+</span><span class="st"> </span>A<span class="op">*</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">*</span>t)</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="kw">c</span>(</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="kw">sin</span>(alpha) <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(beta),</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="kw">sin</span>(alpha) <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(beta),</span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="kw">cos</span>(alpha)</span>
<span id="cb1-10"><a href="#cb1-10"></a>  )</span>
<span id="cb1-11"><a href="#cb1-11"></a>}</span>
<span id="cb1-12"><a href="#cb1-12"></a>HopfInverse &lt;-<span class="st"> </span><span class="cf">function</span>(p, phi){</span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="kw">c</span>(</span>
<span id="cb1-14"><a href="#cb1-14"></a>    (<span class="dv">1</span><span class="op">+</span>p[<span class="dv">3</span>])<span class="op">*</span><span class="kw">cos</span>(phi),</span>
<span id="cb1-15"><a href="#cb1-15"></a>    p[<span class="dv">1</span>]<span class="op">*</span><span class="kw">sin</span>(phi) <span class="op">-</span><span class="st"> </span>p[<span class="dv">2</span>]<span class="op">*</span><span class="kw">cos</span>(phi), </span>
<span id="cb1-16"><a href="#cb1-16"></a>    p[<span class="dv">1</span>]<span class="op">*</span><span class="kw">cos</span>(phi) <span class="op">+</span><span class="st"> </span>p[<span class="dv">2</span>]<span class="op">*</span><span class="kw">sin</span>(phi),</span>
<span id="cb1-17"><a href="#cb1-17"></a>    (<span class="dv">1</span><span class="op">+</span>p[<span class="dv">3</span>])<span class="op">*</span><span class="kw">sin</span>(phi)</span>
<span id="cb1-18"><a href="#cb1-18"></a>  ) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>p[<span class="dv">3</span>])) </span>
<span id="cb1-19"><a href="#cb1-19"></a>}</span>
<span id="cb1-20"><a href="#cb1-20"></a>Stereo &lt;-<span class="st"> </span><span class="cf">function</span>(q){</span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="dv">2</span><span class="op">*</span>q[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>q[<span class="dv">4</span>])</span>
<span id="cb1-22"><a href="#cb1-22"></a>}</span>
<span id="cb1-23"><a href="#cb1-23"></a>F &lt;-<span class="st"> </span><span class="cf">function</span>(t, phi){</span>
<span id="cb1-24"><a href="#cb1-24"></a>  <span class="kw">Stereo</span>(<span class="kw">HopfInverse</span>(<span class="kw">Gamma</span>(t), phi))</span>
<span id="cb1-25"><a href="#cb1-25"></a>}</span></code></pre></div>
<p>Now we’re ready to plot the stereographic projection of the Hopf torus with <code>misc3d</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>fx &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">F</span>(u,v)[<span class="dv">1</span>])</span>
<span id="cb2-2"><a href="#cb2-2"></a>fy &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">F</span>(u,v)[<span class="dv">2</span>])</span>
<span id="cb2-3"><a href="#cb2-3"></a>fz &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">F</span>(u,v)[<span class="dv">3</span>])</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">library</span>(misc3d)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </span>
<span id="cb2-6"><a href="#cb2-6"></a>             <span class="dt">n =</span> <span class="dv">300</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>rgl<span class="op">::</span><span class="kw">view3d</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dt">zoom =</span> <span class="fl">0.65</span>)</span></code></pre></div>
<p><img src="./figures/HopfTorus_grey.png" /></p>
<p>A ring cyclide is a Hopf torus. It corresponds to the case when <span class="math inline">\(\Gamma\)</span> describes a circle on the unit sphere <span class="math inline">\(S^2\)</span>. Below is a R function to compute such a circle.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># helper function: plane passing by points p1, p2, p3 </span></span>
<span id="cb3-2"><a href="#cb3-2"></a>plane3pts &lt;-<span class="st"> </span><span class="cf">function</span>(p1,p2,p3){ </span>
<span id="cb3-3"><a href="#cb3-3"></a>    xcoef &lt;-<span class="st"> </span>(p1[<span class="dv">2</span>]<span class="op">-</span>p2[<span class="dv">2</span>])<span class="op">*</span>(p2[<span class="dv">3</span>]<span class="op">-</span>p3[<span class="dv">3</span>])<span class="op">-</span>(p1[<span class="dv">3</span>]<span class="op">-</span>p2[<span class="dv">3</span>])<span class="op">*</span>(p2[<span class="dv">2</span>]<span class="op">-</span>p3[<span class="dv">2</span>])</span>
<span id="cb3-4"><a href="#cb3-4"></a>    ycoef &lt;-<span class="st"> </span>(p1[<span class="dv">3</span>]<span class="op">-</span>p2[<span class="dv">3</span>])<span class="op">*</span>(p2[<span class="dv">1</span>]<span class="op">-</span>p3[<span class="dv">1</span>])<span class="op">-</span>(p1[<span class="dv">1</span>]<span class="op">-</span>p2[<span class="dv">1</span>])<span class="op">*</span>(p2[<span class="dv">3</span>]<span class="op">-</span>p3[<span class="dv">3</span>])</span>
<span id="cb3-5"><a href="#cb3-5"></a>    zcoef &lt;-<span class="st"> </span>(p1[<span class="dv">1</span>]<span class="op">-</span>p2[<span class="dv">1</span>])<span class="op">*</span>(p2[<span class="dv">2</span>]<span class="op">-</span>p3[<span class="dv">2</span>])<span class="op">-</span>(p1[<span class="dv">2</span>]<span class="op">-</span>p2[<span class="dv">2</span>])<span class="op">*</span>(p2[<span class="dv">1</span>]<span class="op">-</span>p3[<span class="dv">1</span>])</span>
<span id="cb3-6"><a href="#cb3-6"></a>    offset &lt;-<span class="st"> </span>p1[<span class="dv">1</span>]<span class="op">*</span>xcoef <span class="op">+</span><span class="st"> </span>p1[<span class="dv">2</span>]<span class="op">*</span>ycoef <span class="op">+</span><span class="st"> </span>p1[<span class="dv">3</span>]<span class="op">*</span>zcoef</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="kw">c</span>(xcoef, ycoef, zcoef, offset)</span>
<span id="cb3-8"><a href="#cb3-8"></a>}</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># helper function: cross product </span></span>
<span id="cb3-11"><a href="#cb3-11"></a>cross &lt;-<span class="st"> </span><span class="cf">function</span>(v, w){ </span>
<span id="cb3-12"><a href="#cb3-12"></a>  <span class="kw">c</span>(</span>
<span id="cb3-13"><a href="#cb3-13"></a>    v[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>v[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">2</span>], </span>
<span id="cb3-14"><a href="#cb3-14"></a>    v[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>v[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">3</span>], </span>
<span id="cb3-15"><a href="#cb3-15"></a>    v[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>v[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>w[<span class="dv">1</span>]</span>
<span id="cb3-16"><a href="#cb3-16"></a>  )</span>
<span id="cb3-17"><a href="#cb3-17"></a>}</span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co"># circle passing by points three points p1, p2, p3 </span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co"># given in Cartesian coordinates</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>circle3pts &lt;-<span class="st"> </span><span class="cf">function</span>(p1, p2, p3){</span>
<span id="cb3-22"><a href="#cb3-22"></a>  p12 &lt;-<span class="st"> </span>(p1<span class="op">+</span>p2)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>  p23 &lt;-<span class="st"> </span>(p2<span class="op">+</span>p3)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>  v12 &lt;-<span class="st"> </span>p2<span class="op">-</span>p1</span>
<span id="cb3-25"><a href="#cb3-25"></a>  v23 &lt;-<span class="st"> </span>p3<span class="op">-</span>p2</span>
<span id="cb3-26"><a href="#cb3-26"></a>  plane &lt;-<span class="st"> </span><span class="kw">plane3pts</span>(p1, p2, p3)</span>
<span id="cb3-27"><a href="#cb3-27"></a>  A &lt;-<span class="st"> </span><span class="kw">rbind</span>(plane[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], v12, v23)</span>
<span id="cb3-28"><a href="#cb3-28"></a>  b &lt;-<span class="st"> </span><span class="kw">c</span>(plane[<span class="dv">4</span>], <span class="kw">sum</span>(p12<span class="op">*</span>v12), <span class="kw">sum</span>(p23<span class="op">*</span>v23))</span>
<span id="cb3-29"><a href="#cb3-29"></a>  center &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">solve</span>(A) <span class="op">%*%</span><span class="st"> </span>b)</span>
<span id="cb3-30"><a href="#cb3-30"></a>  r &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(p1<span class="op">-</span>center)))</span>
<span id="cb3-31"><a href="#cb3-31"></a>  i &lt;-<span class="st"> </span>(p1<span class="op">-</span>center) <span class="op">/</span><span class="st"> </span>r</span>
<span id="cb3-32"><a href="#cb3-32"></a>  normal &lt;-<span class="st"> </span>plane[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(plane[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])))</span>
<span id="cb3-33"><a href="#cb3-33"></a>  <span class="kw">list</span>(<span class="dt">center =</span> center, <span class="dt">radius =</span> r, <span class="dt">i =</span> i, <span class="dt">j =</span> <span class="kw">cross</span>(i,normal))</span>
<span id="cb3-34"><a href="#cb3-34"></a>} <span class="co"># circle parameterization: center + radius*(cos(t)*i + sin(t)*j)</span></span>
<span id="cb3-35"><a href="#cb3-35"></a></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="co"># circle on unit sphere passing by three points </span></span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="co"># given in spherical coordinates </span></span>
<span id="cb3-38"><a href="#cb3-38"></a>circleOnUnitSphere &lt;-<span class="st"> </span><span class="cf">function</span>(thph1, thph2, thph3){</span>
<span id="cb3-39"><a href="#cb3-39"></a>  theta1 &lt;-<span class="st"> </span>thph1[<span class="dv">1</span>]; phi1 &lt;-<span class="st"> </span>thph1[<span class="dv">2</span>]</span>
<span id="cb3-40"><a href="#cb3-40"></a>  theta2 &lt;-<span class="st"> </span>thph2[<span class="dv">1</span>]; phi2 &lt;-<span class="st"> </span>thph2[<span class="dv">2</span>]</span>
<span id="cb3-41"><a href="#cb3-41"></a>  theta3 &lt;-<span class="st"> </span>thph3[<span class="dv">1</span>]; phi3 &lt;-<span class="st"> </span>thph3[<span class="dv">2</span>]</span>
<span id="cb3-42"><a href="#cb3-42"></a>  p1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sin</span>(theta1)<span class="op">*</span><span class="kw">cos</span>(phi1), <span class="kw">sin</span>(theta1)<span class="op">*</span><span class="kw">sin</span>(phi1), <span class="kw">cos</span>(theta1))</span>
<span id="cb3-43"><a href="#cb3-43"></a>  p2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sin</span>(theta2)<span class="op">*</span><span class="kw">cos</span>(phi2), <span class="kw">sin</span>(theta2)<span class="op">*</span><span class="kw">sin</span>(phi2), <span class="kw">cos</span>(theta2))</span>
<span id="cb3-44"><a href="#cb3-44"></a>  p3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sin</span>(theta3)<span class="op">*</span><span class="kw">cos</span>(phi3), <span class="kw">sin</span>(theta3)<span class="op">*</span><span class="kw">sin</span>(phi3), <span class="kw">cos</span>(theta3))</span>
<span id="cb3-45"><a href="#cb3-45"></a>  <span class="kw">circle3pts</span>(p1, p2, p3)</span>
<span id="cb3-46"><a href="#cb3-46"></a>}</span></code></pre></div>
<p>The function returns a list with four elements: a point <code>center</code>, a number <code>radius</code>, and two vectors <code>i</code> and <code>j</code>. The parameterization of the spherical circle is then <code>center + radius*(cos(t)*i + sin(t)*j)</code> for <code>t</code> <span class="math inline">\(\in (0, 2\pi[\)</span>.</p>
<p>Let’s try. We enter three pairs of spherical coordinates and we apply the <code>circleOnUnitSphere</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>thph1 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.3</span>, <span class="fl">1.5</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>thph2 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.9</span>, <span class="fl">2.8</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>thph3 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>circ &lt;-<span class="st"> </span><span class="kw">circleOnUnitSphere</span>(thph1, thph2, thph3)</span></code></pre></div>
<p>Then we define the parametrization of the stereographically projected Hopf torus:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>F &lt;-<span class="st"> </span><span class="cf">function</span>(t, phi){</span>
<span id="cb5-2"><a href="#cb5-2"></a>  p &lt;-<span class="st"> </span><span class="kw">with</span>(circ, center <span class="op">+</span><span class="st"> </span>radius<span class="op">*</span>(<span class="kw">cos</span>(t)<span class="op">*</span>i <span class="op">+</span><span class="st"> </span><span class="kw">sin</span>(t)<span class="op">*</span>j))</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="kw">Stereo</span>(<span class="kw">HopfInverse</span>(p, phi))</span>
<span id="cb5-4"><a href="#cb5-4"></a>}</span></code></pre></div>
<p>And we plot:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </span>
<span id="cb6-2"><a href="#cb6-2"></a>             <span class="dt">n =</span> <span class="dv">250</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>rgl<span class="op">::</span><span class="kw">view3d</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dt">zoom =</span> <span class="fl">0.65</span>)</span></code></pre></div>
<p><img src="./figures/cyclide_grey.png" /></p>
<p>By rotating our spherical circle about the <span class="math inline">\(z\)</span>-axis, we can obtain the <a href="./linkedCyclidesParametric.html">linked cyclides</a>. Below is a R function to perform a rotation in spherical coordinates. See <a href="http://stla.github.io/stlapblog/posts/RotationSphericalCoordinates.html">this post</a> on my former blog for some explanations.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># helper functions: basic rotations ####</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>Rx &lt;-<span class="st"> </span><span class="cf">function</span>(alpha){</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="op">-</span>1i<span class="op">*</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>)),</span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="kw">c</span>(<span class="op">-</span>1i<span class="op">*</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span>
<span id="cb7-6"><a href="#cb7-6"></a>Ry &lt;-<span class="st"> </span><span class="cf">function</span>(alpha){</span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="op">-</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>)),</span>
<span id="cb7-8"><a href="#cb7-8"></a>        <span class="kw">c</span>(<span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>), <span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb7-9"><a href="#cb7-9"></a>}</span>
<span id="cb7-10"><a href="#cb7-10"></a>Rz &lt;-<span class="st"> </span><span class="cf">function</span>(alpha){</span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">exp</span>(<span class="op">-</span>1i<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>), <span class="dv">0</span>),</span>
<span id="cb7-12"><a href="#cb7-12"></a>        <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">exp</span>(1i<span class="op">*</span>alpha<span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb7-13"><a href="#cb7-13"></a>}</span>
<span id="cb7-14"><a href="#cb7-14"></a></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co"># 3D rotation in spherical coordinates ####</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#' @description Rotation of a vector given in spherical coordinates.</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#' @param theta_phi spherical coordinates, a vector containing the </span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#' colatitude (or polar angle), between 0 and pi, and the longitude </span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#' (or azimuthal angle), between 0 and 2pi</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#' @param axis either a letter 'x', 'y' or 'z', a numeric vector of </span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#' length 2 (the spherical coordinates of the axis), or a numeric </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#' vector of length 3 (the Cartesian coordinates of the axis)</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#' @param alpha angle of rotation</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#' @return The spherical coordinates of the transformed vector.</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>rotation &lt;-<span class="st"> </span><span class="cf">function</span>(theta_phi, <span class="dt">axis=</span><span class="st">&quot;x&quot;</span>, alpha){</span>
<span id="cb7-26"><a href="#cb7-26"></a>  <span class="cf">if</span>(<span class="kw">is.character</span>(axis)){</span>
<span id="cb7-27"><a href="#cb7-27"></a>    axis &lt;-<span class="st"> </span><span class="kw">match.arg</span>(axis, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>))</span>
<span id="cb7-28"><a href="#cb7-28"></a>    R &lt;-<span class="st"> </span><span class="cf">switch</span>(axis, </span>
<span id="cb7-29"><a href="#cb7-29"></a>                <span class="st">&quot;x&quot;</span> =<span class="st"> </span><span class="kw">Rx</span>(alpha),</span>
<span id="cb7-30"><a href="#cb7-30"></a>                <span class="st">&quot;y&quot;</span> =<span class="st"> </span><span class="kw">Ry</span>(alpha),</span>
<span id="cb7-31"><a href="#cb7-31"></a>                <span class="st">&quot;z&quot;</span> =<span class="st"> </span><span class="kw">Rz</span>(alpha))</span>
<span id="cb7-32"><a href="#cb7-32"></a>  }<span class="cf">else</span> <span class="cf">if</span>(<span class="kw">length</span>(axis) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</span>
<span id="cb7-33"><a href="#cb7-33"></a>    Theta &lt;-<span class="st"> </span>axis[<span class="dv">1</span>]; Phi &lt;-<span class="st"> </span>axis[<span class="dv">2</span>]</span>
<span id="cb7-34"><a href="#cb7-34"></a>    R &lt;-<span class="st"> </span><span class="kw">Rz</span>(Phi) <span class="op">%*%</span><span class="st"> </span><span class="kw">Ry</span>(Theta) <span class="op">%*%</span><span class="st"> </span><span class="kw">Rz</span>(alpha) <span class="op">%*%</span><span class="st"> </span></span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="st">           </span><span class="kw">t</span>(<span class="kw">Ry</span>(Theta)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(<span class="kw">Conj</span>(<span class="kw">Rz</span>(Phi)))</span>
<span id="cb7-36"><a href="#cb7-36"></a>  }<span class="cf">else</span> <span class="cf">if</span>(<span class="kw">length</span>(axis) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>){</span>
<span id="cb7-37"><a href="#cb7-37"></a>    axis &lt;-<span class="st"> </span>axis <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">c</span>(<span class="kw">crossprod</span>(axis)))</span>
<span id="cb7-38"><a href="#cb7-38"></a>    X &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb7-39"><a href="#cb7-39"></a>    Y &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span>1i), <span class="kw">c</span>(1i,<span class="dv">0</span>)) </span>
<span id="cb7-40"><a href="#cb7-40"></a>    Z &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb7-41"><a href="#cb7-41"></a>    R &lt;-<span class="st"> </span><span class="kw">cos</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">diag</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>1i<span class="op">*</span><span class="kw">sin</span>(alpha<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span></span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="st">           </span>(axis[<span class="dv">1</span>]<span class="op">*</span>X <span class="op">+</span><span class="st"> </span>axis[<span class="dv">2</span>]<span class="op">*</span>Y <span class="op">+</span><span class="st"> </span>axis[<span class="dv">3</span>]<span class="op">*</span>Z)</span>
<span id="cb7-43"><a href="#cb7-43"></a>  }<span class="cf">else</span>{</span>
<span id="cb7-44"><a href="#cb7-44"></a>    <span class="kw">stop</span>(<span class="st">&quot;`axis` must be either:</span></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="st">         - a letter ('x', 'y' or 'z')</span></span>
<span id="cb7-46"><a href="#cb7-46"></a><span class="st">         - a numeric vector of length two (spherical coordinates)</span></span>
<span id="cb7-47"><a href="#cb7-47"></a><span class="st">         - a numeric vector of length three (Cartesian coordinates)&quot;</span>)</span>
<span id="cb7-48"><a href="#cb7-48"></a>  }</span>
<span id="cb7-49"><a href="#cb7-49"></a>  theta &lt;-<span class="st"> </span>theta_phi[<span class="dv">1</span>]; phi &lt;-<span class="st"> </span>theta_phi[<span class="dv">2</span>]</span>
<span id="cb7-50"><a href="#cb7-50"></a>  qubit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(theta<span class="op">/</span><span class="dv">2</span>), <span class="kw">exp</span>(1i<span class="op">*</span>phi)<span class="op">*</span><span class="kw">sin</span>(theta<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb7-51"><a href="#cb7-51"></a>  newqubit &lt;-<span class="st"> </span>R <span class="op">%*%</span><span class="st"> </span>qubit</span>
<span id="cb7-52"><a href="#cb7-52"></a>  z0 &lt;-<span class="st"> </span>newqubit[<span class="dv">1</span>,<span class="dv">1</span>]; z1 &lt;-<span class="st"> </span>newqubit[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb7-53"><a href="#cb7-53"></a>  <span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">atan</span>(<span class="kw">Mod</span>(z1)<span class="op">/</span><span class="kw">Mod</span>(z0)), <span class="kw">Arg</span>(z1)<span class="op">-</span><span class="kw">Arg</span>(z0))</span>
<span id="cb7-54"><a href="#cb7-54"></a>}</span></code></pre></div>
<p>Now, let’s rotate our spherical circle and plot:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>thph1 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph1, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>thph2 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph2, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>thph3 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph3, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>circ &lt;-<span class="st"> </span><span class="kw">circleOnUnitSphere</span>(thph1, thph2, thph3)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </span>
<span id="cb8-6"><a href="#cb8-6"></a>             <span class="dt">n =</span> <span class="dv">250</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>thph1 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph1, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>thph2 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph2, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a>thph3 &lt;-<span class="st"> </span><span class="kw">rotation</span>(thph3, <span class="st">&quot;z&quot;</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a>circ &lt;-<span class="st"> </span><span class="kw">circleOnUnitSphere</span>(thph1, thph2, thph3)</span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="kw">parametric3d</span>(fx, fy, fz, <span class="dt">umin =</span> <span class="dv">0</span>, <span class="dt">umax =</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin =</span> <span class="dv">0</span>, <span class="dt">vmax =</span> <span class="dv">2</span><span class="op">*</span>pi, </span>
<span id="cb8-12"><a href="#cb8-12"></a>             <span class="dt">n =</span> <span class="dv">250</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">color =</span> <span class="st">&quot;#363940&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="./figures/linkedCyclides_grey.png" /></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->


</html>