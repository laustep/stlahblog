<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Parameterization of linked cyclides</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
    <link href="../libraries/highlighters/prettify/css/minimal.css" rel="stylesheet"> 
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:25px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:21px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo" style="position:absolute;">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Parameterization of linked cyclides</h1> 
          <div class="info">
    Posted on August 28, 2018
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a href="../tags/R.html">R</a>, <a href="../tags/graphics.html">graphics</a>, <a href="../tags/rgl.html">rgl</a>, <a href="../tags/geometry.html">geometry</a>, <a href="../tags/maths.html">maths</a>, <a href="../tags/asymptote.html">asymptote</a>
    
</div>

<p>In a <a href="https://laustep.github.io/stlahblog/posts/linkedCyclides.html">previous post</a>, I have shown how to draw some linked cyclides as unions of circles. In fact it is easy to parametrize the linked cyclides.</p>
<p>We show how to do so with R.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># &quot;inverse&quot; Hopf map</span></a>
<a class="sourceLine" id="cb1-2" title="2">hopfinverse &lt;-<span class="st"> </span><span class="cf">function</span>(q, t){ </a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>q[<span class="dv">3</span>])) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(q[<span class="dv">1</span>]<span class="op">*</span><span class="kw">cos</span>(t)<span class="op">+</span>q[<span class="dv">2</span>]<span class="op">*</span><span class="kw">sin</span>(t),</a>
<a class="sourceLine" id="cb1-4" title="4">                         <span class="kw">sin</span>(t)<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>q[<span class="dv">3</span>]),</a>
<a class="sourceLine" id="cb1-5" title="5">                         <span class="kw">cos</span>(t)<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>q[<span class="dv">3</span>]),</a>
<a class="sourceLine" id="cb1-6" title="6">                         q[<span class="dv">1</span>]<span class="op">*</span><span class="kw">sin</span>(t)<span class="op">-</span>q[<span class="dv">2</span>]<span class="op">*</span><span class="kw">cos</span>(t)) </a>
<a class="sourceLine" id="cb1-7" title="7">}</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># stereographic projection</span></a>
<a class="sourceLine" id="cb1-9" title="9">stereog &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="kw">c</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>])<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb1-11" title="11">}</a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co"># rotation in 4D space (right-isoclinic)</span></a>
<a class="sourceLine" id="cb1-13" title="13">rotate4d &lt;-<span class="st"> </span><span class="cf">function</span>(alpha, beta, xi, vec){</a>
<a class="sourceLine" id="cb1-14" title="14">  a =<span class="st"> </span><span class="kw">cos</span>(xi)</a>
<a class="sourceLine" id="cb1-15" title="15">  b =<span class="st"> </span><span class="kw">sin</span>(alpha)<span class="op">*</span><span class="kw">cos</span>(beta)<span class="op">*</span><span class="kw">sin</span>(xi)</a>
<a class="sourceLine" id="cb1-16" title="16">  c =<span class="st"> </span><span class="kw">sin</span>(alpha)<span class="op">*</span><span class="kw">sin</span>(beta)<span class="op">*</span><span class="kw">sin</span>(xi)</a>
<a class="sourceLine" id="cb1-17" title="17">  d =<span class="st"> </span><span class="kw">cos</span>(alpha)<span class="op">*</span><span class="kw">sin</span>(xi)</a>
<a class="sourceLine" id="cb1-18" title="18">  p =<span class="st"> </span>vec[<span class="dv">1</span>]; q =<span class="st"> </span>vec[<span class="dv">2</span>]; r =<span class="st"> </span>vec[<span class="dv">3</span>]; s =<span class="st"> </span>vec[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb1-19" title="19">  <span class="kw">c</span>(a<span class="op">*</span>p <span class="op">-</span><span class="st"> </span>b<span class="op">*</span>q <span class="op">-</span><span class="st"> </span>c<span class="op">*</span>r <span class="op">-</span><span class="st"> </span>d<span class="op">*</span>s,</a>
<a class="sourceLine" id="cb1-20" title="20">    a<span class="op">*</span>q <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>c<span class="op">*</span>s <span class="op">-</span><span class="st"> </span>d<span class="op">*</span>r,</a>
<a class="sourceLine" id="cb1-21" title="21">    a<span class="op">*</span>r <span class="op">-</span><span class="st"> </span>b<span class="op">*</span>s <span class="op">+</span><span class="st"> </span>c<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>d<span class="op">*</span>q,</a>
<a class="sourceLine" id="cb1-22" title="22">    a<span class="op">*</span>s <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>r <span class="op">-</span><span class="st"> </span>c<span class="op">*</span>q <span class="op">+</span><span class="st"> </span>d<span class="op">*</span>p)</a>
<a class="sourceLine" id="cb1-23" title="23">}</a>
<a class="sourceLine" id="cb1-24" title="24"></a>
<a class="sourceLine" id="cb1-25" title="25">phi &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># -pi/2 &lt; phi &lt; pi/2; close to pi/2 &lt;=&gt; big hole</span></a>
<a class="sourceLine" id="cb1-26" title="26"></a>
<a class="sourceLine" id="cb1-27" title="27">f1 &lt;-<span class="st"> </span><span class="cf">function</span>(theta, t){</a>
<a class="sourceLine" id="cb1-28" title="28">  p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(phi))</a>
<a class="sourceLine" id="cb1-29" title="29">  h &lt;-<span class="st"> </span><span class="kw">hopfinverse</span>(p, t)</a>
<a class="sourceLine" id="cb1-30" title="30">  hr &lt;-<span class="st"> </span><span class="kw">rotate4d</span>(pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb1-31" title="31">  <span class="kw">stereog</span>(hr)</a>
<a class="sourceLine" id="cb1-32" title="32">}</a>
<a class="sourceLine" id="cb1-33" title="33">f2 &lt;-<span class="st"> </span><span class="cf">function</span>(theta, t){</a>
<a class="sourceLine" id="cb1-34" title="34">  p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(phi))</a>
<a class="sourceLine" id="cb1-35" title="35">  h &lt;-<span class="st"> </span><span class="kw">hopfinverse</span>(p, t)</a>
<a class="sourceLine" id="cb1-36" title="36">  hr &lt;-<span class="st"> </span><span class="kw">rotate4d</span>(pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb1-37" title="37">  <span class="kw">stereog</span>(hr)</a>
<a class="sourceLine" id="cb1-38" title="38">}</a>
<a class="sourceLine" id="cb1-39" title="39">f3 &lt;-<span class="st"> </span><span class="cf">function</span>(theta, t){</a>
<a class="sourceLine" id="cb1-40" title="40">  p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(phi))</a>
<a class="sourceLine" id="cb1-41" title="41">  h &lt;-<span class="st"> </span><span class="kw">hopfinverse</span>(p, t)</a>
<a class="sourceLine" id="cb1-42" title="42">  hr &lt;-<span class="st"> </span><span class="kw">rotate4d</span>(pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb1-43" title="43">  <span class="kw">stereog</span>(hr)</a>
<a class="sourceLine" id="cb1-44" title="44">}</a>
<a class="sourceLine" id="cb1-45" title="45"></a>
<a class="sourceLine" id="cb1-46" title="46">f1x &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f1</span>(u,v)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1-47" title="47">f1y &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f1</span>(u,v)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb1-48" title="48">f1z &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f1</span>(u,v)[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb1-49" title="49">f2x &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f2</span>(u,v)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1-50" title="50">f2y &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f2</span>(u,v)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb1-51" title="51">f2z &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f2</span>(u,v)[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb1-52" title="52">f3x &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f3</span>(u,v)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1-53" title="53">f3y &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f3</span>(u,v)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb1-54" title="54">f3z &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(u,v) <span class="kw">f3</span>(u,v)[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb1-55" title="55"></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="kw">library</span>(misc3d)</a>
<a class="sourceLine" id="cb1-57" title="57"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb1-58" title="58"><span class="kw">open3d</span>(<span class="dt">windowRect=</span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">550</span>,<span class="dv">550</span>))</a>
<a class="sourceLine" id="cb1-59" title="59"><span class="kw">view3d</span>(<span class="dv">90</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-60" title="60">n &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1-61" title="61"><span class="kw">parametric3d</span>(f1x,f1y,f1z, <span class="dt">umin=</span><span class="dv">0</span>,<span class="dt">umax=</span><span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin=</span><span class="dv">0</span>,<span class="dt">vmax=</span><span class="dv">2</span><span class="op">*</span>pi, </a>
<a class="sourceLine" id="cb1-62" title="62">             <span class="dt">n=</span>n, </a>
<a class="sourceLine" id="cb1-63" title="63">             <span class="dt">smooth=</span><span class="ot">TRUE</span>, <span class="dt">color=</span><span class="st">&quot;chocolate&quot;</span>)</a>
<a class="sourceLine" id="cb1-64" title="64"><span class="kw">parametric3d</span>(f2x,f2y,f2z, <span class="dt">umin=</span><span class="dv">0</span>,<span class="dt">umax=</span><span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin=</span><span class="dv">0</span>,<span class="dt">vmax=</span><span class="dv">2</span><span class="op">*</span>pi, </a>
<a class="sourceLine" id="cb1-65" title="65">             <span class="dt">n=</span>n, </a>
<a class="sourceLine" id="cb1-66" title="66">             <span class="dt">smooth=</span><span class="ot">TRUE</span>, <span class="dt">color=</span><span class="st">&quot;midnightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-67" title="67"><span class="kw">parametric3d</span>(f3x,f3y,f3z, <span class="dt">umin=</span><span class="dv">0</span>,<span class="dt">umax=</span><span class="dv">2</span><span class="op">*</span>pi, <span class="dt">vmin=</span><span class="dv">0</span>,<span class="dt">vmax=</span><span class="dv">2</span><span class="op">*</span>pi, </a>
<a class="sourceLine" id="cb1-68" title="68">             <span class="dt">n=</span>n, </a>
<a class="sourceLine" id="cb1-69" title="69">             <span class="dt">smooth=</span><span class="ot">TRUE</span>, <span class="dt">color=</span><span class="st">&quot;firebrick4&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>This code generates the following picture:</p>
<p><img src="figures/linkedCyclidesParametric.png" /></p>
<p>And here is a <code>three.js</code> drawing:</p>
<iframe src="../frames/threejs_LinkedCyclidesParametric.html" width="100%" height="500px" scrolling="no" frameborder="0">
</iframe>
<p>Finally, here is a beautiful Asymptote rendering:</p>
<p><img src="figures/linkedCyclidesParametric_asy.png" /></p>
<p>It is generated by this code:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb2-1" title="1">settings.render = <span class="dv">4</span>;</a>
<a class="sourceLine" id="cb2-2" title="2">settings.outformat = <span class="st">&quot;pdf&quot;</span>;</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">// import modules</span></a>
<a class="sourceLine" id="cb2-5" title="5">import three;</a>
<a class="sourceLine" id="cb2-6" title="6">import solids;</a>
<a class="sourceLine" id="cb2-7" title="7">import palette;</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">// overall settings</span></a>
<a class="sourceLine" id="cb2-10" title="10">currentprojection = orthographic(<span class="dv">20</span>,<span class="dv">6</span>,<span class="dv">6</span>);</a>
<a class="sourceLine" id="cb2-11" title="11">viewportmargin = (<span class="dv">10</span>,<span class="dv">10</span>);</a>
<a class="sourceLine" id="cb2-12" title="12">size(<span class="dv">10</span><span class="er">cm</span>);</a>
<a class="sourceLine" id="cb2-13" title="13">currentlight = ((<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>));</a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">// &quot;inverse&quot; Hopf map ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-16" title="16">real[] hopfinverse(triple q, real t){</a>
<a class="sourceLine" id="cb2-17" title="17">  real f = <span class="dv">1</span>/sqrt(<span class="dv">2</span>*(<span class="dv">1</span>+q.z));</a>
<a class="sourceLine" id="cb2-18" title="18">  real[] out = {f*(q.x*cos(t)+q.y*sin(t)),</a>
<a class="sourceLine" id="cb2-19" title="19">                f*sin(t)*(<span class="dv">1</span>+q.z),</a>
<a class="sourceLine" id="cb2-20" title="20">                f*cos(t)*(<span class="dv">1</span>+q.z),</a>
<a class="sourceLine" id="cb2-21" title="21">                f*(q.x*sin(t)-q.y*cos(t))};</a>
<a class="sourceLine" id="cb2-22" title="22">  <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-23" title="23">}</a>
<a class="sourceLine" id="cb2-24" title="24"></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">// stereographic projection ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-26" title="26">triple stereog(real[] x){</a>
<a class="sourceLine" id="cb2-27" title="27">  <span class="cf">return</span> (x[<span class="dv">0</span>],x[<span class="dv">1</span>],x[<span class="dv">2</span>])/(<span class="dv">1</span>-x[<span class="dv">3</span>]);</a>
<a class="sourceLine" id="cb2-28" title="28">}</a>
<a class="sourceLine" id="cb2-29" title="29"></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="co">// rotation in 4D space (right-isoclinic) --------------------------------------</span></a>
<a class="sourceLine" id="cb2-31" title="31">real[] rotate4d(real alpha, real beta, real xi, real[] vec){</a>
<a class="sourceLine" id="cb2-32" title="32">  real a = cos(xi);</a>
<a class="sourceLine" id="cb2-33" title="33">  real b = sin(alpha)*cos(beta)*sin(xi);</a>
<a class="sourceLine" id="cb2-34" title="34">  real c = sin(alpha)*sin(beta)*sin(xi);</a>
<a class="sourceLine" id="cb2-35" title="35">  real d = cos(alpha)*sin(xi);</a>
<a class="sourceLine" id="cb2-36" title="36">  real p = vec[<span class="dv">0</span>];</a>
<a class="sourceLine" id="cb2-37" title="37">  real q = vec[<span class="dv">1</span>];</a>
<a class="sourceLine" id="cb2-38" title="38">  real r = vec[<span class="dv">2</span>];</a>
<a class="sourceLine" id="cb2-39" title="39">  real s = vec[<span class="dv">3</span>];</a>
<a class="sourceLine" id="cb2-40" title="40">  real[] out = {a*p - b*q - c*r - d*s,</a>
<a class="sourceLine" id="cb2-41" title="41">                a*q + b*p + c*s - d*r,</a>
<a class="sourceLine" id="cb2-42" title="42">                a*r - b*s + c*p + d*q,</a>
<a class="sourceLine" id="cb2-43" title="43">                a*s + b*r - c*q + d*p};</a>
<a class="sourceLine" id="cb2-44" title="44">  <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb2-45" title="45">}</a>
<a class="sourceLine" id="cb2-46" title="46"></a>
<a class="sourceLine" id="cb2-47" title="47"><span class="co">// -----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb2-48" title="48">real phi = <span class="fl">1.2</span>;</a>
<a class="sourceLine" id="cb2-49" title="49"></a>
<a class="sourceLine" id="cb2-50" title="50">triple f(real theta, real t, real beta){</a>
<a class="sourceLine" id="cb2-51" title="51">  triple p = (cos(theta)*cos(phi), sin(theta)*cos(phi), sin(phi));</a>
<a class="sourceLine" id="cb2-52" title="52">  real[] h = hopfinverse(p, t);</a>
<a class="sourceLine" id="cb2-53" title="53">  real[] hr = rotate4d(pi/<span class="dv">2</span>, beta, <span class="dv">1</span>, h);</a>
<a class="sourceLine" id="cb2-54" title="54">  <span class="cf">return</span> stereog(hr);</a>
<a class="sourceLine" id="cb2-55" title="55">}</a>
<a class="sourceLine" id="cb2-56" title="56"></a>
<a class="sourceLine" id="cb2-57" title="57">triple f1(pair uv){</a>
<a class="sourceLine" id="cb2-58" title="58">  <span class="cf">return</span> f(uv.x, uv.y, <span class="dv">0</span>);</a>
<a class="sourceLine" id="cb2-59" title="59">}</a>
<a class="sourceLine" id="cb2-60" title="60">triple f2(pair uv){</a>
<a class="sourceLine" id="cb2-61" title="61">  <span class="cf">return</span> f(uv.x, uv.y, <span class="dv">2</span><span class="er">pi</span>/<span class="dv">3</span>);</a>
<a class="sourceLine" id="cb2-62" title="62">}</a>
<a class="sourceLine" id="cb2-63" title="63">triple f3(pair uv){</a>
<a class="sourceLine" id="cb2-64" title="64">  <span class="cf">return</span> f(uv.x, uv.y, <span class="dv">4</span><span class="er">pi</span>/<span class="dv">3</span>);</a>
<a class="sourceLine" id="cb2-65" title="65">}</a>
<a class="sourceLine" id="cb2-66" title="66"></a>
<a class="sourceLine" id="cb2-67" title="67">splinetype[] Notaknot = {notaknot,notaknot,notaknot};</a>
<a class="sourceLine" id="cb2-68" title="68"></a>
<a class="sourceLine" id="cb2-69" title="69">surface s1=surface(f1,(<span class="dv">0</span>,<span class="dv">0</span>),(<span class="dv">2</span><span class="er">pi</span>,<span class="dv">2</span><span class="er">pi</span>),<span class="dv">35</span>,<span class="dv">35</span>,Notaknot,Notaknot);</a>
<a class="sourceLine" id="cb2-70" title="70">s1.colors(palette(s1.map(abs), Gradient(<span class="dv">256</span>,orange,black)));</a>
<a class="sourceLine" id="cb2-71" title="71">draw(s1,render(merge=true));</a>
<a class="sourceLine" id="cb2-72" title="72">surface s2=surface(f2,(<span class="dv">0</span>,<span class="dv">0</span>),(<span class="dv">2</span><span class="er">pi</span>,<span class="dv">2</span><span class="er">pi</span>),<span class="dv">35</span>,<span class="dv">35</span>,Notaknot,Notaknot);</a>
<a class="sourceLine" id="cb2-73" title="73">s2.colors(palette(s2.map(abs), Gradient(<span class="dv">256</span>,yellow,black)));</a>
<a class="sourceLine" id="cb2-74" title="74">draw(s2,render(merge=true));</a>
<a class="sourceLine" id="cb2-75" title="75">surface s3=surface(f3,(<span class="dv">0</span>,<span class="dv">0</span>),(<span class="dv">2</span><span class="er">pi</span>,<span class="dv">2</span><span class="er">pi</span>),<span class="dv">35</span>,<span class="dv">35</span>,Notaknot,Notaknot);</a>
<a class="sourceLine" id="cb2-76" title="76">s3.colors(palette(s3.map(abs), Gradient(<span class="dv">256</span>,red,black)));</a>
<a class="sourceLine" id="cb2-77" title="77">draw(s3,render(merge=true));</a></code></pre></div>
<h1 id="update-2018-12-06">Update 2018-12-06</h1>
<p>Actually the three cyclides differ from each other by a rotation around the <span class="math inline">\(y\)</span>-axis. Thus one can calculate the first one and construct the two other ones by rotation. So we can do like this in R:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co"># &quot;inverse&quot; Hopf map</span></a>
<a class="sourceLine" id="cb3-4" title="4">hopfinverse &lt;-<span class="st"> </span><span class="cf">function</span>(q, t){ </a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>q[<span class="dv">3</span>])) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(q[<span class="dv">1</span>]<span class="op">*</span><span class="kw">cos</span>(t)<span class="op">+</span>q[<span class="dv">2</span>]<span class="op">*</span><span class="kw">sin</span>(t),</a>
<a class="sourceLine" id="cb3-6" title="6">                         <span class="kw">sin</span>(t)<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>q[<span class="dv">3</span>]),</a>
<a class="sourceLine" id="cb3-7" title="7">                         <span class="kw">cos</span>(t)<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>q[<span class="dv">3</span>]),</a>
<a class="sourceLine" id="cb3-8" title="8">                         q[<span class="dv">1</span>]<span class="op">*</span><span class="kw">sin</span>(t)<span class="op">-</span>q[<span class="dv">2</span>]<span class="op">*</span><span class="kw">cos</span>(t)) </a>
<a class="sourceLine" id="cb3-9" title="9">}</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co"># stereographic projection</span></a>
<a class="sourceLine" id="cb3-11" title="11">stereog &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb3-12" title="12">  <span class="kw">c</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>])<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb3-13" title="13">}</a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co"># rotation in 4D space (right-isoclinic)</span></a>
<a class="sourceLine" id="cb3-15" title="15">rotate4d &lt;-<span class="st"> </span><span class="cf">function</span>(alpha, beta, xi, vec){</a>
<a class="sourceLine" id="cb3-16" title="16">  a =<span class="st"> </span><span class="kw">cos</span>(xi)</a>
<a class="sourceLine" id="cb3-17" title="17">  b =<span class="st"> </span><span class="kw">sin</span>(alpha)<span class="op">*</span><span class="kw">cos</span>(beta)<span class="op">*</span><span class="kw">sin</span>(xi)</a>
<a class="sourceLine" id="cb3-18" title="18">  c =<span class="st"> </span><span class="kw">sin</span>(alpha)<span class="op">*</span><span class="kw">sin</span>(beta)<span class="op">*</span><span class="kw">sin</span>(xi)</a>
<a class="sourceLine" id="cb3-19" title="19">  d =<span class="st"> </span><span class="kw">cos</span>(alpha)<span class="op">*</span><span class="kw">sin</span>(xi)</a>
<a class="sourceLine" id="cb3-20" title="20">  p =<span class="st"> </span>vec[<span class="dv">1</span>]; q =<span class="st"> </span>vec[<span class="dv">2</span>]; r =<span class="st"> </span>vec[<span class="dv">3</span>]; s =<span class="st"> </span>vec[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb3-21" title="21">  <span class="kw">c</span>(a<span class="op">*</span>p <span class="op">-</span><span class="st"> </span>b<span class="op">*</span>q <span class="op">-</span><span class="st"> </span>c<span class="op">*</span>r <span class="op">-</span><span class="st"> </span>d<span class="op">*</span>s,</a>
<a class="sourceLine" id="cb3-22" title="22">    a<span class="op">*</span>q <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>c<span class="op">*</span>s <span class="op">-</span><span class="st"> </span>d<span class="op">*</span>r,</a>
<a class="sourceLine" id="cb3-23" title="23">    a<span class="op">*</span>r <span class="op">-</span><span class="st"> </span>b<span class="op">*</span>s <span class="op">+</span><span class="st"> </span>c<span class="op">*</span>p <span class="op">+</span><span class="st"> </span>d<span class="op">*</span>q,</a>
<a class="sourceLine" id="cb3-24" title="24">    a<span class="op">*</span>s <span class="op">+</span><span class="st"> </span>b<span class="op">*</span>r <span class="op">-</span><span class="st"> </span>c<span class="op">*</span>q <span class="op">+</span><span class="st"> </span>d<span class="op">*</span>p)</a>
<a class="sourceLine" id="cb3-25" title="25">}</a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co"># cyclide parameterization</span></a>
<a class="sourceLine" id="cb3-27" title="27">f &lt;-<span class="st"> </span><span class="cf">function</span>(phi, theta, t){ <span class="co"># -pi/2 &lt; phi &lt; pi/2</span></a>
<a class="sourceLine" id="cb3-28" title="28">  p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cos</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(theta)<span class="op">*</span><span class="kw">cos</span>(phi), <span class="kw">sin</span>(phi))</a>
<a class="sourceLine" id="cb3-29" title="29">  h &lt;-<span class="st"> </span><span class="kw">hopfinverse</span>(p, t)</a>
<a class="sourceLine" id="cb3-30" title="30">  hr &lt;-<span class="st"> </span><span class="kw">rotate4d</span>(pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb3-31" title="31">  <span class="kw">stereog</span>(hr)</a>
<a class="sourceLine" id="cb3-32" title="32">}</a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co"># cyclide as mesh</span></a>
<a class="sourceLine" id="cb3-34" title="34">cyclideMesh &lt;-<span class="st"> </span><span class="cf">function</span>(phi, nu, nv){</a>
<a class="sourceLine" id="cb3-35" title="35">  vs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_real_</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span>nu<span class="op">*</span>nv)</a>
<a class="sourceLine" id="cb3-36" title="36">  u_ &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">length.out =</span> nu<span class="op">+</span><span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb3-37" title="37">  v_ &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">length.out =</span> nv<span class="op">+</span><span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb3-38" title="38">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nu){</a>
<a class="sourceLine" id="cb3-39" title="39">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nv){</a>
<a class="sourceLine" id="cb3-40" title="40">      vs[,(i<span class="dv">-1</span>)<span class="op">*</span>nv<span class="op">+</span>j] &lt;-<span class="st"> </span><span class="kw">f</span>(phi, u_[i], v_[j])</a>
<a class="sourceLine" id="cb3-41" title="41">    }</a>
<a class="sourceLine" id="cb3-42" title="42">  }</a>
<a class="sourceLine" id="cb3-43" title="43">  tris1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_integer_</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span>nu<span class="op">*</span>nv)</a>
<a class="sourceLine" id="cb3-44" title="44">  tris2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA_integer_</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span>nu<span class="op">*</span>nv)</a>
<a class="sourceLine" id="cb3-45" title="45">  nv &lt;-<span class="st"> </span><span class="kw">as.integer</span>(nv)</a>
<a class="sourceLine" id="cb3-46" title="46">  <span class="cf">for</span>(i <span class="cf">in</span> 1L<span class="op">:</span>nu){</a>
<a class="sourceLine" id="cb3-47" title="47">    ip1 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(i<span class="op">==</span>nu, 1L, i<span class="op">+</span>1L)</a>
<a class="sourceLine" id="cb3-48" title="48">    <span class="cf">for</span>(j <span class="cf">in</span> 1L<span class="op">:</span>nv){</a>
<a class="sourceLine" id="cb3-49" title="49">      jp1 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(j<span class="op">==</span>nv, 1L, j<span class="op">+</span>1L)</a>
<a class="sourceLine" id="cb3-50" title="50">      tris1[,(i<span class="dv">-1</span>)<span class="op">*</span>nv<span class="op">+</span>j] &lt;-<span class="st"> </span><span class="kw">c</span>((i<span class="op">-</span>1L)<span class="op">*</span>nv<span class="op">+</span>j,(i<span class="op">-</span>1L)<span class="op">*</span>nv<span class="op">+</span>jp1, (ip1<span class="op">-</span>1L)<span class="op">*</span>nv<span class="op">+</span>j)   </a>
<a class="sourceLine" id="cb3-51" title="51">      tris2[,(i<span class="dv">-1</span>)<span class="op">*</span>nv<span class="op">+</span>j] &lt;-<span class="st"> </span><span class="kw">c</span>((i<span class="op">-</span>1L)<span class="op">*</span>nv<span class="op">+</span>jp1,(ip1<span class="op">-</span>1L)<span class="op">*</span>nv<span class="op">+</span>jp1,(ip1<span class="op">-</span>1L)<span class="op">*</span>nv<span class="op">+</span>j)   </a>
<a class="sourceLine" id="cb3-52" title="52">    }</a>
<a class="sourceLine" id="cb3-53" title="53">  }</a>
<a class="sourceLine" id="cb3-54" title="54">  out &lt;-<span class="st"> </span><span class="kw">tmesh3d</span>(</a>
<a class="sourceLine" id="cb3-55" title="55">    <span class="dt">vertices =</span> vs,</a>
<a class="sourceLine" id="cb3-56" title="56">    <span class="dt">indices =</span> <span class="kw">cbind</span>(tris1, tris2),</a>
<a class="sourceLine" id="cb3-57" title="57">    <span class="dt">homogeneous =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb3-58" title="58">  )</a>
<a class="sourceLine" id="cb3-59" title="59">  <span class="kw">addNormals</span>(out)</a>
<a class="sourceLine" id="cb3-60" title="60">}</a>
<a class="sourceLine" id="cb3-61" title="61"></a>
<a class="sourceLine" id="cb3-62" title="62"><span class="co"># draw ####</span></a>
<a class="sourceLine" id="cb3-63" title="63">phi &lt;-<span class="st"> </span><span class="fl">1.2</span></a>
<a class="sourceLine" id="cb3-64" title="64">mesh1 &lt;-<span class="st"> </span><span class="kw">cyclideMesh</span>(phi, <span class="dv">250</span>, <span class="dv">250</span>)</a>
<a class="sourceLine" id="cb3-65" title="65">n &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb3-66" title="66">beta_ &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>pi , <span class="dt">length.out =</span> n<span class="op">+</span><span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>][<span class="op">-</span>n]</a>
<a class="sourceLine" id="cb3-67" title="67">colors &lt;-<span class="st"> </span>viridisLite<span class="op">::</span><span class="kw">viridis</span>(n)</a>
<a class="sourceLine" id="cb3-68" title="68"><span class="kw">open3d</span>(<span class="dt">windowRect=</span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">550</span>,<span class="dv">550</span>))</a>
<a class="sourceLine" id="cb3-69" title="69"><span class="kw">view3d</span>(<span class="dv">0</span>,<span class="dv">90</span>)</a>
<a class="sourceLine" id="cb3-70" title="70"><span class="kw">shade3d</span>(mesh1, <span class="dt">color =</span> colors[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb3-71" title="71"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(beta_)){</a>
<a class="sourceLine" id="cb3-72" title="72">  <span class="kw">shade3d</span>(<span class="kw">rotate3d</span>(mesh1, beta_[i], <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">color =</span> colors[i<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb3-73" title="73">}</a></code></pre></div>
<p><img src="figures/threeCyclidesR.png" /></p>
<p>And like this in Asymptote:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb4-1" title="1">settings.render = <span class="dv">4</span>;</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">// import modules</span></a>
<a class="sourceLine" id="cb4-3" title="3">import three;</a>
<a class="sourceLine" id="cb4-4" title="4">import solids;</a>
<a class="sourceLine" id="cb4-5" title="5">import palette;</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">// overall settings</span></a>
<a class="sourceLine" id="cb4-7" title="7">currentprojection = orthographic(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>);</a>
<a class="sourceLine" id="cb4-8" title="8">viewportmargin = (<span class="dv">10</span>,<span class="dv">10</span>);</a>
<a class="sourceLine" id="cb4-9" title="9">size(<span class="dv">10</span><span class="er">cm</span>);</a>
<a class="sourceLine" id="cb4-10" title="10">currentlight = ((<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">0</span>));</a>
<a class="sourceLine" id="cb4-11" title="11"></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">// &quot;inverse&quot; Hopf map ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-13" title="13">real[] hopfinverse(triple q, real t){</a>
<a class="sourceLine" id="cb4-14" title="14">  real f = <span class="dv">1</span>/sqrt(<span class="dv">2</span>*(<span class="dv">1</span>+q.z));</a>
<a class="sourceLine" id="cb4-15" title="15">  real[] out = {f*(q.x*cos(t)+q.y*sin(t)),</a>
<a class="sourceLine" id="cb4-16" title="16">                f*sin(t)*(<span class="dv">1</span>+q.z),</a>
<a class="sourceLine" id="cb4-17" title="17">                f*cos(t)*(<span class="dv">1</span>+q.z),</a>
<a class="sourceLine" id="cb4-18" title="18">                f*(q.x*sin(t)-q.y*cos(t))};</a>
<a class="sourceLine" id="cb4-19" title="19">  <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb4-20" title="20">}</a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">// stereographic projection ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-22" title="22">triple stereog(real[] x){</a>
<a class="sourceLine" id="cb4-23" title="23">  <span class="cf">return</span> (x[<span class="dv">0</span>],x[<span class="dv">1</span>],x[<span class="dv">2</span>])/(<span class="dv">1</span>-x[<span class="dv">3</span>]);</a>
<a class="sourceLine" id="cb4-24" title="24">}</a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">// rotation in 4D space (right-isoclinic) --------------------------------------</span></a>
<a class="sourceLine" id="cb4-26" title="26">real[] rotate4d(real alpha, real beta, real xi, real[] vec){</a>
<a class="sourceLine" id="cb4-27" title="27">  real a = cos(xi);</a>
<a class="sourceLine" id="cb4-28" title="28">  real b = sin(alpha)*cos(beta)*sin(xi);</a>
<a class="sourceLine" id="cb4-29" title="29">  real c = sin(alpha)*sin(beta)*sin(xi);</a>
<a class="sourceLine" id="cb4-30" title="30">  real d = cos(alpha)*sin(xi);</a>
<a class="sourceLine" id="cb4-31" title="31">  real p = vec[<span class="dv">0</span>];</a>
<a class="sourceLine" id="cb4-32" title="32">  real q = vec[<span class="dv">1</span>];</a>
<a class="sourceLine" id="cb4-33" title="33">  real r = vec[<span class="dv">2</span>];</a>
<a class="sourceLine" id="cb4-34" title="34">  real s = vec[<span class="dv">3</span>];</a>
<a class="sourceLine" id="cb4-35" title="35">  real[] out = {a*p - b*q - c*r - d*s,</a>
<a class="sourceLine" id="cb4-36" title="36">                a*q + b*p + c*s - d*r,</a>
<a class="sourceLine" id="cb4-37" title="37">                a*r - b*s + c*p + d*q,</a>
<a class="sourceLine" id="cb4-38" title="38">                a*s + b*r - c*q + d*p};</a>
<a class="sourceLine" id="cb4-39" title="39">  <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb4-40" title="40">}</a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">// parameterization ------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-42" title="42">real phi = <span class="fl">1.2</span>;</a>
<a class="sourceLine" id="cb4-43" title="43">triple f0(real theta, real t){</a>
<a class="sourceLine" id="cb4-44" title="44">  triple p = (cos(theta)*cos(phi), sin(theta)*cos(phi), sin(phi));</a>
<a class="sourceLine" id="cb4-45" title="45">  real[] h = hopfinverse(p, t);</a>
<a class="sourceLine" id="cb4-46" title="46">  real[] hr = rotate4d(pi/<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, h);</a>
<a class="sourceLine" id="cb4-47" title="47">  <span class="cf">return</span> stereog(hr);</a>
<a class="sourceLine" id="cb4-48" title="48">}</a>
<a class="sourceLine" id="cb4-49" title="49">triple f(pair uv){</a>
<a class="sourceLine" id="cb4-50" title="50">  <span class="cf">return</span> f0(uv.x, uv.y);</a>
<a class="sourceLine" id="cb4-51" title="51">}</a>
<a class="sourceLine" id="cb4-52" title="52"></a>
<a class="sourceLine" id="cb4-53" title="53"><span class="co">// draw ------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb4-54" title="54">surface s = surface(f, (<span class="dv">0</span>,<span class="dv">0</span>), (<span class="dv">2</span><span class="er">pi</span>,<span class="dv">2</span><span class="er">pi</span>), <span class="dv">55</span>, <span class="dv">55</span>, Spline);</a>
<a class="sourceLine" id="cb4-55" title="55"></a>
<a class="sourceLine" id="cb4-56" title="56">pen[] colors = Rainbow(); </a>
<a class="sourceLine" id="cb4-57" title="57"></a>
<a class="sourceLine" id="cb4-58" title="58">surface s1 = s;</a>
<a class="sourceLine" id="cb4-59" title="59">s1.colors(palette(s1.map(abs), Gradient(<span class="dv">256</span>,colors[<span class="dv">0</span>],black)));</a>
<a class="sourceLine" id="cb4-60" title="60">draw(s1, render(merge=true));</a>
<a class="sourceLine" id="cb4-61" title="61"></a>
<a class="sourceLine" id="cb4-62" title="62">surface s2 = rotate(<span class="dv">120</span>,Y)*s;</a>
<a class="sourceLine" id="cb4-63" title="63">s2.colors(palette(s2.map(abs), Gradient(<span class="dv">256</span>,colors[<span class="dv">10000</span>],black)));</a>
<a class="sourceLine" id="cb4-64" title="64">draw(s2, render(merge=true));</a>
<a class="sourceLine" id="cb4-65" title="65"></a>
<a class="sourceLine" id="cb4-66" title="66">surface s3 = rotate(<span class="dv">240</span>,Y)*s;</a>
<a class="sourceLine" id="cb4-67" title="67">s3.colors(palette(s3.map(abs), Gradient(<span class="dv">256</span>,colors[<span class="dv">30000</span>],black)));</a>
<a class="sourceLine" id="cb4-68" title="68">draw(s3, render(merge=true));</a></code></pre></div>
<p><img src="figures/threeCyclidesAsy.png" /></p>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->

  <!-- Google Prettify -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script> -->
  <script src="../libraries/highlighters/prettify/js/lang-r.js"></script>
  <script>
    var pres = document.getElementsByTagName("pre");
    for (var i = 0; i < pres.length; ++i) {
      
        pres[i].className = pres[i].className + " prettyprint linenums";
      
    }
    prettyPrint();
  </script> 


</html>