<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Saturn Elephant - Fast expansion of a polynomial with R - part 2</title>
  <link href="../libraries/bootstrap/bootstrap-grid.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/default2.css" />
  <link rel="stylesheet" href="../css/post.css" />
  <link rel="stylesheet" href="../css/misc.css" /> 
  
    <link rel="stylesheet" href="../css/pandoc-solarized.css" /> 
   
  
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,200,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">
  <script src="../libraries/jquery.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar. -->
      <div class="sidebar col-sm-2">
        <div class="row">
          <div class="col-sm-12" style="float:right;clear:both;margin-right:50px;margin-top:50px;">
            <a href="https://www.r-bloggers.com/">
              <img src="../images/Rbloggers.png" alt="Rbloggers" width="100%" />
            </a>
            <br />
            <a href="http://t-redactyl.io/">
              <span style="color:black;font-weight:bold;font-family:sans-serif;font-size:25px;">Standard error</span>
            </a>
            <a href="http://timelyportfolio.blogspot.be/">
              <span style="color:grey;font-weight:bold;font-family:sans-serif;font-size:24px;">Timely portfolio</span>
            </a>
            <br />
            <a href="https://antoineguillot.wordpress.com/blog/">
              <span style="color:white;background-color:darkblue;font-weight:bold;font-family:sans-serif;font-size:21px;border:5px solid;border-color:darkblue">ENHANCE DATA</span>
            </a>
            <br />
            <a href="https://fronkonstin.com/">
              <span style="color:black;background-color:gold;font-weight:bold;font-size:29px;border:3px solid;border-color:gold;">Fronkonstin</span>
            </a>
          </div>
        </div>
        <div id="logos">
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/AsymptoteLogo.svg" style="width: 150%; transform: rotateZ(-35deg)" />
            </div>
            <div class="col-sm-4">
              <img src="../images/Rlogo.svg" style="width: 110%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/shiny-hex.png" style="width: 90%;" />
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <img src="../images/Povray_logo_sphere.png" style="width: 105%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/javascript.svg" style="width: 90%;" />
            </div>
            <div class="col-sm-4">
              <img src="../images/haskell.svg" style="width: 110%;" />
            </div>
          </div>
        </div>
      </div>

      <div class="main col-sm-10">
        <div id="header">
          <div id="logo">
            <a href="../">
              <img src="../images/stla.jpg" alt="stla" width="100px" />
            </a>
          </div>
          <div id="navigation" style="margin-top:50px;">
            <a href="../">Home</a>
            <a href="../about.html">About</a>
            <a href="../contact.html">Contact</a>
            <a href="../archive.html">Archive</a>
          </div>
        </div>

        <div class="content">
          <h1>Fast expansion of a polynomial with R - part 2</h1> 
          <div class="info">
    Posted on July  5, 2023
    
        by Stéphane Laurent
    
</div>
<div class="info">
    
    Tags: <a title="All pages tagged 'R'." href="../tags/R.html">R</a>, <a title="All pages tagged 'maths'." href="../tags/maths.html">maths</a>, <a title="All pages tagged 'povray'." href="../tags/povray.html">povray</a>
    
</div>

<p>In <a href="https://laustep.github.io/stlahblog/posts/expandPolynomialWithSpray.html">the previous post</a>, I showed how to expand a polynomial with symbolic parameters with the help of the <strong>spray</strong> package. As I said, it has one problem: it doesn’t preserve the rational numbers in the polynomial expression.</p>
<p>I’m going to provide a solution here which overcomes this problem, with the help of the <strong>Ryacas</strong> package. In fact I provide a solution with the packages <strong>Ryacas</strong> and <strong>partitions</strong>, and then I improve it with the help of the <strong>spray</strong> package.</p>
<p>Here is the polynomial expression I use for the illustration:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>expr &lt;-<span class="st"> &quot;((x*x+y*y+1)*(a*x*x+b*y*y)+z*z*(b*x*x+a*y*y)-2*(a-b)*x*y*z-a*b*(x*x+y*y))^2-4*(x*x+y*y)*(a*x*x+b*y*y-x*y*z*(a-b))^2&quot;</span></span></code></pre></div>
<p>In fact, the equation <code>expr(x,y,z) = 0</code> defines a solid Möbius strip. That is why I was interested in this expression, because I wanted to draw the solid Möbius strip with POV-Ray. It is nice, in spite of a sad artifact (please leave a comment if you know how to get rid of it):</p>
<p><img src="./figures/SolidMobiusStrip_POV.gif" /></p>
<p>Let’s assign this expression to Yacas and let’s have a look at the degrees of the three variables <code>x</code>, <code>y</code> and <code>z</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">library</span>(Ryacas)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">yac_assign</span>(expr, <span class="st">&quot;POLY&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="kw">yac_str</span>(<span class="st">&quot;Degree(POLY, x)&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co">## [1] &quot;8&quot;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="kw">yac_str</span>(<span class="st">&quot;Degree(POLY, y)&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="co">## [1] &quot;8&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="kw">yac_str</span>(<span class="st">&quot;Degree(POLY, z)&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="co">## [1] &quot;4&quot;</span></span></code></pre></div>
<p>The degrees are 8, 8 and 4 respectively. So we can get all possible combinations <span class="math inline">\((i,j,k)\)</span> of <span class="math inline">\(x^iy^jz^k\)</span> with the <code>blockparts</code> function of the <code>partitions</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">library</span>(partitions)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>combins &lt;-<span class="st"> </span><span class="kw">blockparts</span>(<span class="kw">c</span>(8L, 8L, 4L))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="kw">dim</span>(combins)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co">## [1]   3 405</span></span></code></pre></div>
<p>There are <span class="math inline">\(405\)</span> such combinations. Of course they don’t all appear in the polynomial, and that is the point we will improve later. For the moment we will iterate over all these combinations. Here is the function which takes one combination and returns the corresponding coefficient of <span class="math inline">\(x^iy^jz^k\)</span> in terms of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, written in POV-Ray syntax:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(combin) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>  xyz &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;xyz(%s): &quot;</span>, <span class="kw">toString</span>(combin))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>  coef &lt;-<span class="st"> </span><span class="kw">yac_str</span>(<span class="kw">sprintf</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>    <span class="st">&quot;ExpandBrackets(Coef(Coef(Coef(POLY, x, %d), y, %d), z, %d))&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>    combin[1L], combin[2L], combin[3L]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>  ))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>  <span class="cf">if</span>(coef <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="kw">return</span>(<span class="ot">NULL</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>  coef &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;([ab])</span><span class="ch">\\</span><span class="st">^(</span><span class="ch">\\</span><span class="st">d+)&quot;</span>, <span class="st">&quot;pow(</span><span class="ch">\\</span><span class="st">1,</span><span class="ch">\\</span><span class="st">2)&quot;</span>, <span class="dt">x =</span> coef)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>  <span class="kw">paste0</span>(xyz, coef, <span class="st">&quot;,&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>}</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a><span class="co"># for example:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="kw">f</span>(<span class="kw">c</span>(2L, 6L, 0L))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="co">## [1] &quot;xyz(2, 6, 0): 2*pow(b,2)+2*b*a,&quot;</span></span></code></pre></div>
<p>Then we get the POV-Ray code as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>povray &lt;-<span class="st"> </span><span class="kw">apply</span>(combins, 2L, f)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="kw">cat</span>(povray, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">file =</span> <span class="st">&quot;SolidMobiusStrip.pov&quot;</span>)</span></code></pre></div>
<p>The file <strong><em>SolidMobiusStrip.pov</em></strong>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource povray numberLines"><code class="sourceCode povray"><span id="cb6-1"><a href="#cb6-1"></a>xyz(<span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span>): <span class="kw">pow</span>(a,<span class="fl">2</span>)*<span class="kw">pow</span>(b,<span class="fl">2</span>)-<span class="fl">2</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>)*b+<span class="kw">pow</span>(a,<span class="fl">2</span>),</span>
<span id="cb6-2"><a href="#cb6-2"></a>xyz(<span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">0</span>): (-<span class="fl">2</span>)*<span class="kw">pow</span>(a,<span class="fl">2</span>)*b<span class="fl">-2</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>),</span>
<span id="cb6-3"><a href="#cb6-3"></a>xyz(<span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">0</span>): <span class="kw">pow</span>(a,<span class="fl">2</span>),</span>
<span id="cb6-4"><a href="#cb6-4"></a>xyz(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>): <span class="fl">2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>)*<span class="kw">pow</span>(a,<span class="fl">2</span>)-<span class="fl">2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>)*a+(-<span class="fl">2</span>)*b*<span class="kw">pow</span>(a,<span class="fl">2</span>)+<span class="fl">2</span>*b*a,</span>
<span id="cb6-5"><a href="#cb6-5"></a>xyz(<span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">0</span>): (-<span class="fl">2</span>)*<span class="kw">pow</span>(b,<span class="fl">2</span>)*a+(-<span class="fl">4</span>)*b*<span class="kw">pow</span>(a,<span class="fl">2</span>)-<span class="fl">4</span>*b*a<span class="fl">-2</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>),</span>
<span id="cb6-6"><a href="#cb6-6"></a>xyz(<span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">0</span>): <span class="fl">2</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>)+<span class="fl">2</span>*a*b,</span>
<span id="cb6-7"><a href="#cb6-7"></a>xyz(<span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">0</span>): <span class="kw">pow</span>(b,<span class="fl">2</span>)*<span class="kw">pow</span>(a,<span class="fl">2</span>)-<span class="fl">2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>)*a+<span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-8"><a href="#cb6-8"></a>xyz(<span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">0</span>): (-<span class="fl">4</span>)*<span class="kw">pow</span>(b,<span class="fl">2</span>)*a<span class="fl">-2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>)+(-<span class="fl">2</span>)*b*<span class="kw">pow</span>(a,<span class="fl">2</span>)-<span class="fl">4</span>*b*a,</span>
<span id="cb6-9"><a href="#cb6-9"></a>xyz(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0</span>): <span class="kw">pow</span>(b,<span class="fl">2</span>)+<span class="fl">4</span>*b*a+<span class="kw">pow</span>(a,<span class="fl">2</span>),</span>
<span id="cb6-10"><a href="#cb6-10"></a>xyz(<span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">0</span>): (-<span class="fl">2</span>)*<span class="kw">pow</span>(b,<span class="fl">2</span>)*a<span class="fl">-2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-11"><a href="#cb6-11"></a>xyz(<span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">0</span>): <span class="fl">2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>)+<span class="fl">2</span>*b*a,</span>
<span id="cb6-12"><a href="#cb6-12"></a>xyz(<span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">0</span>): <span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-13"><a href="#cb6-13"></a>xyz(<span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>): <span class="fl">4</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>)*b<span class="fl">-4</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>)+(-<span class="fl">4</span>)*a*<span class="kw">pow</span>(b,<span class="fl">2</span>)+<span class="fl">4</span>*a*b,</span>
<span id="cb6-14"><a href="#cb6-14"></a>xyz(<span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span>): <span class="fl">4</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>)-<span class="fl">4</span>*a*b,</span>
<span id="cb6-15"><a href="#cb6-15"></a>xyz(<span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>): <span class="fl">4</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>)*b+(-<span class="fl">4</span>)*a*<span class="kw">pow</span>(b,<span class="fl">2</span>)-<span class="fl">4</span>*a*b+<span class="fl">4</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-16"><a href="#cb6-16"></a>xyz(<span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>): <span class="fl">4</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>)-<span class="fl">4</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-17"><a href="#cb6-17"></a>xyz(<span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span>): <span class="fl">4</span>*a*b<span class="fl">-4</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-18"><a href="#cb6-18"></a>xyz(<span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">2</span>): (-<span class="fl">2</span>)*a*<span class="kw">pow</span>(b,<span class="fl">2</span>)+<span class="fl">2</span>*a*b,</span>
<span id="cb6-19"><a href="#cb6-19"></a>xyz(<span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">2</span>): <span class="fl">2</span>*b*a,</span>
<span id="cb6-20"><a href="#cb6-20"></a>xyz(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>): (-<span class="fl">2</span>)*<span class="kw">pow</span>(b,<span class="fl">2</span>)*a+<span class="fl">6</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>)+(-<span class="fl">2</span>)*b*<span class="kw">pow</span>(a,<span class="fl">2</span>)-<span class="fl">8</span>*b*a+<span class="fl">6</span>*<span class="kw">pow</span>(a,<span class="fl">2</span>),</span>
<span id="cb6-21"><a href="#cb6-21"></a>xyz(<span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">2</span>): (-<span class="fl">2</span>)*<span class="kw">pow</span>(a,<span class="fl">2</span>)+<span class="fl">10</span>*a*b<span class="fl">-2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-22"><a href="#cb6-22"></a>xyz(<span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">2</span>): (-<span class="fl">2</span>)*b*<span class="kw">pow</span>(a,<span class="fl">2</span>)+<span class="fl">2</span>*b*a,</span>
<span id="cb6-23"><a href="#cb6-23"></a>xyz(<span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">2</span>): (-<span class="fl">2</span>)*<span class="kw">pow</span>(a,<span class="fl">2</span>)+<span class="fl">10</span>*a*b<span class="fl">-2</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-24"><a href="#cb6-24"></a>xyz(<span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">2</span>): <span class="fl">2</span>*a*b,</span>
<span id="cb6-25"><a href="#cb6-25"></a>xyz(<span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>): <span class="fl">4</span>*<span class="kw">pow</span>(b,<span class="fl">2</span>)-<span class="fl">4</span>*b*a,</span>
<span id="cb6-26"><a href="#cb6-26"></a>xyz(<span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>): (-<span class="fl">4</span>)*<span class="kw">pow</span>(a,<span class="fl">2</span>)+<span class="fl">4</span>*a*b,</span>
<span id="cb6-27"><a href="#cb6-27"></a>xyz(<span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">4</span>): <span class="kw">pow</span>(b,<span class="fl">2</span>),</span>
<span id="cb6-28"><a href="#cb6-28"></a>xyz(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>): <span class="fl">2</span>*a*b,</span>
<span id="cb6-29"><a href="#cb6-29"></a>xyz(<span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">4</span>): <span class="kw">pow</span>(a,<span class="fl">2</span>)</span></code></pre></div>
<p>Now we will restrict the <span class="math inline">\(405\)</span> combinations. There are only <span class="math inline">\(29\)</span> combinations of exponents in the polynomial expansion. How to get them? With <strong>spray</strong>. We don’t care if there are rational numbers in the polynomial because we will take the exponents only.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">library</span>(spray)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">lone</span>(1L, 5L)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">lone</span>(2L, 5L)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">lone</span>(3L, 5L)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="kw">lone</span>(4L, 5L)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="kw">lone</span>(5L, 5L)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>P &lt;-<span class="st"> </span>((x<span class="op">*</span>x<span class="op">+</span>y<span class="op">*</span>y<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(a<span class="op">*</span>x<span class="op">*</span>x<span class="op">+</span>b<span class="op">*</span>y<span class="op">*</span>y) <span class="op">+</span><span class="st"> </span>z<span class="op">*</span>z<span class="op">*</span>(b<span class="op">*</span>x<span class="op">*</span>x<span class="op">+</span>a<span class="op">*</span>y<span class="op">*</span>y) <span class="op">-</span><span class="st"> </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="st">        </span><span class="dv">2</span><span class="op">*</span>(a<span class="op">-</span>b)<span class="op">*</span>x<span class="op">*</span>y<span class="op">*</span>z <span class="op">-</span><span class="st"> </span>a<span class="op">*</span>b<span class="op">*</span>(x<span class="op">*</span>x<span class="op">+</span>y<span class="op">*</span>y))<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a><span class="st">  </span><span class="dv">4</span><span class="op">*</span>(x<span class="op">*</span>x<span class="op">+</span>y<span class="op">*</span>y)<span class="op">*</span>(a<span class="op">*</span>x<span class="op">*</span>x<span class="op">+</span>b<span class="op">*</span>y<span class="op">*</span>y<span class="op">-</span>x<span class="op">*</span>y<span class="op">*</span>z<span class="op">*</span>(a<span class="op">-</span>b))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>exponents &lt;-<span class="st"> </span><span class="kw">index</span>(P)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>exponents_xyz &lt;-<span class="st"> </span><span class="kw">unique</span>(exponents[, <span class="kw">c</span>(1L, 2L, 3L)])</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a><span class="kw">dim</span>(exponents_xyz)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a><span class="co">## [1] 29  3</span></span></code></pre></div>
<p>Indeed, there are <span class="math inline">\(29\)</span> combinations. Now we can proceed as before and get the POV-Ray within a couple of seconds:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>povray &lt;-<span class="st"> </span><span class="kw">apply</span>(exponents_xyz, 1L, f)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">cat</span>(povray, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">file =</span> <span class="st">&quot;SolidMobiusStrip.pov&quot;</span>)</span></code></pre></div>

        </div>


        <div id="footer">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>

      </div>

    </div>

    <div class="row">
      <div class="col-sm-12">
        <div id="disqus_thread"></div>
        <div class="pagination">
          <ul>
            <li>
              <a href="http://laustep.github.io/stlahblog/">« Back Home</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
  </div>

</body>

<script src="../libraries/bootstrap/bootstrap.min.js"></script>
<script>
  var disqus_developer = 1;
  var disqus_shortname = 'stlapblog';
  // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config" src="../libraries/mathjax/config/TeX-MML-AM_CHTML.js"></script>
<!-- <script>
  window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/mathjax/MathJax.js"><\/script>');
</script> -->


</html>